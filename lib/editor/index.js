!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var a=t();for(var n in a)("object"==typeof exports?exports:e)[n]=a[n]}}(window,function(){return(a={},e.m=t=[function(e,t){e.exports=require("react")},function(e,t,a){"use strict";var n=a(18),o=a.n(n),r=a(61),s=a.n(r),i=a(3),c=a.n(i),l=a(4),p=a.n(l),u=a(41),h=a.n(u),d=a(12);function m(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"rgba(255,255,255,1)";if(e){var a=h()(e),n=a.getAlpha();e=a.setAlpha(n).toRgbString()}else e=t;return e}var y=new(function(){function e(){c()(this,e)}return p()(e,[{key:"getBorder",value:function(e){if(e&&"none"!==e){var t=e.split(" ");return{size:parseInt(t[0],10),type:t[1],color:m(e.replace(/.+(rgba.+)/,"$1"))}}return{size:null,type:null,color:null}}},{key:"setBorder",value:function(e,t){var a=this.getBorder(e),n=a.size,o=a.type,r=a.color;return d.a.isEmpty(t.size)||(n=t.size),d.a.isEmpty(t.type)||(o=t.type),d.a.isEmpty(t.color)||(r=m(t.color)),"".concat(n,"px ").concat(o," ").concat(r)}},{key:"getBoxshadow",value:function(e){var t=null,a=null;if(e&&"none"!==e){var n=e.split(" ");t=parseInt(n[2],10),a=m(e.replace(/.+(rgba.+)/,"$1"))}return{size:t,color:a}}},{key:"setBoxshadow",value:function(e,t){var a=this.getBoxshadow(e),n=a.size,o=a.color;return d.a.isEmpty(t.size)||(n=t.size),d.a.isEmpty(t.color)||(o=m(t.color)),"0 0 ".concat(n,"px ").concat(o)}},{key:"getAnimation",value:function(e){var t=null,a=null,n=null,o=null,r=null,s=null,i=null,c=null;if(e&&"none"!==e){var l=e.split(" ");t=l[0],a=d.a.toFixed(l[1],1),n=l[2],o=d.a.toFixed(l[3],1),r=parseInt(l[4],10),s=l[5]||"normal",i=l[6]||"forwards",c=l[7]||"running"}return{name:t,duration:a,timing:n,delay:o,count:r,direction:s,fillMode:i,playState:c}}},{key:"setAnimation",value:function(e,t){var a=this.getAnimation(e),n=a.name,o=a.duration,r=a.timing,s=a.delay,i=a.count,c=a.direction,l=a.fillMode,p=a.playState;return d.a.isEmpty(t.name)||(n=t.name),d.a.isEmpty(t.duration)||(o=t.duration),d.a.isEmpty(t.timing)||(r=t.timing),d.a.isEmpty(t.delay)||(s=t.delay),d.a.isEmpty(t.count)||(i=parseInt(t.count,10)),d.a.isEmpty(t.direction)||(c=t.direction),d.a.isEmpty(t.fillMode)||(l=t.fillMode),d.a.isEmpty(t.playState)||(p=t.playState),"".concat(n," ").concat(d.a.toFixed(o,1),"s ").concat(r," ").concat(d.a.toFixed(s,1),"s ").concat(i," ").concat(c," ").concat(l," ").concat(p)}},{key:"getTransformVal",value:function(e,t){var a="";if(-1!==e.indexOf(t)){var n=RegExp(".*"+t+"\\((.+?)\\).*");a=e.replace(n,"$1")}if(""===(a=a.replace(/\s+/g,"")))switch(t){case"rotate":a=0;break;case"translate":a="0,0";break;case"scale":a="1,1";break;case"skew":a="0,0"}if("object"!==s()(a))a=d.a.toFixed(a,2);else{var r=a.split(","),i=o()(r,2),c=i[0],l=i[1];a=[parseFloat(c),parseFloat(l)]}return a}},{key:"getTransform",value:function(e){var t=0<arguments.length&&void 0!==e?e:"",a=null,n=null,o=null,r=null;return t&&"none"!==t&&(a=this.getTransformVal(t,"rotate"),n=this.getTransformVal(t,"translate"),o=this.getTransformVal(t,"scale"),r=this.getTransformVal(t,"skew")),"number"==typeof o&&(o=[o,o]),{rotate:a||0,translate:n||[0,0],scale:o||[1,1],skew:r||[0,0]}}},{key:"setTransform",value:function(e,t){var a=this.getTransform(e),n=a.rotate,o=a.translate,r=a.scale,s=a.skew;d.a.isEmpty(t.rotate)||(n=t.rotate),d.a.isEmpty(t.translate)||(o=t.translate),d.a.isEmpty(t.scale)||(r=t.scale),d.a.isEmpty(t.skew)||(s=t.skew);var i=[];return d.a.isEmpty(n)||i.push("rotate(".concat(n,"deg)")),d.a.isEmpty(o)||i.push("translate(".concat(o.map(function(e){return e+"px"}).join(","),")")),d.a.isEmpty(r)||i.push("scale(".concat(r.join(","),")")),d.a.isEmpty(s)||i.push("skew(".concat(s.map(function(e){return e+"deg"}).join(","),")")),i.join(" ")}},{key:"resetTransform",value:function(e,t){try{var a=[];for(var n in t)a.push("".concat(n,"(").concat(t[n],")"));a=a.join(" "),e.css({"-webkit-transform":a,transform:a})}catch(e){console.error("function:addTransform error！",e)}}}]),e}()),f=a(39),g=a(11),v=a.n(g),b=new(function(){function e(){c()(this,e)}return p()(e,[{key:"getPid",value:function(e,t){var a=this;e&&e.forEach(function(e){t.push(e.pid),"h5ds_combin"===e.pid&&a.getPid(e.data,t)})}},{key:"getPidByPageData",value:function(e){var t=[];return this.getPid(e.layers,t),(t=Array.from(new Set(t))).filter(function(e){return!["h5ds_combin","h5ds_img","h5ds_shape","h5ds_sound","h5ds_text"].includes(e)})}},{key:"getPidByData",value:function(e){var t=this,a=[],n=e.pages,o=void 0===n?[]:n,r=e.fixeds,s=void 0===r?[]:r,i=e.popups,c=void 0===i?[]:i;return[].concat(v()(o),v()(s),v()(c)).forEach(function(e){t.getPid(e.layers,a)}),a=(a=Array.from(new Set(a))).filter(function(e){return!["h5ds_combin","h5ds_img","h5ds_shape","h5ds_sound","h5ds_text"].includes(e)})}}]),e}()),w=(new(function(){function e(){c()(this,e)}return p()(e,[{key:"getBezierPoints",value:function(e,t,a,n,o){var r=0<arguments.length&&void 0!==e?e:100,s=1<arguments.length?t:void 0,i=2<arguments.length?a:void 0,c=3<arguments.length?n:void 0,l=4<arguments.length?o:void 0,p=null,u=[];c||l?c&&!l?p=this.twoBezier:c&&l&&(p=this.threeBezier):p=this.oneBezier;for(var h=0;h<r;h++)u.push(p(h/r,s,i,c,l));return l?u.push(v()(l)):c&&u.push(v()(c)),u}},{key:"oneBezier",value:function(e,t,a){var n=o()(t,2),r=n[0],s=n[1],i=o()(a,2);return[r+(i[0]-r)*e,s+(i[1]-s)*e]}},{key:"twoBezier",value:function(e,t,a,n){var r=o()(t,2),s=r[0],i=r[1],c=o()(a,2),l=c[0],p=c[1],u=o()(n,2);return[(1-e)*(1-e)*s+2*e*(1-e)*l+e*e*u[0],(1-e)*(1-e)*i+2*e*(1-e)*p+e*e*u[1]]}},{key:"threeBezier",value:function(e,t,a,n,r){var s=o()(t,2),i=s[0],c=s[1],l=o()(r,2),p=l[0],u=l[1],h=o()(a,2),d=h[0],m=h[1],y=o()(n,2);return[i*(1-e)*(1-e)*(1-e)+3*d*e*(1-e)*(1-e)+3*y[0]*e*e*(1-e)+p*e*e*e,c*(1-e)*(1-e)*(1-e)+3*m*e*(1-e)*(1-e)+3*y[1]*e*e*(1-e)+u*e*e*e]}}]),e}()),a(17)),k=(a(38),a(40),a(16)),E=new(function(){function e(){c()(this,e)}return p()(e,[{key:"rectParam",value:function(e){if(e[0]){var t=e.transform("rotate"),a=e.width(),n=e.height(),o=parseFloat(e.css("left")),r=parseFloat(e.css("top")),s={left:o+a/2,top:r+n/2};return 0===t?{rotate:t,top:r,left:o,boxWidth:a,boxHeight:n,width:a,height:n,center:s}:this._hasRotate(t,a,n,s)}}},{key:"rectParamObj",value:function(e){var t=0,a=e.style;a.transform&&(t=y.getTransformVal(a.transform,"rotate"));var n=a.width||0,o=a.height||0,r=a.left||0,s=a.top||0,i={left:r+n/2,top:s+o/2};return 0==t?{rotate:t,top:s,left:r,boxWidth:n,boxHeight:o,width:n,height:o,center:i}:this._hasRotate(t,n,o,i)}},{key:"_hasRotate",value:function(e,t,a,n){var o=e%90*(Math.PI/180),r=Math.atan(a/t),s=Math.sqrt(a/2*(a/2)+t/2*(t/2)),i=s*Math.cos(Math.PI/2-(o+r))*2,c=s*Math.cos(o-r)*2;return{rotate:e,top:n.top-c/2,left:n.left-i/2,boxWidth:i,boxHeight:c,width:t,height:a,center:n}}}]),e}());function x(){$(document).on("keydown.shortcuts",function(e){var t=(e=window.event||e).keyCode;if(0===$(":focus").length)if(e.ctrlKey&&-1!==[83,90,89,189,187,80,75,71,72,67,85,86].indexOf(t))switch(e.preventDefault(),e.stopPropagation(),t){case 83:k.a.publish("h5ds.shortcuts_save");break;case 90:k.a.publish("h5ds.shortcuts_undo");break;case 89:k.a.publish("h5ds.shortcuts_redo");break;case 189:k.a.publish("h5ds.shortcuts_tomin");break;case 187:k.a.publish("h5ds.shortcuts_tomax");break;case 80:k.a.publish("h5ds.shortcuts_play");break;case 71:k.a.publish("h5ds.shortcuts_combin");break;case 72:k.a.publish("h5ds.shortcuts_grid");break;case 85:k.a.publish("h5ds.shortcuts_uncombin");break;case 86:k.a.publish("h5ds.shortcuts_pastelayer");break;case 67:k.a.publish("h5ds.shortcuts_copylayer")}else{if(46===t)return e.preventDefault(),void k.a.publish("h5ds.shortcuts_dellayer");if(-1===[38,40,37,39].indexOf(t));else{e.preventDefault(),e.stopPropagation();var a=1;switch(e.shiftKey&&(a=20),t){case 38:k.a.publish("h5ds.shortcuts_y",-a);break;case 37:k.a.publish("h5ds.shortcuts_x",-a);break;case 39:k.a.publish("h5ds.shortcuts_x",a);break;case 40:k.a.publish("h5ds.shortcuts_y",a)}}}})}a.d(t,"b",function(){return b}),a.d(t,"g",function(){return x}),a.d(t,"a",function(){return f.a}),a.d(t,"c",function(){return w.a}),a.d(t,"e",function(){return k.a}),a.d(t,"i",function(){return d.a}),a.d(t,"f",function(){return E}),a.d(t,"h",function(){return m}),a.d(t,"d",function(){return y})},function(e,t){e.exports=require("@babel/runtime/helpers/applyDecoratedDescriptor")},function(e,t){e.exports=require("@babel/runtime/helpers/classCallCheck")},function(e,t){e.exports=require("@babel/runtime/helpers/createClass")},function(e,t){e.exports=require("@babel/runtime/helpers/possibleConstructorReturn")},function(e,t){e.exports=require("@babel/runtime/helpers/getPrototypeOf")},function(e,t){e.exports=require("@babel/runtime/helpers/inherits")},function(e,t){e.exports=require("mobx")},function(e,t){e.exports=require("mobx-react")},function(e,t){e.exports=require("@babel/runtime/helpers/objectSpread")},function(e,t){e.exports=require("@babel/runtime/helpers/toConsumableArray")},function(e,t,a){"use strict";a.d(t,"a",function(){return O});var n=a(11),o=a.n(n),r=a(3),s=a.n(r),i=a(4),c=a.n(i),l=a(55),p=a.n(l),u=a(56),h=a.n(u),d=a(57),m=a.n(d),y=a(58),f=a.n(y),g=a(59),v=a.n(g),b=a(60),w=a.n(b),k=a(31),E=a.n(k),x={datetime:"YYYY/MM/DD HH:mm:ss",date:"YYYY/MM/DD",time:"HH:mm:ss"},O=new(function(){function e(){s()(this,e)}return c()(e,[{key:"data2QueryString",value:function(e){var t=E()("");return t.set("query",e),t.href.split("?")[1]}},{key:"isUrl",value:function(e){return/https?:\/\/[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)/i.test(e)}},{key:"isPhoneNum",value:function(e){return/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/.test(e)}},{key:"getUrlData",value:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(t),n=null;return null!=a&&(n=unescape(a[2])),n}},{key:"getSource",value:function(e,t){var a=this,n=1<arguments.length&&void 0!==t?t:{loadSound:!1},r=[],s=e.pages,i=void 0===s?[]:s,c=e.fixeds,l=void 0===c?[]:c,p=e.popups,u=void 0===p?[]:p;return e.style&&e.style.backgroundImage&&r.push(this.getBackGroundImageUrl(e.style.backgroundImage)),[].concat(o()(i),o()(l),o()(u)).forEach(function(e){e.style&&e.style.backgroundImage&&r.push(a.getBackGroundImageUrl(e.style.backgroundImage)),e.estyle&&e.estyle.backgroundImage&&r.push(a.getBackGroundImageUrl(e.estyle.backgroundImage)),e.layers&&e.layers.forEach(function(e){"h5ds_img"===e.pid?r.push(e.data.src):"h5ds_combin"===e.pid?e.layers.forEach(function(e){"h5ds_img"===e.pid&&r.push(e.data.src)}):n.loadSound&&"h5ds_sound"===e.pid&&r.push(e.data.sound)})}),Array.from(new Set(r))}},{key:"uniq",value:function(e,t){return w()(e,t)}},{key:"cloneDeep",value:function(e){return p()(e)}},{key:"toJS",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"debounce",value:function(e,t){return m()(e,t)}},{key:"throttle",value:function(e,t){return v()(e,t)}},{key:"escape",value:function(e){try{var t=f()(e)?JSON.stringify(e):e;return window.escape(t)}catch(e){return""}}},{key:"setStorage",value:function(e,t){"string"==typeof t?window.localStorage.setItem(e,t):window.localStorage.setItem(e,JSON.stringify(t))}},{key:"getStorage",value:function(e){var t=window.localStorage.getItem(e);try{return JSON.parse(t)}catch(e){return t}}},{key:"clearStorage",value:function(e){e?window.localStorage.removeItem(e):window.localStorage.clear()}},{key:"setSession",value:function(e,t){"string"==typeof t?window.sessionStorage.setItem(e,t):window.sessionStorage.setItem(e,JSON.stringify(t))}},{key:"getSession",value:function(e){var t=window.sessionStorage.getItem(e);try{return JSON.parse(t)}catch(e){return t}}},{key:"clearSession",value:function(e){e?window.sessionStorage.removeItem(e):window.sessionStorage.clear()}},{key:"getUrlQuery",value:function(e){var t=E()(window.location.href);return e?t.query[e]:t.query}},{key:"toFixed",value:function(e,t){var a=1<arguments.length&&void 0!==t?t:2;return e?(e=parseFloat(e),parseFloat(e.toFixed(a))):0}},{key:"exchageArrayElem",value:function(e,t,a){var n=[e[t],e[a]];e[a]=n[0],e[t]=n[1]}},{key:"removeArrayElement",value:function(e,t){var a=e.indexOf(t);return 0<=a&&e.splice(a,1),this.cloneDeep(e)}},{key:"plus",value:function(e,t){return+(e+t).toFixed(10)}},{key:"minus",value:function(e,t){return+(e-t).toFixed(10)}},{key:"formatDate",value:function(e,t){var a=0<arguments.length&&void 0!==e?e:new Date,n=1<arguments.length&&void 0!==t?t:"datetime";return h()(a).format(x[n]||n)}},{key:"randomNumber",value:function(e,t){var a=0<arguments.length&&void 0!==e?e:0,n=1<arguments.length&&void 0!==t?t:100;return Math.min(Math.floor(a+Math.random()*(n-a)),n)}},{key:"randomColor",value:function(){return"#"+("00000"+(16777216*Math.random()<<0).toString(16)).slice(-6)}},{key:"randomID",value:function(e){var t=0<arguments.length&&void 0!==e?e:8;return Number(Math.random().toString().substr(3,t)+Date.now()).toString(36)}},{key:"getBase64",value:function(e,t){var a=this,n=t.width,o=t.height,r=t.x,s=t.y;return new Promise(function(t,i){var c=new Image;c.crossOrigin="Anonymous",c.onload=function(){var e=$('<canvas width="'+n+'" height="'+o+'"></canvas>')[0];e.getContext("2d").drawImage(c,r,s,n,o,0,0,n,o),t(e.toDataURL())},c.onerror=function(e){console.error("图片转base64失败！"),i(e)},c.src=e+"?t="+a.randomID()})}},{key:"arrayToObject",value:function(e,t){var a=1<arguments.length&&void 0!==t&&t,n={};return e.forEach(function(e){Object.keys(e).forEach(function(t){var o=e[t];!a&&n.hasOwnProperty(t)||(n[t]=o)})}),n}},{key:"isEmpty",value:function(e){return null==e||""===e}},{key:"getBackGroundImageUrl",value:function(e){var t=0<arguments.length&&void 0!==e?e:"";return(t=t.replace(/url\((.*)\)/,"$1")).replace(/["']/g,"")}},{key:"imgLazy",value:function(e){return new Promise(function(t,a){var n=new Image;n.src=e,n.onload=function(){t(n)},n.onerror=function(){console.error("图片加载失败",null),a(null)}})}},{key:"compile",value:function(e){for(var t=String.fromCharCode(e.charCodeAt(0)+e.length),a=1;a<e.length;a++)t+=String.fromCharCode(e.charCodeAt(a)+e.charCodeAt(a-1));return escape(t)}},{key:"uncompile",value:function(e){e=unescape(e);for(var t=String.fromCharCode(e.charCodeAt(0)-e.length),a=1;a<e.length;a++)t+=String.fromCharCode(e.charCodeAt(a)-t.charCodeAt(a-1));return t}}]),e}())},function(e,t,a){"use strict";function n(e){"phone"===e?(c.appType="phone",c.appWidth=320,c.appHeight=514):(c.appType="pc",c.appWidth=800,c.appHeight=600)}function o(){p()(this,o),this.id=null,this.className=null,this.keyid=u.i.randomID(),this.name="空白页面",this.desc="页面描述",this.style={height:c.appHeight,width:c.appWidth},this.layers=[],this.animate=[],this.slider={autoplay:!1,lock:!1,time:5}}var r=[{name:"快闪",type:"in",animate:"fastShow",time:"0.1s",delay:"0s",count:1,fun:"linear"},{name:"缩小入",type:"in",animate:"smallIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"弹入",type:"in",animate:"bounceIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上弹入",type:"in",animate:"bounceInDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左弹入",type:"in",animate:"bounceInLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右弹入",type:"in",animate:"bounceInRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下弹入",type:"in",animate:"bounceInUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"渐显",type:"in",animate:"fadeIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上渐显",type:"in",animate:"fadeInDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上远渐显",type:"in",animate:"fadeInDownBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左渐显",type:"in",animate:"fadeInLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左远渐显",type:"in",animate:"fadeInLeftBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右渐入",type:"in",animate:"fadeInRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右远渐入",type:"in",animate:"fadeInRightBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下渐入",type:"in",animate:"fadeInUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下远渐入",type:"in",animate:"fadeInUpBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"X翻牌",type:"in",animate:"flipInX",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"Y翻牌",type:"in",animate:"flipInY",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"光速入",type:"in",animate:"lightSpeedIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"滚入",type:"in",animate:"rotateIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左上滚入",type:"in",animate:"rotateInDownLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右上滚入",type:"in",animate:"rotateInDownRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左下滚入",type:"in",animate:"rotateInUpLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右下滚入",type:"in",animate:"rotateInUpRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下滑入",type:"in",animate:"slideInUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上滑入",type:"in",animate:"slideInDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左滑入",type:"in",animate:"slideInLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右滑入",type:"in",animate:"slideInRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"放大",type:"in",animate:"zoomIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"从上放大",type:"in",animate:"zoomInDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"从左放大",type:"in",animate:"zoomInLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"从右放大",type:"in",animate:"zoomInRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"从下放大",type:"in",animate:"zoomInUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左滚入",type:"in",animate:"rollIn",time:"1s",delay:"0s",count:1,fun:"ease"}],s=[{name:"弹走",type:"out",animate:"bounceOut",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下弹走",type:"out",animate:"bounceOutDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左弹走",type:"out",animate:"bounceOutLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右弹走",type:"out",animate:"bounceOutRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上弹走",type:"out",animate:"bounceOutUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"渐隐",type:"out",animate:"fadeOut",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下渐隐",type:"out",animate:"fadeOutDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下渐隐快",type:"out",animate:"fadeOutDownBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左渐隐",type:"out",animate:"fadeOutLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左渐隐快",type:"out",animate:"fadeOutLeftBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右渐隐",type:"out",animate:"fadeOutRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右渐隐快",type:"out",animate:"fadeOutRightBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上渐隐",type:"out",animate:"fadeOutUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上渐隐快",type:"out",animate:"fadeOutUpBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"X翻牌隐",type:"out",animate:"flipOutX",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"Y翻牌隐",type:"out",animate:"flipOutY",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"光速离开",type:"out",animate:"lightSpeedOut",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"滚隐",type:"out",animate:"rotateOut",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左下滚出",type:"out",animate:"rotateOutDownLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右下滚出",type:"out",animate:"rotateOutDownRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左上滚出",type:"out",animate:"rotateOutUpLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右上滚出",type:"out",animate:"rotateOutUpRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上滑出",type:"out",animate:"slideOutUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下滑出",type:"out",animate:"slideOutDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左滑出",type:"out",animate:"slideOutLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右滑出",type:"out",animate:"slideOutRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"缩小",type:"out",animate:"zoomOut",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下缩小",type:"out",animate:"zoomOutDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左缩小",type:"out",animate:"zoomOutLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右缩小",type:"out",animate:"zoomOutRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上缩小",type:"out",animate:"zoomOutUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"掉链子",type:"out",animate:"hinge",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右滚走",type:"out",animate:"rollOut",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"放大消失",type:"out",animate:"toBigFade",time:"1s",delay:"0s",count:1,fun:"ease"}],i=[{name:"跳动",type:"em",animate:"bounce",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"闪动",type:"em",animate:"flash",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"呼吸",type:"em",animate:"pulse",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"弹性",type:"em",animate:"rubberBand",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"震动",type:"em",animate:"shake",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"摇摆",type:"em",animate:"swing",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"嘚瑟",type:"em",animate:"tada",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"晃动",type:"em",animate:"wobble",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"拉扯",type:"em",animate:"jello",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"翻转",type:"em",animate:"flip",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"旋转",type:"em",animate:"rollOneCount",time:"1s",delay:"0s",count:1,fun:"linear"},{name:"逆转",type:"em",animate:"rollOneCount2",time:"1s",delay:"0s",count:1,fun:"linear"}],c={appType:"phone",version:"5.0.0",appWidth:320,appHeight:514},l=a(3),p=a.n(l),u=a(1),h=a(12);function d(){var e=c.appType,t=c.appWidth,a=c.appHeight;return{version:c.version,img:"http://cdn.h5ds.cn/static/images/img-null.png",desc:"点石H5，官方网站h5ds.cn",name:"点石H5",type:e,slider:{speed:.5,effect:"slide",autoplay:!1,time:5},style:{width:t,height:a},fixeds:[{id:null,className:null,keyid:h.a.randomID(),name:"浮动层上",style:{height:a,width:t},layers:[]},{id:null,className:null,keyid:h.a.randomID(),name:"浮动层下",style:{height:a,width:t},layers:[]}],popups:[],pages:[{id:null,className:null,keyid:h.a.randomID(),name:"空白页面",desc:"页面描述",style:{width:t,height:a},layers:[],slider:{animate:1,autoplay:!1,lock:!1,time:5}}]}}var m={RENDER_IN_PAGELIST:"render_in_pagelist",RENDER_IN_TEMPLATES:"render_in_templates",RENDER_IN_CANVAS:"render_in_canvas",RENDER_IN_PREVIEW:"render_in_preview",RENDER_IN_INDEPENDENT:"render_in_independent",RENDER_IN_PUBLISH:"render_in_publish"};a.d(t,"c",function(){return r}),a.d(t,"d",function(){return s}),a.d(t,"b",function(){return i}),a.d(t,"e",function(){return c}),a.d(t,"h",function(){return n}),a.d(t,"a",function(){return o}),a.d(t,"g",function(){return m}),a.d(t,"f",function(){return d})},function(e,t){e.exports=require("antd/es/message")},function(e,t){e.exports=require("@babel/runtime/helpers/initializerDefineProperty")},function(e,t,a){"use strict";a.d(t,"a",function(){return n});var n=window.PubSub;n&&(n.publish=n.publishSync)},function(e,t,a){"use strict";function n(e,t,a){return{configurable:!0,get:function(){var e=a.value.bind(this);return Object.defineProperty(this,t,{value:e,configurable:!0,writable:!0}),e}}}a.d(t,"a",function(){return n})},function(e,t){e.exports=require("@babel/runtime/helpers/slicedToArray")},function(e,t){e.exports=require("@babel/runtime/regenerator")},function(e,t,a){"use strict";var n=a(3),o=a.n(n),r=a(5),s=a.n(r),i=a(6),c=a.n(i),l=a(7),p=a.n(l),u=a(10),h=a.n(u),d=a(22),m=a.n(d),y=a(4),f=a.n(y),g=a(0),v=a.n(g),b=(a(67),a(16)),w=a(13),k=function(e){function t(){var e,a;o()(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=s()(this,(e=c()(t)).call.apply(e,[this].concat(r)))).outAnimateDo=function(){a.layerBoxRef&&(a.settime=setTimeout(function(){a.layerBoxRef.style.display="none",setTimeout(function(){a.layerBoxRef.style.display="block"})},200))},a.onClick=function(e){if(e.stopPropagation(),[w.g.RENDER_IN_PREVIEW,w.g.RENDER_IN_PUBLISH].includes(a.props.renderIn)){var t=a.props.layer.events,n=function(e,t){if(e.keyid===t.value){var n=null;n=a.props.renderIn===w.g.RENDER_IN_PREVIEW?document.querySelector('.h5ds-preview [data-keyid="'.concat(t.value,'"]')):document.querySelector('[data-keyid="'.concat(t.value,'"]'));var o=window.getComputedStyle(n).display;n.style.display="none"===o?"block":"none"}};(void 0===t?[]:t).forEach(function(e){var t=e.eventId,o=e.eventParam;switch(e.name,console.log(e),t){case"h5ds_event_topage":b.a.publish("h5ds.layerEvent.topage",o);break;case"h5ds_event_click":switch(o.eventName){case"h5ds_show_modal":a.props.appData?a.props.appData.popups.forEach(function(e){n(e,o)}):alert("单独使用Layer或者Page无需传入appData，弹窗事件无效！");break;case"h5ds_show_hide_layer":a.props.appData?a.props.pageData.layers.forEach(function(e){n(e,o)}):alert("单独使用Layer无需传入pageData，隐藏页面中的其他元素事件无效！");break;case"h5ds_custom_event_name":b.a.publish(o.value,o)}break;case"h5ds_event_link":location.href=o.value}})}},a}return p()(t,e),f()(t,[{key:"setAdsorb",value:function(e,t,a,n){var o=3<arguments.length&&void 0!==n?n:{};if(![w.g.RENDER_IN_PREVIEW,w.g.RENDER_IN_PUBLISH].includes(this.props.renderIn))return{top:t,left:a};var r=o.adsorbTopBottom,s=void 0===r?0:r,i=o.adsorbLeftRight,c=void 0===i?0:i,l=o.scale,p=void 0===l?1:l;switch(s/=p,c/=p,e){case"top-left":t-=s,a-=c;break;case"top-center":t-=s;break;case"top-right":t-=s,a+=c;break;case"left-center":a+=c;break;case"right-center":a-=c;break;case"bottom-left":t+=s,a-=c;break;case"bottom-center":t+=s;break;case"bottom-right":t+=s,a+=c}return{top:t,left:a}}},{key:"componentWillUnmount",value:function(){this.settime&&clearTimeout(this.settime)}},{key:"render",value:function(){var e=this,t=this.props,a=t.layer,n=t.zIndex,o=t.children,r=t.adsorbSet,s=t.initControl,i=["layer"],c=a.style,l=c.top,p=c.left,u=m()(c,["top","left"]),d=this.setAdsorb(a.adsorb,l,p,r),y=h()({zIndex:n,top:d.top,left:d.left},u);i.push("layer-".concat(a.pid)),a.className&&i.push(a.className),a.set&&a.set.hide&&i.push("layer-temporary-hide"),a.set&&a.set.lock&&i.push("layer-temporary-lock");var f=h()({},a.estyle)||{},g=[],b=null;switch(a.animate&&0<a.animate.length&&a.animate.forEach(function(e,t){0===t&&(b=e.type),g.push(e.style)}),"h5ds_text"===a.pid&&a.data.animate&&Object.assign(y,h()({},this.props.style)),b){case"in":Object.assign(y,h()({},this.props.style)),Object.assign(f,{opacity:0});break;case"out":this.outAnimateDo()}var w=this.onClick;return s&&(w=function(e){s(9999-n,e)}),v.a.createElement("div",{id:a.id,ref:function(t){return e.layerBoxRef=t},key:a.keyid,"data-keyid":a.keyid,onClick:w,className:i.join(" "),style:y},v.a.createElement("div",{ref:function(t){return e.layerRef=t},className:"element",style:h()({WebkitAnimation:g.join(","),animation:g.join(",")},f)},v.a.createElement("div",{style:{transform:y.flip?"scale(".concat(y.flip.join(","),")"):"scale(1,1)"},className:"element-flip"},o)))}}]),t}(g.Component),E=function(e){function t(){var e,a;o()(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=s()(this,(e=c()(t)).call.apply(e,[this].concat(r)))).autoplay=function(){var e=a.props.data.slider;a.props.isRenderThis&&e&&e.autoplay&&(a.timer=setTimeout(function(){window.swiperInstance&&window.swiperInstance.slideNext()},1e3*e.time))},a}return p()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.props.data&&this.autoplay()}},{key:"componentDidUpdate",value:function(){this.props.data&&this.autoplay()}},{key:"componentWillUnmount",value:function(){this.timer&&clearTimeout(this.timer)}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.plugins,o=t.isRenderThis,r=void 0===o||o,s=t.adsorbSet,i=t.initControl,c=t.appData,l=void 0===c?null:c;if(!a)return console.warn("pages/Page.js error, data is not null"),null;var p=n.pluginsKey,u=a.layers,d=void 0===u?[]:u,y=a.style,f=void 0===y?{}:y,g=null;return w.g.RENDER_IN_INDEPENDENT===this.props.renderIn?g=f:(f.backgroundColor,g=m()(f,["backgroundColor"])),v.a.createElement("div",{ref:function(t){return e.swiperPageRef=t},className:"h5ds-swiper-layers",style:h()({},g)},d.map(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o=1<arguments.length?arguments[1]:void 0,c=t.pid,u=t.leavePageUnmount,h=void 0!==u&&u,d=t.name,m=p[c],y=m?m.LayerComp:null;return h&&!r?null:30<o&&w.g.RENDER_IN_PAGELIST===e.props.renderIn?null:v.a.createElement(k,{style:{display:r?"block":"none"},appData:l,isRenderThis:r,pageData:a,renderIn:e.props.renderIn,initControl:i,layer:t,adsorbSet:s,zIndex:9999-o,key:t.keyid},y?v.a.createElement(y,{appData:l,pageData:a,isRender:r,renderIn:e.props.renderIn,layer:t,plugins:n}):v.a.createElement("div",{className:"layer-null"},"请载入",d,":",c,"插件",v.a.createElement("span",{style:{display:"none"}},JSON.stringify(t))))}))}}]),t}(g.Component),x=function(e){function t(){return o()(this,t),s()(this,c()(t).apply(this,arguments))}return p()(t,e),t}(E),O=function(e){function t(){return o()(this,t),s()(this,c()(t).apply(this,arguments))}return p()(t,e),t}(E);a.d(t,"c",function(){return E}),a.d(t,"d",function(){return O}),a.d(t,"a",function(){return x}),a.d(t,"b",function(){return k})},function(e,t){e.exports=require("antd/es/input-number")},function(e,t){e.exports=require("@babel/runtime/helpers/objectWithoutProperties")},function(e,t){e.exports=require("antd/es/switch")},function(e,t){e.exports=require("@babel/runtime/helpers/extends")},function(e,t){e.exports=require("antd/es/button")},function(e,t){e.exports=require("antd/es/tabs")},function(e,t){e.exports=require("@babel/runtime/helpers/asyncToGenerator")},function(e,t){e.exports=require("antd/es/message/style")},function(e,t){e.exports=require("antd/es/radio")},function(e,t){e.exports=require("antd/es/select")},function(e,t){e.exports=require("url-parse")},function(e,t){e.exports=require("antd/es/input")},function(e,t){e.exports=require("@babel/runtime/helpers/defineProperty")},function(e,t){e.exports=require("antd/es/icon")},function(e,t,a){"use strict";var n={};a.r(n),a.d(n,"img",function(){return C}),a.d(n,"text",function(){return P}),a.d(n,"sound",function(){return N}),a.d(n,"combin",function(){return S}),a.d(n,"shape",function(){return D});var o=a(19),r=a.n(o),s=a(27),i=a.n(s),c=a(10),l=a.n(c),p=a(11),u=a.n(p),h=a(39),d=a(16);function m(){return(m=i()(r.a.mark(function e(t,a){var n,o,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],0===t.length)return d.a.publish("h5ds.load.plugins",{count:0,index:0,progress:1,name:"",type:a}),e.abrupt("return",n);e.next=4;break;case 4:o=r.a.mark(function e(o){var s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t[o])return e.next=4,new Promise(function(e){console.log("load",s),requirejs([s],function(r){d.a&&d.a.publish("h5ds.load.plugins",{count:t.length,index:o,progress:(o+1)/t.length,name:s,type:a}),n.push(r),e()})});e.next=4;break;case 4:case"end":return e.stop()}},e)}),s=0;case 6:if(s<t.length)return e.delegateYield(o(s),"t0",8);e.next=11;break;case 8:s++,e.next=6;break;case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function y(e){return e=e.filter(function(e){return e}),new Promise(function(t,a){if(0<e.length){var n=new h.a(e),o=0;n.on("progress",function(t){d.a&&d.a.publish("h5ds.load.plugins",{count:e.length,index:o++,progress:t.loaded,name:t.src,type:"script"})}),n.on("complete",function(e){if(0<e.error.length)return console.error("部分资源载入错误",e.error),void a();t()}),n.load()}else d.a.publish("h5ds.load.plugins",{count:0,index:0,progress:1,name:"",type:"script"}),t()})}function f(){return(f=i()(r.a.mark(function e(t){var a,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:a=document.getElementsByTagName("head")[0],(n=document.createElement("link")).type="text/css",n.rel="stylesheet",n.href=t,a.appendChild(n);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var g=a(13);function v(e){e.forEach(function(e){switch(e.type){case"img":e.pid="h5ds_img",e.name="图片";var t=e.data,a=t.crop,n=t.src;e.data={naturalWidth:200,naturalHeight:150,crop:a,src:n};break;case"etext":e.pid="h5ds_text",e.name="文本";break;case"map":e.pid="h5ds-map",e.name="地图",e.data.title=e.data.name,delete e.data.infoshow,delete e.data.info;break;case"shape":e.pid="h5ds_shape",e.name="形状";break;case"sound":e.pid="h5ds_sound",e.name="音频",e.data.icon="",e.data.autoplay=!0,e.data.loop=!1;break;case"combin":e.pid="h5ds_combin",e.name="合并层",e.layers&&(e.version="1.0.0",e.events=[],delete e.color,delete e.eid,v(e.layers))}"形状"===e.name&&(e.pid="h5ds_shape",e.name="形状"),e.version="1.0.0",e.events=[],delete e.color,delete e.eid})}function b(e){if("defaultData"===e)return e;switch("".concat(e.version,"->").concat(g.e.version)){case"undefined->5.0.0":e=function(e){function t(t){t.style||(t.style={}),"phone"===e.type?(t.style.width||(t.style.width=320),t.style.height||(t.style.height=514)):(t.style.width||(t.style.width=600),t.style.height||(t.style.height=800))}return e.version=g.e.version,e.slider={speed:.5,effect:"slide",autoplay:!1,time:5},delete e.mp3,t(e),[].concat(u()(e.fixeds),u()(e.popups),u()(e.pages)).forEach(function(e){t(e),v(e.layers)}),JSON.parse(JSON.stringify(e))}(e)}return e}var w=a(3),k=a.n(w),E=a(4),x=a.n(E),O=new(function(){function e(){k()(this,e)}return x()(e,[{key:"getPid",value:function(e,t){var a=this;e&&e.forEach(function(e){t.push(e.pid),"h5ds_combin"===e.pid&&a.getPid(e.data,t)})}},{key:"getPidByPageData",value:function(e){var t=[];return this.getPid(e.layers,t),(t=(t=Array.from(new Set(t))).filter(function(e){return!["h5ds_combin","h5ds_img","h5ds_shape","h5ds_sound","h5ds_text"].includes(e)})).filter(function(e){return e})}},{key:"getPidByData",value:function(e){var t=this,a=[],n=e.pages,o=void 0===n?[]:n,r=e.fixeds,s=void 0===r?[]:r,i=e.popups,c=void 0===i?[]:i;return[].concat(u()(o),u()(s),u()(c)).forEach(function(e){t.getPid(e.layers,a)}),(a=(a=Array.from(new Set(a))).filter(function(e){return!["h5ds_combin","h5ds_img","h5ds_shape","h5ds_sound","h5ds_text"].includes(e)})).filter(function(e){return e})}}]),e}()),S=a(47),C=a(43),D=a(46),N=a(45),P=a(44);function j(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"layer",o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:n;return new Promise(function(n){e.forEach(function(e){!function(e){f.apply(this,arguments)}("".concat(t,"/plugins/").concat(e,"/").concat(a,"/style.css"))}),function(e,t,a,n){var o=0<arguments.length&&void 0!==e?e:[],r=1<arguments.length&&void 0!==t?t:"",s=2<arguments.length&&void 0!==a?a:"layer",i=3<arguments.length?n:void 0,c=[];(o=o.filter(function(e){return e})).forEach(function(e){c=[].concat(u()(c),["".concat(r,"/plugins/").concat(e,"/").concat(s,"/index.js")])});var p=[];return function(e,t){return m.apply(this,arguments)}(c,s).then(function(e){return[].concat(u()(Object.values(i)),u()(e)).forEach(function(e){e.config?p.push(l()({},e,e.config)):console.error("插件必须包括config文件，具体配置查看官方文档doc.h5ds.com",e)}),p})}(e,t,a,o).then(function(e){var t=[],a={};return e.forEach(function(e){e.scripts&&(t=[].concat(u()(e.scripts),u()(t))),a[e.pid]=e}),{scripts:t=Array.from(new Set(t)),pluginsKey:a}}).then(function(e){var t=e.scripts,a=e.pluginsKey;y(t).then(function(){n({scripts:t,pluginsKey:a})})})})}var L=a(31),I=a.n(L),A=new(function(){function e(){k()(this,e),this.baseData={},this.reportUrl=location.href}return x()(e,[{key:"setReportUrl",value:function(e){this.reportUrl=e}},{key:"setUid",value:function(e){this.reportUrl.uid=e}},{key:"setAppId",value:function(e){this.baseData.appId=e}},{key:"doReport",value:function(e,t){if(!e)throw new Error("请设置上报地址");t=Object.assign({},t,this._getBaseData(),this.baseData),window.navigator.sendBeacon?this._doReportBySendBeacon(e,t):this._doReportByImg(e,t)}},{key:"_data2QueryString",value:function(e){var t=I()("");return t.set("query",e),t.href.split("?")[1]}},{key:"_getBaseData",value:function(){return{nl:navigator.language,np:navigator.platform,nje:navigator.javaEnabled(),nmtp:navigator.maxTouchPoints,nce:navigator.cookieEnabled,nd:navigator.doNotTrack,ndm:navigator.deviceMemory,ndc:navigator.hardwareConcurrency,sr:"".concat(screen.width,"*").concat(screen.height),scd:screen.colorDepth,dc:document.charset||document.characterSet,dr:document.referrer,t:Date.now()}}},{key:"_makeRndString",value:function(){return Math.random().toString(16)}},{key:"_doReportByImg",value:function(e,t){var a="".concat(e,"?").concat(this._data2QueryString(t)),n="report_img_".concat(this._makeRndString()),o=window[n]=new Image;o.onload=o.onerror=function(){window[n]=null},o.src=a}},{key:"_doReportBySendBeacon",value:function(e,t){var a=new FormData;Object.keys(t).forEach(function(e){return a.append(e,t[e])}),window.navigator.sendBeacon(e,a)}},{key:"sendPageView",value:function(){var e=location.pathname;this.doReport(this.reportUrl,{path:e})}}]),e}());a.d(t,"d",function(){return j}),a.d(t,"a",function(){return O}),a.d(t,"c",function(){return v}),a.d(t,"b",function(){return b}),a.d(t,"f",function(){return A}),a.d(t,"e",function(){return y})},function(e,t){e.exports=require("antd/es/input-number/style")},function(e,t){e.exports=require("antd/es/switch/style")},function(e,t,a){"use strict";function n(){var e={start:"mousedown",move:"mousemove",end:"mouseup",touch:!1,touchEvent:function(e){return e.originalEvent.targetTouches[0]}};return"ontouchend"in document&&(e.start="touchstart",e.move="touchmove",e.end="touchend",e.touch=!0),e}a.d(t,"a",function(){return n})},function(e,t,a){"use strict";a.d(t,"a",function(){return u});var n=a(19),o=a.n(n),r=a(27),s=a.n(r),i=a(3),c=a.n(i),l=a(4),p=a.n(l),u=function(){function e(t){c()(this,e),this.progress=null,this.manifest=this.setSource(t),this.sources=t}return p()(e,[{key:"imgLazy",value:function(e){return new Promise(function(t,a){var n=new Image;n.src=e,n.onload=function(){t(n)},n.onerror=function(){console.error("图片加载失败",n),a(n)}})}},{key:"soundLazy",value:function(e){return new Promise(function(t,a){var n=new Audio(e);n.onloadedmetadata=function(){t(n)},n.onerror=function(){console.error("sound加载失败",e),a(e)},n.src=e})}},{key:"jsLazy",value:function(e){return new Promise(function(t,a){var n=document.createElement("script");n.type="text/javascript",n.charset="utf-8",n.async="async",n.src=e,document.head.appendChild(n),n.onload=function(){t(n)},n.onerror=function(){console.error("js加载失败",e),a(e)}})}},{key:"load",value:function(){var e=this,t=this.manifest;return new Promise(function(){var a=s()(o.a.mark(function a(n,r){var s,i,c,l;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:s=[],i=[],c=o.a.mark(function a(n){var r,c,l,p;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:r=t[n],c=r.src,l=r.id,p=r.type,a.t0=p,a.next="image"===a.t0?4:"js"===a.t0?7:"sound"===a.t0?10:13;break;case 4:return a.next=6,e.imgLazy(c).then(function(){i.push({src:c,id:l,type:p}),e.progress&&e.progress({src:c,id:l,type:p,success:!0,loaded:(n+1)/t.length})}).catch(function(){s.push({src:c,id:l,type:p}),e.progress&&e.progress({src:c,id:l,type:p,success:!1,loaded:(n+1)/t.length})});case 6:return a.abrupt("break",13);case 7:return a.next=9,e.jsLazy(c).then(function(){i.push({src:c,id:l,type:p}),e.progress&&e.progress({src:c,id:l,type:p,success:!0,loaded:(n+1)/t.length})}).catch(function(){s.push({src:c,id:l,type:p}),e.progress&&e.progress({src:c,id:l,type:p,success:!1,loaded:(n+1)/t.length})});case 9:return a.abrupt("break",13);case 10:return a.next=12,e.soundLazy(c).then(function(){i.push({src:c,id:l,type:p}),e.progress&&e.progress({src:c,id:l,type:p,success:!0,loaded:(n+1)/t.length})}).catch(function(){s.push({src:c,id:l,type:p}),e.progress&&e.progress({src:c,id:l,type:p,success:!1,loaded:(n+1)/t.length})});case 12:return a.abrupt("break",13);case 13:case"end":return a.stop()}},a)}),l=0;case 4:if(l<t.length)return a.delegateYield(c(l),"t0",6);a.next=9;break;case 6:l++,a.next=4;break;case 9:e.complete&&e.complete({error:s,success:i}),i.length===t.length?(e.success&&e.success(),n({error:s,success:i})):(e.error&&e.error(),r({error:s,success:i}));case 11:case"end":return a.stop()}},a)}));return function(e,t){return a.apply(this,arguments)}}())}},{key:"on",value:function(e,t){switch(e){case"progress":this.progress=t;break;case"error":this.error=t;break;case"complete":this.complete=t;break;case"success":this.success=t}}},{key:"setSource",value:function(e){if(e){var t=e.map(function(e,t){var a="*",n=e.replace(/.+\.(.+)/,"$1");return-1!==["jpg","gif","png","jpeg"].indexOf(n)?a="image":-1!==["mp3","wav","ogg","acc","webm"].indexOf(n)?a="sound":-1!==["js","es"].indexOf(n)&&(a="js"),{src:e,id:"source_"+t,type:a}});return this.manifest=t}}}]),e}()},function(e,t,a){"use strict";a.d(t,"a",function(){return u});var n=a(11),o=a.n(n),r=a(18),s=a.n(r),i=a(3),c=a.n(i),l=a(4),p=a.n(l),u=new(function(){function e(){c()(this,e)}return p()(e,[{key:"getTransform",value:function(e){var t=0<arguments.length&&void 0!==e?e:[],a=s()(t,2),n=a[0],o=a[1],r=Math.sqrt(n*n+o*o),i=this.getRotate(t);return{x:parseFloat(t[4]),y:parseFloat(t[5]),translate:[parseFloat(t[4]),parseFloat(t[5])],scale:r,rotate:i}}},{key:"getRotate",value:function(e){var t=0<arguments.length&&void 0!==e?e:[],a=s()(t,2),n=a[0],o=a[1],r=Math.round(Math.atan2(o,n)*(180/Math.PI));return 360<r?r%=360:r<0&&(r+=360),r}},{key:"setRotate",value:function(e,t){e-=this.getAngle(t);var a=[Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0];return this.concat(t,a)}},{key:"setScale",value:function(e,t,a){var n=[e,0,0,t=t||e,0,0];return this.concat(a,n)}},{key:"setTranslate",value:function(e,t,a){return this.concat(a,[1,0,0,1,e,t])}},{key:"getAngle",value:function(e){return Math.atan2(e[1],e[0])}},{key:"concat",value:function(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}},{key:"setTransform",value:function(e,t){e=this.testjQuery(e);var a=this.convertMatrixToArray(e);if(t.rotate&&(a=this.setRotate(parseFloat(t.rotate)/180*Math.PI,a)),t.translate){var n=t.translate.replace(/\s|px/g,"").split(","),r=s()(n,2),i=r[0],c=r[1];a=this.translate(parseFloat(i),parseFloat(c),a)}return t.scale&&(a=this.translate(parseFloat(t.scale),parseFloat(t.scale),a)),this.getTransform(o()(a))}},{key:"getTranslate",value:function(e,t){var a;e=this.testjQuery(e);var n=this.convertMatrixToArray(e),o=parseFloat(n[5]),r=parseFloat(n[4]);return"Y"===t&&(a=o),"X"===t&&(a=r),void 0===t&&(a=[r,o]),a}},{key:"getScale",value:function(e,t){var a;e=this.testjQuery(e);var n=this.convertMatrixToArray(e),o=parseFloat(n[3]),r=parseFloat(n[0]);return"Y"===t&&(a=o),"X"===t&&(a=r),void 0===t&&(a=[r,o]),a}},{key:"convertMatrixToArray",value:function(e){e=this.testjQuery(e);var t=window.getComputedStyle(e,null),a=t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform")||null;return a=(a=String(a).replace("matrix(","").replace(")","").replace(" ","")).split(","),[parseFloat(a[0])||1,parseFloat(a[1])||0,parseFloat(a[2])||0,parseFloat(a[3])||1,parseFloat(a[4])||0,parseFloat(a[5])||0]}},{key:"testjQuery",value:function(e){return e instanceof jQuery&&(e=e[0]),e}},{key:"radiansToDeg",value:function(e){var t=180*e/Math.PI;return parseInt(t.toFixed(0),10)}}]),e}())},function(e,t){e.exports=require("tinycolor2")},function(e,t){e.exports=require("antd/es/button/style")},function(e,t,a){"use strict";a.r(t);var n=a(3),o=a.n(n),r=a(4),s=a.n(r),i=a(5),c=a.n(i),l=a(6),p=a.n(l),u=a(7),h=a.n(u),d=(a(68),a(0)),m=a.n(d),y={name:"图片",pid:"h5ds_img",version:"1.0.0"};a.d(t,"LayerComp",function(){return f}),a.d(t,"config",function(){return y});var f=function(e){function t(){return o()(this,t),c()(this,p()(t).apply(this,arguments))}return h()(t,e),s()(t,[{key:"render",value:function(){var e=this.props.layer,t={};e.data.crop&&(t=JSON.parse(e.data.crop));var a=t,n=a.top,o=void 0===n?0:n,r=a.left,s=void 0===r?0:r,i=a.width,c=void 0===i?1:i,l=a.height,p=void 0===l?1:l,u={top:-o,left:-s,width:a.naturalWidth,height:a.naturalHeight},h={width:c,height:p,transform:"scale(".concat(e.style.width/c,", ").concat(e.style.height/p,")")};return m.a.createElement("div",{className:"layer-h5ds_img-inner",style:h},m.a.createElement("div",{className:"layer-h5ds_img-box",style:u},m.a.createElement("img",{src:e.data.src||"http://cdn.h5ds.cn/lib/images/imgDom.jpg"})))}}]),t}(d.Component)},function(e,t,a){"use strict";a.r(t);var n=a(24),o=a.n(n),r=a(10),s=a.n(r),i=a(3),c=a.n(i),l=a(4),p=a.n(l),u=a(5),h=a.n(u),d=a(6),m=a.n(d),y=a(7),f=a.n(y),g=(a(74),a(0)),v=a.n(g),b=a(50),w={name:"文本",pid:"h5ds_text",version:"1.0.0"};a.d(t,"LayerComp",function(){return k}),a.d(t,"config",function(){return w});var k=function(e){function t(){var e,a;c()(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=h()(this,(e=m()(t)).call.apply(e,[this].concat(o)))).getHtml=function(e,t){var n="";if(e=(e=(e=(e=(e=e.replace(/&nbsp;/g,"⑴")).replace(/&quot;/g,"⑵")).replace(/&amp;/g,"⑶")).replace(/&lt;/g,"⑷")).replace(/&gt;/g,"⑸"),t){var o=0,r=!1;e.split("").forEach(function(e){if("<"===e&&(r=!0),r)n+=e;else{var s=parseFloat(t.delay)+parseFloat(t.interval)*o;o++,n+='<span class="animated" style="animation: '.concat(t.animate," ").concat(t.time," ").concat(t.fun," ").concat(s,"s ").concat(t.count,' normal forwards running;\n        opacity: 0">').concat(a.filterHtml(e),"</span>")}">"===e&&(r=!1)})}else{var s=!1;e.split("").forEach(function(e){"<"===e&&(s=!0),n+=s?e:"<span>".concat(a.filterHtml(e),"</span>"),">"===e&&(s=!1)})}return n},a}return f()(t,e),p()(t,[{key:"filterHtml",value:function(e){switch(e){case" ":case"⑴":e="&nbsp;";break;case"⑵":e="&quot;";break;case"⑶":e="&amp;";break;case"⑷":e="&lt;";break;case"⑸":e="&gt;"}return e}},{key:"render",value:function(){var e=this.props.layer.data,t=e.style,a=e.keyid,n=void 0===a?"":a,r=e.data,i=void 0===r?"":r,c=e.artword,l=void 0===c?{}:c,p=e.animate,u=e.fontFamilySet,h=void 0===u?{}:u,d=this.getHtml(i,p),m="@font-face {\n      font-family: ".concat(h.name,";\n      src: url(").concat(h.url,");\n    }");return l.type&&delete t.color,v.a.createElement("div",{className:"layer-h5ds_text-inner"},v.a.createElement("div",{className:"layer-h5ds_text-box",key:n},l.type?v.a.createElement("div",{className:"layer-h5ds_text-auto",style:s()({},t)},v.a.createElement(b.a,o()({shtml:d},l))):v.a.createElement("div",{className:"layer-h5ds_text-auto",style:s()({},t),dangerouslySetInnerHTML:{__html:d}}),h.url?v.a.createElement("style",null,m):null))}}]),t}(g.Component)},function(e,t,a){"use strict";a.r(t);var n,o=a(3),r=a.n(o),s=a(4),i=a.n(s),c=a(5),l=a.n(c),p=a(6),u=a.n(p),h=a(7),d=a.n(h),m=a(2),y=a.n(m),f=(a(70),a(0)),g=a.n(f),v=a(17),b={leavePageUnmount:!0,pid:"h5ds_sound",name:"音频",version:"1.0.0"},w=a(13),k=a(12);a.d(t,"LayerComp",function(){return E}),a.d(t,"config",function(){return b});var E=(n=function(e){function t(e){var a;r()(this,t),(a=l()(this,u()(t).call(this,e))).soundId="id_"+k.a.randomID();var n=e.layer.data;return a.state={status:n.autoplay?"play":"pause"},a}return d()(t,e),i()(t,[{key:"doMusic",value:function(e){var t=this;e=e||this.state.status;var a=this.props.layer;[w.g.RENDER_IN_PREVIEW,w.g.RENDER_IN_CANVAS,w.g.RENDER_IN_PUBLISH].includes(this.props.renderIn)&&("play"===e?(this.temp&&clearTimeout(this.temp),this.setState({status:"pause"},function(){document.getElementById(t.soundId).pause()})):this.temp=setTimeout(function(){t.setState({status:"play"},function(){document.getElementById(t.soundId).play()})},1e3*parseFloat(a.data.delay)))}},{key:"clickMusic",value:function(){this.props.renderIn!==w.g.RENDER_IN_CANVAS&&this.doMusic()}},{key:"componentDidMount",value:function(){this.props.layer.data.autoplay&&this.doMusic("play"===this.state.status?"pause":"play")}},{key:"componentWillUnmount",value:function(){document.getElementById(this.soundId).pause(),this.temp&&clearTimeout(this.temp)}},{key:"render",value:function(){var e=this,t=this.props.layer,a=this.state.status,n=null;switch(t.data.icon){case"default":n=g.a.createElement("div",{onClick:this.clickMusic,style:{transform:"scale(".concat(t.style.width/26,", ").concat(t.style.height/26,")")},className:"play"===a?"h5ds_sound-icon h5ds_sound-iconing":"h5ds_sound-icon"},g.a.createElement("i",null),g.a.createElement("i",null),g.a.createElement("i",null),g.a.createElement("i",null));break;case"null":n=null;break;default:n=g.a.createElement("img",{src:t.data.icon})}return g.a.createElement("div",{ref:function(t){return e.innerLayerRef=t},className:"layer-h5ds_sound-inner"},n,g.a.createElement("audio",{id:this.soundId,preload:"preload",loop:t.data.loop},g.a.createElement("source",{src:t.data.sound,type:"audio/mpeg"})))}}]),t}(f.Component),y()(n.prototype,"doMusic",[v.a],Object.getOwnPropertyDescriptor(n.prototype,"doMusic"),n.prototype),y()(n.prototype,"clickMusic",[v.a],Object.getOwnPropertyDescriptor(n.prototype,"clickMusic"),n.prototype),n)},function(e,t,a){"use strict";a.r(t);var n=a(10),o=a.n(n),r=a(3),s=a.n(r),i=a(4),c=a.n(i),l=a(5),p=a.n(l),u=a(6),h=a.n(u),d=a(7),m=a.n(d),y=(a(69),a(0)),f=a.n(y),g={pid:"h5ds_shape",name:"形状",version:"1.0.0"},v=a(48);a.d(t,"LayerComp",function(){return b}),a.d(t,"config",function(){return g});var b=function(e){function t(){return s()(this,t),p()(this,h()(t).apply(this,arguments))}return m()(t,e),c()(t,[{key:"render",value:function(){var e=this.props.layer.data,t=e.style,a=e.transform,n=e.shape,r=v.a.find(function(e){return e.type===n}),s=this.props.layer.style,i=s.width,c=s.height;return r?f.a.createElement("div",{className:"layer-h5ds_shape-inner"},f.a.createElement("div",{style:{transform:a},className:"layer-h5ds_shape-dom"},r.dom(o()({},t,{width:i,height:c})))):null}}]),t}(y.Component)},function(e,t,a){"use strict";a.r(t);var n=a(10),o=a.n(n),r=a(3),s=a.n(r),i=a(4),c=a.n(i),l=a(5),p=a.n(l),u=a(6),h=a.n(u),d=a(7),m=a.n(d),y=(a(66),a(0)),f=a.n(y),g=a(20),v={name:"合并图层",pid:"h5ds_combin",version:"1.0.0"};a.d(t,"LayerComp",function(){return b}),a.d(t,"config",function(){return v});var b=function(e){function t(){return s()(this,t),p()(this,h()(t).apply(this,arguments))}return m()(t,e),c()(t,[{key:"render",value:function(){var e=this.props,t=e.layer,a=e.renderIn,n=e.plugins,r=t.originstyle,s=t.style,i=o()({},r,{transform:"scale(".concat(s.width/r.width,", ").concat(s.height/r.height,")")}),c={layers:t.data,style:{}};return f.a.createElement("div",{className:"layer-h5ds_combin",style:o()({},i)},t?f.a.createElement(g.c,{data:c,plugins:n,renderIn:a}):null)}}]),t}(y.Component)},function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(0),o=a.n(n),r=[{type:"line",name:"线条",img:"http://cdn.h5ds.cn/static/images/line.png",dom:function(e){var t=0<arguments.length&&void 0!==e?e:{};return o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 ".concat(t.width||1," ").concat(t.height||1),xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("line",{x1:0,y1:0,x2:t.width||1,y2:t.height||1,style:{stroke:t.fill||"#000",strokeWidth:t.strokeWidth||1}}))}},{type:"star4",name:"四角星",dom:function(e){var t=0<arguments.length&&void 0!==e?e:{};return o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M523.93046471 1021.82852532L408.07239629 618.0485752 1.90635325 510.6743928l401.12873572-105.25321088 97.03444632-403.24970724L615.92760371 405.9514248l406.16604304 107.3741824-401.12873572 105.25321088-97.03444632 403.24970724z",fill:t.fill}))}},{type:"star5",name:"五星",dom:function(e){var t=0<arguments.length&&void 0!==e?e:{};return o.a.createElement("svg",{preserveAspectRatio:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1092 1024",version:"1.1"},o.a.createElement("path",{fill:t.fill,d:"M546.133333 819.2l-320.989866 168.7552 61.303466-357.444267L26.760533 377.378133l358.877867-52.155733L546.133333 0l160.494934 325.2224 358.877866 52.155733-259.6864 253.1328 61.303467 357.444267z"}))}},{type:"circle",name:"圆形",dom:function(e){var t=0<arguments.length&&void 0!==e?e:{};return o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M512 512m-512 0a512 512 0 1 0 1024 0 512 512 0 1 0-1024 0Z",fill:t.fill}))}},{type:"path3",name:"三角形",dom:function(e){var t=0<arguments.length&&void 0!==e?e:{};return o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1170 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M583.475783 1024L1.458689 0H1166.951567z",fill:t.fill}))}},{type:"path4",name:"四边形",dom:function(e){var t=0<arguments.length&&void 0!==e?e:{};return o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("rect",{x:"0",y:"0",width:"100",height:"100",fill:t.fill}))}},{type:"path5",name:"五边形",dom:function(e){var t=0<arguments.length&&void 0!==e?e:{};return o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M512.128 0l-512 391.04L195.648 1024h632.64l195.84-632.96z",fill:t.fill}))}},{type:"path6",name:"六边形",dom:function(e){var t=0<arguments.length&&void 0!==e?e:{};return o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M768 64H256L0 512l256 448h512l256-448z",fill:t.fill}))}},{type:"path7",name:"平行四边形",dom:function(e){var t=0<arguments.length&&void 0!==e?e:{};return o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M630.08 1024H0L393.6 0H1024z",fill:t.fill}))}},{type:"path8",name:"梯形",dom:function(e){var t=0<arguments.length&&void 0!==e?e:{};return o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M1024 1024H0L256 0h512z",fill:t.fill}))}},{type:"path9",name:"菱形",dom:function(e){var t=0<arguments.length&&void 0!==e?e:{};return o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M0 512L512 0l512 512-512 512z",fill:t.fill}))}},{type:"path10",name:"管道",dom:function(e){var t=0<arguments.length&&void 0!==e?e:{};return o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M1024 704V320c-176.736 0-320-143.264-320-320H320c0 176.736-143.264 320-320 320v384c176.736 0 320 143.264 320 320h384c0-176.736 143.264-320 320-320z",fill:t.fill}))}},{type:"icon-qipao",name:"气泡",dom:function(e){var t=0<arguments.length&&void 0!==e?e:{};return o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1194 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M597.333333 920.618667c-40.106667 0-79.274667-2.816-117.205333-8.448-131.882667 46.677333-176.426667 63.957333-309.205333 111.146666 33.536-74.666667 45.653333-115.029333 76.373333-190.037333C97.706667 749.482667 0 613.546667 0 460.672 0 205.653333 267.392 0 597.333333 0s597.333333 205.653333 597.333334 460.672c0 254.293333-267.392 459.946667-597.333334 459.946667z",fill:t.fill}))}},{type:"icon-heart",name:"心",dom:function(e){var t=0<arguments.length&&void 0!==e?e:{};return o.a.createElement("svg",{preserveAspectRatio:"none",viewBox:"0 0 1025 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M755.072 64q-26.016 0-52 7.008t-48.992 19.008-44.512 28.992-39.488 36.992-32.512 42.016-25.504 44.992q-35.008-74.016-100.992-126.496t-142.016-52.512q-111.008 0-190.016 79.008t-79.008 190.016q0 62.016 16.992 116.512t48.512 98.496 70.496 84.512 88 83.008 95.488 84 99.008 97.504 93.504 115.008q39.008-58.016 90.016-114.496t97.504-99.008 96-85.504 88.992-84 72-84.992 50.016-97.504 17.504-113.504q0-111.008-79.008-190.016t-190.016-79.008z",fill:t.fill}))}}]},function(e,t,a){"use strict";var n,o,r,s,i,c=a(24),l=a.n(c),p=a(3),u=a.n(p),h=a(4),d=a.n(h),m=a(5),y=a.n(m),f=a(6),g=a.n(f),v=a(7),b=a.n(v),w=a(2),k=a.n(w),E=(a(75),a(0)),x=a.n(E),O=a(10),S=a.n(O),C=a(18),D=a.n(C),N=a(20),P=a(16),j=a(12),L=function(e){function t(e){var a;return u()(this,t),(a=y()(this,g()(t).call(this,e))).state={realIndex:0},a}return b()(t,e),d()(t,[{key:"componentDidMount",value:function(){var e=this;P.a.subscribe("h5ds.hide.fixed.module",function(t,a){e.setState({realIndex:a})})}},{key:"componentWillUnmount",value:function(){P.a.unsubscribe("h5ds.hide.fixed.module")}},{key:"render",value:function(){var e=this.state.realIndex,t=this.props,a=t.data,n=t.transformStyle,o=t.plugins,r=t.renderIn,s=t.scale,i=t.setPageStyle,c=D()(a.fixeds,2),l=c[0],p=c[1];return x.a.createElement("div",{className:"h5ds-fixeds"},[l,p].map(function(t,c){var l=null,u=null;0===c&&((t=j.a.toJS(t)).style.height=p.style.height);var h=i(t),d=h.innerStyle,m=h.boxStyle,y=h.adsorbTopBottom,f=h.adsorbLeftRight;return 0===c?(u="h5dsFixedsUp",d.height=0,l={display:e===a.pages.length?"none":"block"}):u="h5dsFixedsDown",x.a.createElement("div",{key:u,style:l,id:u},x.a.createElement("div",{className:"h5ds-swiper-page"},x.a.createElement("div",{className:"h5ds-pages-box",style:m},x.a.createElement("div",{style:S()({},d,n),className:"h5ds-swiper-pageinner"},x.a.createElement(N.a,{adsorbSet:{scale:s,adsorbTopBottom:y,adsorbLeftRight:f},plugins:o,appData:a,data:t,renderIn:r})))))}))}}]),t}(E.Component),I=a(11),A=a.n(I),T=(a(76),a(51)),z=a.n(T),_=a(17),$=(n=function(e){function t(e){var a;return u()(this,t),(a=y()(this,g()(t).call(this,e))).id=j.a.randomID(),a}return b()(t,e),d()(t,[{key:"review",value:function(){this.props.slideTo(0)}},{key:"dosame",value:function(){location.href="http://www.h5ds.com"}},{key:"render",value:function(){var e=this.props,t=e.data,a=e.style,n=e.index;return x.a.createElement("div",{id:"ppp","data-swiper-slide-index":n,style:a,className:"h5ds-swiper-page swiper-slide h5ds-last-page"},x.a.createElement("div",{className:"h5ds-swiper-pageinner"},x.a.createElement("div",{className:"h5ds-last-info"},x.a.createElement("img",{src:t.img,alt:""}),x.a.createElement("h1",null,t.name),x.a.createElement("p",null,t.desc),x.a.createElement("div",{className:"h5ds-last-btns"},x.a.createElement(z.a,{onTap:this.dosame},x.a.createElement("button",{id:"dosame_".concat(this.id)},"制作同款")),x.a.createElement(z.a,{onTap:this.review},x.a.createElement("button",{id:"review_".concat(this.id)},"再看一遍")))),x.a.createElement("div",{className:"h5ds-last-power"},"Powered by ",x.a.createElement("a",{href:"http://h5ds.cn"},"h5ds.cn"))))}}]),t}(E.Component),k()(n.prototype,"review",[_.a],Object.getOwnPropertyDescriptor(n.prototype,"review"),n.prototype),k()(n.prototype,"dosame",[_.a],Object.getOwnPropertyDescriptor(n.prototype,"dosame"),n.prototype),n),W=(o=function(e){function t(e){var a;return u()(this,t),(a=y()(this,g()(t).call(this,e))).state={realIndex:0,offset:0,from:0,to:1,slides:[0]},a.data=e.data,a.id="h5ds_swiper_".concat(j.a.randomID()),a}return b()(t,e),d()(t,[{key:"slideTo",value:function(e,t){var a=1<arguments.length&&void 0!==t?t:0;this.swiperInstance.slideTo(e,a)}},{key:"updateSwiper",value:function(){this.swiperInstance.updateSize(),this.swiperInstance.updateSlides(),this.slideTo(0)}},{key:"slideChangeTransitionEnd",value:function(){var e=this.swiperInstance.snapIndex;P.a.publish("h5ds.hide.fixed.module",e),this.setState(S()({realIndex:e},this.renderExternalData))}},{key:"slideNext",value:function(){this.swiperInstance&&this.swiperInstance.slideNext()}},{key:"slidePrev",value:function(){this.swiperInstance&&this.swiperInstance.slidePrev()}},{key:"renderExternal",value:function(e){var t=e.offset,a=e.slides,n=e.from,o=e.to;this.renderExternalData={offset:t,slides:A()(a),from:n,to:o}}},{key:"newSwiper",value:function(){var e=this.data.slider,t=e.time,a=e.effect,n=e.autoplay,o=e.speed,r=void 0===o?.5:o,s=this.data.pages.length;n=n&&{delay:1e3*t,disableOnInteraction:!1},this.swiperInstance=new Swiper("#".concat(this.id),{virtual:{slides:new Array(s).fill(1).map(function(e,t){return t}),cache:!1,renderExternal:this.renderExternal},loop:!1,speed:1e3*r,autoplay:n,roundLengths:!0,direction:"vertical",effect:a,watchOverflow:!0,noSwiping:!0,noSwipingClass:"h5ds-swiper-page-noswiper",pagination:{el:".swiper-pagination",type:"progressbar",progressbarOpposite:!0}}),this.swiperInstance.on("transitionEnd",this.slideChangeTransitionEnd),window.swiperInstance=this.swiperInstance}},{key:"componentDidMount",value:function(){this.newSwiper()}},{key:"componentWillUnmount",value:function(){this.swiperInstance.destroy(),window.swiperInstance=void 0}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.transformStyle,o=t.plugins,r=t.style,s=t.renderIn,i=t.scale,c=t.setPageStyle,l=this.state,p=l.slides,u=l.offset,h=this.state.realIndex,d=A()(a.pages),m=Object.assign({},S()({},a.style),S()({},r));return x.a.createElement("div",{id:this.id,className:"h5ds-pages swiper-container",style:S()({},m)},x.a.createElement("div",{className:"swiper-wrapper"},p.map(function(t){var r=d[t];if("H5DS_POWER_BY"===r)return x.a.createElement($,{key:"H5DS_POWER_BY",index:t,slideTo:e.slideTo,swiper:e.swiperInstance,data:a,style:{top:"".concat(u,"px"),transform:"rotateX(0deg) rotateY(0deg) translate3d(0px, 0px, 0px)"}});var l=c(r),p=l.innerStyle,m=l.boxStyle,y=l.className,f=l.noScroll,g=l.adsorbTopBottom,v=l.adsorbLeftRight,b="h5ds-pages-box";return f||(b+=" h5ds-swiper-page-scroll"),y+=h-t==0?" swiper-slide-active":0<h-t?" swiper-slide-prev h5ds-swiper-ban-animate":" swiper-slide-next h5ds-swiper-ban-animate",x.a.createElement("div",{id:r.id,className:y,key:r.keyid,"data-keyid":r.keyid,"data-swiper-slide-index":t,style:{top:"".concat(u,"px"),transform:"rotateX(0deg) rotateY(0deg) translate3d(0px, 0px, 0px)"}},x.a.createElement("div",{className:b,style:m},x.a.createElement("div",{className:"h5ds-swiper-pageinner",style:S()({},p,n)},x.a.createElement(N.c,{adsorbSet:{scale:i,adsorbTopBottom:g,adsorbLeftRight:v},isRenderThis:h===t,plugins:o,appData:a,data:r,renderIn:s}))),f?null:x.a.createElement("div",{className:"h5ds-swiper-swipe-btn"},x.a.createElement("span",{onClick:e.slidePrev},"上一页"),x.a.createElement("span",{onClick:e.slideNext},"下一页")))})),x.a.createElement("div",{className:"swiper-pagination"}))}}]),t}(E.Component),k()(o.prototype,"slideTo",[_.a],Object.getOwnPropertyDescriptor(o.prototype,"slideTo"),o.prototype),k()(o.prototype,"updateSwiper",[_.a],Object.getOwnPropertyDescriptor(o.prototype,"updateSwiper"),o.prototype),k()(o.prototype,"slideChangeTransitionEnd",[_.a],Object.getOwnPropertyDescriptor(o.prototype,"slideChangeTransitionEnd"),o.prototype),k()(o.prototype,"slideNext",[_.a],Object.getOwnPropertyDescriptor(o.prototype,"slideNext"),o.prototype),k()(o.prototype,"slidePrev",[_.a],Object.getOwnPropertyDescriptor(o.prototype,"slidePrev"),o.prototype),k()(o.prototype,"renderExternal",[_.a],Object.getOwnPropertyDescriptor(o.prototype,"renderExternal"),o.prototype),k()(o.prototype,"newSwiper",[_.a],Object.getOwnPropertyDescriptor(o.prototype,"newSwiper"),o.prototype),o),H=function(e){function t(){return u()(this,t),y()(this,g()(t).apply(this,arguments))}return b()(t,e),d()(t,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.transformStyle,n=e.plugins,o=e.renderIn,r=e.scale,s=e.setPageStyle;return x.a.createElement("div",{className:"h5ds-popups",id:"h5dsPopups"},t.popups.map(function(e,i){var c=s(e),l=c.innerStyle,p=c.boxStyle,u=c.adsorbTopBottom,h=c.adsorbLeftRight,d="h5ds-swiper-page";return e.className&&(d+=" ".concat(e.className)),x.a.createElement("div",{id:e.id,className:d,key:e.keyid,"data-keyid":e.keyid,style:{transform:"rotateX(0deg) rotateY(0deg) translate3d(0px, 0px, 0px)",width:window.innerWidth,height:window.innerHeight}},x.a.createElement("div",{className:"h5ds-pages-box",style:p},x.a.createElement("div",{style:S()({},l,a),className:"h5ds-swiper-pageinner"},x.a.createElement(N.d,{plugins:n,data:e,appData:t,renderIn:o,adsorbSet:{scale:r,adsorbTopBottom:u,adsorbLeftRight:h}}))))}))}}]),t}(E.Component),R=(i=s=function(e){function t(e){var a;return u()(this,t),(a=y()(this,g()(t).call(this,e))).state={scale:e.scale},a.data=JSON.parse(JSON.stringify(e.data)),a}return b()(t,e),d()(t,[{key:"setPageStyle",value:function(e){var t=this.props.style,a=e.style.height*this.state.scale,n=e.style.width*this.state.scale,o=0,r=!0,s=!1;t.height>=a?o=(t.height-a)/2:s=!(r=!1),e.slider&&e.slider.lock&&(s=!0);var i=e.style,c=i.backgroundColor,l=i.width,p=i.height,u={backgroundColor:c},h=Object.assign({},{width:l,height:p},{top:o}),d="h5ds-swiper-page swiper-slide";return s&&(d+=" h5ds-swiper-page-noswiper"),e.className&&(d+=" ".concat(e.className)),{className:d,boxStyle:u,innerStyle:h,noSwiper:s,noScroll:r,adsorbTopBottom:o,adsorbLeftRight:(t.width-n)/2}}},{key:"updateSwiper",value:function(){this.swiperRef&&this.swiperRef.updateSwiper()}},{key:"slideNext",value:function(){this.swiperRef&&this.swiperRef.slideNext()}},{key:"slidePrev",value:function(){this.swiperRef&&this.swiperRef.slidePrev()}},{key:"slideTo",value:function(e,t){var a=1<arguments.length&&void 0!==t?t:0;this.swiperRef&&this.swiperRef.slideTo(e,a)}},{key:"componentDidMount",value:function(){var e=this;this.swiperInstance=this.swiperRef.swiperInstance,P.a.subscribe("h5ds.layerEvent.topage",function(t,a){e.slideTo(a.value,500)})}},{key:"componentWillUnmount",value:function(){P.a.unsubscribe("h5ds.layerEvent.topage")}},{key:"render",value:function(){var e=this,t=this.data,a=this.state.scale,n=this.props,o=n.renderIn,r=n.style,s=n.plugins,i={transform:"scale(".concat(a,")"),transformOrigin:"0 0"},c=this.setPageStyle;return x.a.createElement("div",{className:"h5ds-preview h5ds-preview-".concat(t.type),style:{width:r.width,height:r.height}},x.a.createElement(x.a.Fragment,null,x.a.createElement(W,l()({ref:function(t){return e.swiperRef=t}},{data:t,transformStyle:i,renderIn:o,plugins:s,style:r,scale:a,setPageStyle:c})),x.a.createElement(L,{data:t,transformStyle:i,renderIn:o,plugins:s,style:r,scale:a,setPageStyle:c}),x.a.createElement(H,{data:t,transformStyle:i,renderIn:o,plugins:s,style:r,scale:a,setPageStyle:c})))}}]),t}(E.Component),s.defaultProps={style:{width:window.innerWidth,height:window.innerHeight},scale:1},r=i,k()(r.prototype,"setPageStyle",[_.a],Object.getOwnPropertyDescriptor(r.prototype,"setPageStyle"),r.prototype),k()(r.prototype,"updateSwiper",[_.a],Object.getOwnPropertyDescriptor(r.prototype,"updateSwiper"),r.prototype),k()(r.prototype,"slideNext",[_.a],Object.getOwnPropertyDescriptor(r.prototype,"slideNext"),r.prototype),k()(r.prototype,"slidePrev",[_.a],Object.getOwnPropertyDescriptor(r.prototype,"slidePrev"),r.prototype),k()(r.prototype,"slideTo",[_.a],Object.getOwnPropertyDescriptor(r.prototype,"slideTo"),r.prototype),r);t.a=R},function(e,t,a){"use strict";var n=a(3),o=a.n(n),r=a(4),s=a.n(r),i=a(5),c=a.n(i),l=a(6),p=a.n(l),u=a(7),h=a.n(u),d=(a(73),a(0)),m=a.n(d),y=function(e){function t(){var e,a;o()(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=c()(this,(e=p()(t)).call.apply(e,[this].concat(r)))).getSpanStyle=function(e){var t=[],a={background:"background",backgroundClip:"-webkit-background-clip",color:"color",textFillColor:"-webkit-text-fill-color",textStroke:"text-stroke",opacity:"opacity",textShadow:"text-shadow",backgroundImage:"background-image",top:"top",left:"left",zIndex:"z-index"};for(var n in e)a[n]&&t.push("".concat(a[n],": ").concat(e[n]));return t.join(";")},a.getStyle=function(e,t,a){var n={},o={},r=null;switch(e){case"border":n.color=t[0],n.textFillColor="".concat(a,"px ").concat(t[0]),n.WebkitTextFillColor="".concat(a,"px ").concat(t[0]),o.textStroke="".concat(a,"px ").concat(t[1]),o.WebkitTextStroke="".concat(a,"px ").concat(t[1]);break;case"3d":n.color=t[0],n.textFillColor="".concat(a,"px ").concat(t[0]),n.WebkitTextFillColor="".concat(a,"px ").concat(t[0]),o.color=t[0],o.textShadow=new Array(a).fill(1).map(function(e,n){return n+1<a?"0px ".concat(n+1,"px 0px ").concat(t[1]):"0px ".concat(a,"px ").concat(a,"px ").concat(t[1])}).join(",");break;case"kaTong":n.color=t[0],n.background="url(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAIAAAAmkwkpAAAAHklEQVQImWNkYGBgYGD4//8/A5wF5SBYyAr+//8PAPOCFO0Q2zq7AAAAAElFTkSuQmCC) repeat",n.textShadow="".concat(a/2,"px -").concat(a/2,"px ").concat(t[0],", ").concat(a/2,"px -").concat(a/2,"px white"),n.textFillColor="transparent",n.WebkitTextFillColor="transparent",n.backgroundClip="text",n.WebkitBackgroundClip="text",o.opacity=0;break;case"jiaXin":n.color=t[0],n.textFillColor="".concat(a,"px ").concat(t[0]),n.WebkitTextFillColor="".concat(a,"px ").concat(t[0]),o.textStroke="".concat(a,"px ").concat(t[1]),o.WebkitTextStroke="".concat(a,"px ").concat(t[1]),r={zIndex:99,textStroke:"".concat(a+a/2,"px ").concat(t[0]),WebkitTextStroke:"".concat(a+a/2,"px ").concat(t[0])};break;case"yinYing":n.color=t[0],n.textShadow="0px ".concat(a/2,"px ").concat(a/2,"px ").concat(t[1]),o.opacity=0;break;case"niHong":n.textStroke="1px ".concat(t[0]),n.WebkitTextStroke="1px ".concat(t[0]),n.color="transparent",o.color="transparent",o.textShadow="0px 0px ".concat(a,"px ").concat(t[0]);break;case"cuoJue":n.left=0,n.backgroundClip="text",n.WebkitBackgroundClip="text",n.textFillColor="transparent",n.WebkitTextFillColor="transparent",n.backgroundImage="linear-gradient(0deg, ".concat(t[1]," 50%, rgba(255, 255, 255, 0) 50%)"),o.left=-2,o.backgroundClip="text",o.WebkitBackgroundClip="text",o.textFillColor="transparent",o.WebkitTextFillColor="transparent",o.backgroundImage="linear-gradient(0deg, ".concat(t[2]," 100%, rgba(255, 255, 255, 0) 50%)"),r={zIndex:201,left:2,color:t[0]};break;case"jianBian":n.left=0,n.backgroundClip="text",n.WebkitBackgroundClip="text",n.textFillColor="transparent",n.WebkitTextFillColor="transparent",n.backgroundImage="linear-gradient(0deg, ".concat(t[0],", ").concat(t[1],", ").concat(t[2],")"),o.opacity=0;break;case"qieGe":n.backgroundClip="text",n.WebkitBackgroundClip="text",n.textFillColor="transparent",n.WebkitTextFillColor="transparent",n.backgroundImage="linear-gradient(0deg, ".concat(t[0]," 50%, rgba(255, 255, 255, 0) 50%)"),o.backgroundClip="text",o.WebkitBackgroundClip="text",o.textFillColor="transparent",o.WebkitTextFillColor="transparent",o.backgroundImage="linear-gradient(0deg, ".concat(t[1]," 100%, rgba(255, 255, 255, 0) 50%)");break;case"fire":n.color=t[0],o.opacity=0;break;case"snow":n.textFillColor=t[0],n.textFillColor=t[0],n.WebkitTextFillColor=t[0],o.color="#fff",o.textShadow="".concat(t[1]," 0px ").concat(a/2,"px ").concat(a/2,"px"),o.textStroke="".concat(a/2,"px ").concat(t[1]),o.WebkitTextStroke="".concat(a/2,"px ").concat(t[1]),r={zIndex:201,background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAeCAYAAAARgF8NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDOEJGMEM5MDMwRUYxMUU5OUU1QkJFMjJGQjU2M0JBMyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDOEJGMEM5MTMwRUYxMUU5OUU1QkJFMjJGQjU2M0JBMyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkM4QkYwQzhFMzBFRjExRTk5RTVCQkUyMkZCNTYzQkEzIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkM4QkYwQzhGMzBFRjExRTk5RTVCQkUyMkZCNTYzQkEzIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+PM6S9AAAAFlJREFUeNpi/P///1cGBgYuIP4FxGwMEABjf2MEKvjPgAcwMRAAowqGm4JveOTBCQbEwJVoGCl3AwtSImVAS7QQO9DSLIzDSLIVDOg6aRfU/9EDjXJHAgQYAOqPGQ3i3HYXAAAAAElFTkSuQmCC) repeat-x",textFillColor:"transparent",WebkitTextFillColor:"transparent",backgroundClip:"text",WebkitBackgroundClip:"text"};break;case"louKong":n.top=-a/2,n.left=a/2,n.textStroke="1px ".concat(t[1]),n.WebkitTextStroke="1px ".concat(t[1]),n.textFillColor="transparent",n.WebkitTextFillColor="transparent",o.color=t[0]}return{upStyle:n,downStyle:o,otherStyle:r}},a}return h()(t,e),s()(t,[{key:"render",value:function(){var e=this.props,t=e.type,a=e.size,n=void 0===a?10:a,o=e.colors,r=void 0===o?["#000"]:o,s=e.style,i=void 0===s?{}:s,c=e.shtml,l=["h5ds-artword","h5ds-artword-"+t],p=this.getStyle(t,r,n),u=p.upStyle,h=p.downStyle,d=p.otherStyle;return t?c?m.a.createElement("div",{style:i,className:l.join(" ")},m.a.createElement("div",{style:u,className:"h5ds-artword-up",dangerouslySetInnerHTML:{__html:c}}),m.a.createElement("div",{style:h,className:"h5ds-artword-down",dangerouslySetInnerHTML:{__html:c}}),d?m.a.createElement("div",{style:d,className:"h5ds-artword-up",dangerouslySetInnerHTML:{__html:c}}):null):m.a.createElement("div",{style:i,className:l.join(" ")},m.a.createElement("div",{style:u,className:"h5ds-artword-up"},this.props.children),m.a.createElement("div",{style:h,className:"h5ds-artword-down"},this.props.children),d?m.a.createElement("div",{style:d,className:"h5ds-artword-up"},this.props.children):null):m.a.createElement("div",{style:i,className:l.join(" "),dangerouslySetInnerHTML:{__html:c}})}}]),t}(d.PureComponent);t.a=y},function(e,t){e.exports=require("rc-hammerjs")},function(e,t){e.exports=require("antd/es/tabs/style")},function(e,t){e.exports=require("antd/es/popover")},function(e,t){e.exports=require("antd/es/icon/style")},function(e,t){e.exports=require("lodash/cloneDeep")},function(e,t){e.exports=require("dayjs")},function(e,t){e.exports=require("lodash/debounce")},function(e,t){e.exports=require("lodash/isObject")},function(e,t){e.exports=require("lodash/throttle")},function(e,t){e.exports=require("lodash/uniq")},function(e,t){e.exports=require("@babel/runtime/helpers/typeof")},function(e,t){e.exports=require("antd/es/radio/style")},function(e,t){e.exports=require("antd/es/input/style")},function(e,t){e.exports=require("react-dom")},function(e,t){e.exports=require("antd/es/popconfirm")},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t){e.exports=require("antd/es/popover/style")},function(e,t){e.exports=require("antd/es/select/style")},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t){e.exports=require("antd/es/collapse")},function(e,t){e.exports=require("antd/lib/radio")},function(e,t,a){},function(e,t){e.exports=require("antd/es/popconfirm/style")},function(e,t){e.exports=require("@babel/runtime/helpers/initializerWarningHelper")},function(e,t){e.exports=require("react-color")},function(e,t){e.exports=require("react-dom/server")},function(e,t){e.exports=require("antd/es/spin")},function(e,t){e.exports=require("antd/lib/input-number")},function(e,t){e.exports=require("antd/lib/slider")},function(e,t){e.exports=require("antd/es/alert")},function(e,t){e.exports=require("qrcode.react")},function(e,t){e.exports=require("dom-to-image")},function(e,t){e.exports=require("antd/es/progress")},function(e,t){e.exports=require("@babel/runtime/helpers/construct")},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t){$.contextMenu=function(e){var t=$.extend({x:0,y:0,vals:[],callback:null},e);if(!$(".h5ds-contextmenu")[0]){var a='<div class="h5ds-contextmenu" style="left: '.concat(t.x,"px; top: ").concat(t.y,'px;">\n          <ul>\n              ').concat(t.vals.map(function(e){return'<li class="h5ds-contextmenu-item" data-val="'.concat(e.val,'">').concat(e.name,"</li>")}).join(""),"\n          </ul>\n      </div>");$("body").append(a)}var n=$(".h5ds-contextmenu"),o={height:n.height(),width:n.width(),win_width:$(window).width(),win_height:$(window).height(),new_x:t.x,new_y:t.y};t.x+o.width>o.win_width&&(o.new_x=o.win_width-o.width-20),t.y+o.height>o.win_height&&(o.new_y=o.win_height-o.height-50),n.css({left:o.new_x,top:o.new_y}),$(document).off("click.contextmenu").on("click.contextmenu",function(e){var a=$(e.target).closest(".h5ds-contextmenu-item");a[0]&&t.callback&&t.callback(a.attr("data-val"),a),$(".h5ds-contextmenu").remove()})}},function(e,t){$(document).on("mousedown.uniqlist",".h5ds-uniqlist",function(e){e.stopPropagation();var t=e.pageX,a=e.pageY,n=$(this);if(n.trigger("uniqstart"),"h5ds-uniqlist"!==e.target.className&&!$(e.target).closest(".h5ds-uniq-clone")[0]){var o=$(e.target).closest("li");if(o[0]){var r=parseInt(o.position().left,10),s=parseInt(o.position().top,10),i=o.height(),c=o.index(),l=null,p=function(){o.addClass("h5ds-uniq-start").siblings("li").removeClass("h5ds-uniq-start"),(l=$(o.clone())).addClass("h5ds-uniq-clone").css({left:r,top:s,width:o.width(),height:o.height(),position:"absolute"}),n.append(l.prop("outerHTML")),l=$(".h5ds-uniq-clone")},u=i+(parseInt(o.css("margin-top"),10)+parseInt(o.css("margin-bottom"),10)),h=parseInt(o.css("top"),10),d=n.scrollTop();h="auto"!=h?h:0;var m=!0,y=!1;$(document).on("mousemove.uniqlist",function(e){var n=h+(e.pageY-a);3<Math.abs(n)&&(m=!1,y||(y=!0,p(),p=null),l.css({left:r+(e.pageX-t),top:s+(e.pageY-a)+d}),0<n&&u<n?o.next()[0]&&(h-=u,o.before(o.next())):n<0&&u<-n&&o.prev()[0]&&(h+=u,o.after(o.prev())))}).on("mouseup.uniqlist",function(){var e=parseInt(o.position().left,10),t=parseInt(o.position().top,10)+d;m?(o.removeClass("h5ds-uniq-start"),o=n=null):l.animate({left:e,top:t},500,function(){l.remove(),o.removeClass("h5ds-uniq-start");var e=o.index();0<=e&&c!=e&&n.trigger("uniqend",{from:c,to:e}),o=n=l=null}),$(document).off("mousemove.uniqlist"),$(document).off("mouseup.uniqlist")})}}})},function(e,t){$.helps=function(e){var t=$.extend({data:[]},e);function a(e){0===e?($(".h5ds-helps-prev").hide(),$(".h5ds-helps-next").show(),$(".h5ds-helps-end").hide()):(e===t.data.length-1?($(".h5ds-helps-next").hide(),$(".h5ds-helps-end").show()):($(".h5ds-helps-end").hide(),$(".h5ds-helps-next").show()),$(".h5ds-helps-prev").show());var a=t.data[e],r=$(a.dom),s={transfrom:r.css("transfrom"),width:r.outerWidth(),height:r.outerHeight(),left:r.offset().left,top:r.offset().top};console.log("size ->",s),n.css(s),o.removeClass().addClass("h5ds-helps-content h5ds-helps-"+a.pos),n.find(".h5ds-helps-info").html(a?a.content:"")}$(".h5ds-helps")[0]||$("body").append('\n      <div class="h5ds-helps">\n          <div class="h5ds-helps-content">\n              <a class="h5ds-helps-close"><i class="h5ds-ico h5ds-ico-close"></i></a>\n              <div class="h5ds-helps-info"></div>\n              <div class="h5ds-helps-btns">\n                  <a class="h5ds-helps-prev">上一步</a>\n                  <a class="h5ds-helps-next">下一步</a>\n                  <a class="h5ds-helps-end">完成</a>\n              </div>\n          </div>\n      </div>\n      ');var n=$(".h5ds-helps"),o=n.find(".h5ds-helps-content"),r=0;a(r),1===t.data.length&&($(".h5ds-helps-next").hide(),$(".h5ds-helps-end").show()),n.on("click",".h5ds-helps-next",function(){++r<t.data.length&&a(r)}),n.on("click",".h5ds-helps-prev",function(){0<=--r&&a(r)}),n.on("click",".h5ds-helps-close, .h5ds-helps-end",function(){n.off("click"),n.remove()})}},function(e,t){e.exports=require("antd/es/collapse/style")},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t){e.exports=require("antd/es/spin/style")},function(e,t,a){},function(e,t){e.exports=require("antd/lib/input-number/style")},function(e,t){e.exports=require("antd/lib/slider/style")},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t){e.exports=require("antd/lib/radio/style")},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t){e.exports=require("antd/es/alert/style")},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t){e.exports=require("antd/es/progress/style")},function(e,t,a){},function(e,t,a){},,function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"Editor",function(){return V}),a.d(n,"LayerJSON",function(){return J}),a.d(n,"LayerComp",function(){return X.LayerComp}),a.d(n,"config",function(){return X.config});var o={};a.r(o),a.d(o,"Editor",function(){return re}),a.d(o,"LayerJSON",function(){return se}),a.d(o,"LayerComp",function(){return me.LayerComp}),a.d(o,"Modal",function(){return we}),a.d(o,"icon",function(){return ie}),a.d(o,"selectIcon",function(){return ce}),a.d(o,"config",function(){return me.config});var r={};a.r(r),a.d(r,"Editor",function(){return je}),a.d(r,"LayerJSON",function(){return Le}),a.d(r,"LayerComp",function(){return $e.LayerComp}),a.d(r,"config",function(){return $e.config}),a.d(r,"icon",function(){return Ie}),a.d(r,"selectIcon",function(){return Ae}),a.d(r,"Modal",function(){return Me});var s={};a.r(s),a.d(s,"Editor",function(){return Ge}),a.d(s,"Modal",function(){return lt}),a.d(s,"LayerJSON",function(){return qe}),a.d(s,"LayerComp",function(){return ct.LayerComp}),a.d(s,"config",function(){return ct.config}),a.d(s,"icon",function(){return Ue}),a.d(s,"selectIcon",function(){return Ye});var i={};a.r(i),a.d(i,"Editor",function(){return jt}),a.d(i,"LayerJSON",function(){return Lt}),a.d(i,"LayerComp",function(){return At.LayerComp}),a.d(i,"icon",function(){return It}),a.d(i,"config",function(){return At.config});var c={};a.r(c),a.d(c,"img",function(){return o}),a.d(c,"text",function(){return i}),a.d(c,"sound",function(){return s}),a.d(c,"combin",function(){return n}),a.d(c,"shape",function(){return r});var l=a(3),p=a.n(l),u=a(4),h=a.n(u),d=a(5),m=a.n(d),y=a(6),f=a.n(y),g=a(7),v=a.n(g),b=(a(92),a(93),a(94),a(95),a(96),a(97),a(98),a(18)),w=a.n(b),k=a(10),E=a.n(k),x=a(38),O=a(16),S=a(12),C=Object(x.a)();$.fn.control=function(e){var t=$(this),a=$.extend({setHeight:!0,setWidth:!0,movex:!0,movey:!0,autosize:!0,fixedsize:!0,scale:1,rotate:!0},e);a.scale=$(".h5ds-js-canvas").transform("scale")||1;var n='<div class="h5ds-control">\n\t\t\t\t\t{{rotate}}\n\t\t\t\t\t{{autosize}}\n\t\t\t\t\t{{fixedsize}}\n\t\t\t\t\t<span class="h5ds-control-center"></span>\n\t\t\t\t</div>';n=a.rotate?n.replace("{{rotate}}",'<span class="h5ds-control-rotate"></span>'):n.replace("{{rotate}}",""),n=a.autosize?n.replace("{{autosize}}","".concat(a.setHeight?'<span class="h5ds-control-top" />':"","\n\t\t\t\t\t").concat(a.setWidth?'<span class="h5ds-control-left"></span>':"","\n\t\t\t\t\t").concat(a.setWidth?'<span class="h5ds-control-right"></span>':"","\n\t\t\t\t\t").concat(a.setHeight?'<span class="h5ds-control-bottom"></span>':"")):n.replace("{{autosize}}",""),n=a.fixedsize?n.replace("{{fixedsize}}",'<span class="h5ds-control-topleft"></span>\n\t\t\t\t\t<span class="h5ds-control-topright"></span>\n\t\t\t\t\t<span class="h5ds-control-bottomleft"></span>\n\t\t\t\t\t<span class="h5ds-control-bottomright"></span>'):n.replace("{{fixedsize}}","");var o=t.find(".h5ds-control");function r(e,n,o){var r={x:e.pageX,y:e.pageY},s=$(n).parent(),i={width:s[0].offsetWidth,height:s[0].offsetHeight,left:s[0].offsetLeft,top:s[0].offsetTop,offsetLeft:s.offset().left,offsetTop:s.offset().top};function c(e,t,a){var n=2<arguments.length&&void 0!==a?a:1,o=w()(e,2),r=o[0],s=o[1],i=w()(t,2),c=r-i[0],l=s-i[1];return Math.sqrt(c*c+l*l)*n}t.trigger("controlStart",E()({},i));var l=c([i.offsetLeft,i.offsetTop],[i.width+i.offsetLeft,i.height+i.offsetTop],a.scale),p=c([i.offsetLeft,i.offsetTop],[i.width+i.offsetLeft,i.height+i.offsetTop]);console.log("diagonalValue",l),$(document).on("".concat(C.move,".control_resize"),function(e){C.touch&&(e=C.touchEvent(e));var n=e.pageX-r.x,u=e.pageY-r.y,h=i.height,d=i.width,m=i.top,y=i.left,f=i.offsetLeft,g=i.offsetTop,v=d,b=h,w=m,k=y,E=0;switch(o){case"top":E=c([e.pageX,e.pageY],[r.x,r.y]),0<u&&(E=-E),b=h+(E/=a.scale),w=m-E;break;case"left":E=c([e.pageX,e.pageY],[r.x,r.y]),0<n&&(E=-E),v=d+(E/=a.scale),k=y-E;break;case"right":E=c([e.pageX,e.pageY],[r.x,r.y]),n<0&&(E=-E),v=d+(E/=a.scale);break;case"bottom":E=c([e.pageX,e.pageY],[r.x,r.y]),u<0&&(E=-E),b=h+(E/=a.scale);break;case"topleft":E=c([e.pageX,e.pageY],[d+f,h+g],a.scale),E-=l,E/=a.scale,h<d?(k=y-E,w=m-((b=(v=d+E)/d*h)-h)):(w=m-E,k=y-((v=(b=h+E)/h*d)-d));break;case"bottomleft":E=c([e.pageX,e.pageY],[d+f,g]),E-=p,E/=a.scale,k=h<d?(b=(v=d+E)/d*h,y-E):y-((v=(b=h+E)/h*d)-d);break;case"topright":E=c([e.pageX,e.pageY],[f,h+g]),E-=l,E/=a.scale,w=h<d?m-((b=(v=d+E)/d*h)-h):(v=(b=h+E)/h*d,m-E);break;case"bottomright":E=c([e.pageX,e.pageY],[f,g]),E-=l,E/=a.scale,h<d?b=(v=d+E)/d*h:v=(b=h+E)/h*d}v<0||b<0||(s.css({width:v,height:b,top:w,left:k}),t.trigger("controlResizeTick",{width:v,height:b,top:w,left:k}))}).on("".concat(C.end,".control_resize"),function(){$(document).off("".concat(C.move,".control_resize ").concat(C.end,".control_resize"));var e=s[0],a=e.offsetWidth,n=e.offsetHeight,o=e.offsetLeft,r=e.offsetTop,i={height:parseInt(n,10),width:parseInt(a,10),top:parseInt(r,10),left:parseInt(o,10)};t.trigger("controlEnd",E()({},i)),t.trigger("change",E()({},i))})}return o[0]&&(o.remove(),o=null),t.append(n),this.distory=function(){$(".h5ds-control").remove()},$(document).off("".concat(C.start,".control")).on("".concat(C.start,".control"),".h5ds-control",function(e){switch(e.stopPropagation(),C.touch?e=C.touchEvent(e):e.preventDefault(),a.scale=parseFloat($(".h5ds-canvas-box").transform("scale"))||1,e.target.className){case"h5ds-control":!function(e,n){var o,r,s=e.pageX,i=e.pageY,c=$(n).parent(),l=a.scale,p=(c.width(),c.height(),parseInt(c.css("left"),10)*l),u=parseInt(c.css("top"),10)*l,h=null,d=$(".h5ds-js-grid");d[0]&&(o="true"===d.attr("data-adsorb"),r=parseInt(d.attr("data-size"),10)),O.a.publish("h5ds.control.absorb.start"),$(document).on("".concat(C.move,".control_move"),function(e){e.stopPropagation(),C.touch&&(e=C.touchEvent(e)),h={left:parseInt((p+(e.pageX-s))/l,10),top:parseInt((u+(e.pageY-i))/l,10)},a.movex||delete h.left,a.movey||delete h.top,o&&r?(h.left&&(h.left=Math.round(h.left/r,10)*r),h.top&&(h.top=Math.round(h.top/r,10)*r),c.css(h)):(c.css(h),O.a.publish("h5ds.control.absorb.move"))}).on("".concat(C.end,".control_move"),function(e){C.touch&&(e=C.touchEvent(e)),c=$(n).parent(),h={left:parseFloat(c.css("left")),top:parseFloat(c.css("top"))},$(document).off("".concat(C.move,".control_move ").concat(C.end,".control_move")),t.trigger("change",h),O.a.publish("h5ds.control.absorb.end",h),h=null})}(e,this);break;case"h5ds-control-rotate":!function(e,a){var n=$(a).find(".h5ds-control-center"),o=$(a).parent(),r=parseInt(n.offset().left,10),s=parseInt(n.offset().top,10),i=180/Math.PI,c=null;$(document).on("".concat(C.move,".control_rotate"),function(e){C.touch&&(e=e.originalEvent.targetTouches[0]);var t=e.pageX-r,a=s-e.pageY;c=Math.atan(t/a),c*=i,c=parseInt(c,10),0<=t&&0<=a||(0<=t&&a<0?c=180-(c=Math.abs(c)):c+=t<0&&0<=a?360:180),o.transform({rotate:"".concat(S.a.toFixed(c,1),"deg")})}).on("".concat(C.end,".control_rotate"),function(e){e.stopPropagation(),$(document).off("".concat(C.move,".control_rotate ").concat(C.end,".control_rotate")),t.trigger("change",{value:S.a.toFixed(c,1),rotate:S.a.toFixed(c,1)+"deg",transform:"rotate(".concat(S.a.toFixed(c,1),"deg)")}),c=null})}(0,this);break;case"h5ds-control-top":r(e,this,"top");break;case"h5ds-control-topleft":r(e,this,"topleft");break;case"h5ds-control-topright":r(e,this,"topright");break;case"h5ds-control-bottom":r(e,this,"bottom");break;case"h5ds-control-bottomleft":r(e,this,"bottomleft");break;case"h5ds-control-bottomright":r(e,this,"bottomright");break;case"h5ds-control-left":r(e,this,"left");break;case"h5ds-control-right":r(e,this,"right")}}),this};var D=Object(x.a)();$(document).on("".concat(D.start,".drag"),".h5ds-drag",function(e){D.touch&&(e=D.touchEvent(e));var t=e.pageX,a=e.pageY,n=$(this),o=n.offset().left,r=n.offset().top,s={limit:!0,undrag:[]},i=n.attr("data-dragset");if(i=i?JSON.parse(i):{},0!=(s=$.extend(s,i)).undrag.length)for(var c=0;c<s.undrag.length;c++)if($(e.target).closest(s.undrag[c])[0])return;if(s.limit)var l=n.width(),p=n.height(),u=n.parent().offset().left,h=n.parent().offset().top,d=n.parent().width(),m=n.parent().height();$(document).on("".concat(D.move,".drag"),function(e){D.touch&&(e=D.touchEvent(e));var i=o+(e.pageX-t),c=r+(e.pageY-a);s.limit&&(i<u?i=u:d-l<i&&(i=d-l),c<h?c=h:m-p<c&&(c=m-p)),n.css({left:i,top:c})}).on("".concat(D.end,".drag"),function(){$(document).off("".concat(D.move,".drag ").concat(D.end,".drag"))})}),a(99),a(100);var N=a(40);$.fn.transform=function(e){var t=N.a.convertMatrixToArray(this);if("string"==typeof e)return(N.a.getTransform(t)||{})[e];var a=N.a.setTransform(this,e);$(this).css({transform:"translate(".concat(a.x,"px, ").concat(a.y,"px) scale(").concat(a.scale,") rotate(").concat(a.rotate,"deg)")})};var P,j,L,I,A=a(24),T=a.n(A),z=a(11),_=a.n(z),W=a(2),H=a.n(W),R=(a(101),a(77)),M=a.n(R),B=a(22),F=a.n(B),G=(a(102),a(0)),q=a.n(G),U=a(1),Y=a(8),V=(P=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={layer:Object(Y.toJS)(e.layer)},a.eventId=U.i.randomID(),a}return v()(t,e),h()(t,[{key:"getEditor",value:function(e){return this.props.scope.pluginsKey[e.pid]}},{key:"render",value:function(){var e=this,t=this.props,a=t.layer,n=F()(t,["layer"]),o=M.a.Panel;return q.a.createElement("div",{className:"h5ds-ex-h5ds_combin"},q.a.createElement("div",{className:"h5ds-ex-h5ds_combin-set"},q.a.createElement("div",{className:"h5ds-ex-h5ds_combin-titles"},"修改合并图层中的子图层"),q.a.createElement(M.a,{accordion:!0},a.data.map(function(t,a){var r=e.getEditor(t),s=r.Editor,i=r.name;return q.a.createElement(o,{header:i+"图层设置",key:a},q.a.createElement(s,T()({layer:t},n)))}))))}}]),t}(G.Component),H()(P.prototype,"getEditor",[U.c],Object.getOwnPropertyDescriptor(P.prototype,"getEditor"),P.prototype),P),J=function e(){p()(this,e),this.id=null,this.className=null,this.animate=[],this.data=[],this.originstyle={width:0,height:0},this.style={width:0,height:0,top:0,left:0},this.estyle={},this.events=[]},X=a(47),K=(a(28),a(14)),Q=a.n(K),Z=(a(103),a(19)),ee=a.n(Z),te=a(27),ae=a.n(te),ne=(a(104),j=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).set={dashFill:"#f04e00",fill:"#f04e00",bgFill:"rgba(0,0,0, 0.2)",dotSize:10};var n=e.boxWidth,o=e.boxHeight,r=e.width,s=e.height,i=e.top,c=void 0===i?0:i,l=e.left,u=void 0===l?0:l;return a.state={width:r||n,height:s||o,top:c,left:u,boxWidth:n,boxHeight:o},a}return v()(t,e),h()(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.width,a=e.height,n=e.top,o=e.left,r=e.boxWidth,s=e.boxHeight;this.setState({width:t,height:a,top:n,left:o,boxWidth:r,boxHeight:s})}},{key:"cropTick",value:function(){this.props.onCropTick&&this.props.onCropTick(E()({},this.state))}},{key:"cropEnd",value:function(){this.props.onCropEnd&&this.props.onCropEnd(E()({},this.state))}},{key:"mousedownDrag",value:function(e){var t=this,a=e.pageX-this.state.left,n=e.pageY-this.state.top,o=this.state,r=o.width,s=o.height,i=o.boxHeight,c=o.boxWidth;$(document).on("mousemove.h5ds.cropControl.drag",function(e){var o=e.pageX-a,l=e.pageY-n;i<l+s?l=i-s:l<0&&(l=0),c<o+r?o=c-r:o<0&&(o=0),t.setState({top:l,left:o},t.cropTick)}).on("mouseup.h5ds.cropControl.drag",function(){$(document).off("mousemove.h5ds.cropControl.drag"),$(document).off("mouseup.h5ds.cropControl.drag"),t.cropEnd()})}},{key:"mousedownZoom",value:function(e,t){var a=this,n=e.pageX,o=e.pageY,r=this.state,s=r.left,i=r.top,c=r.width,l=r.height,p=r.boxHeight,u=r.boxWidth,h=c,d=l,m=i,y=s;$(document).on("mousemove.h5ds.cropControl.zoom",function(e){var r=e.pageX-n,f=e.pageY-o;"topleft"==t?(h=c-r,y=s+r,m=i+l-(d=l-f)):"topright"==t?(h=c+r,m=i+l-(d=l-f)):"bottomleft"==t?(h=c-r,d=l+f,y=s+r):"bottomright"==t&&(h=c+r,d=l+f),d<0?d=0:p<d&&(d=p),h<0?h=0:u<h&&(h=u),m<0&&(m=0),y<0&&(y=0),a.setState({left:y,top:m,width:h,height:d},a.cropTick)}).on("mouseup.h5ds.cropControl.zoom",function(){$(document).off("mousemove.h5ds.cropControl.zoom"),$(document).off("mouseup.h5ds.cropControl.zoom"),a.cropEnd()})}},{key:"render",value:function(){var e=this,t=this.state,a=t.top,n=t.left,o=t.width,r=t.height,s=t.boxHeight,i=t.boxWidth,c=this.set,l=c.dashFill,p=c.fill,u=c.bgFill,h=c.dotSize,d=[{x:0,y:0,width:h,height:h,type:"topleft"},{x:o,y:0,width:h,height:h,type:"topright"},{x:o,y:r,width:h,height:h,type:"bottomright"},{x:0,y:r,width:h,height:h,type:"bottomleft"}];return q.a.createElement("div",{className:"h5ds-recrop-control",style:{width:i,height:s}},q.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,height:s},q.a.createElement("g",{style:{transform:"translate(".concat(n,"px, ").concat(a,"px)")}},q.a.createElement("polygon",{onMouseDown:this.mousedownDrag,style:{fill:u,stroke:l,strokeDasharray:"3,3",strokeWidth:.5},points:"0,0 ".concat(o,",0 ").concat(o,",").concat(r," 0,").concat(r)}),d.map(function(t,a){return q.a.createElement("rect",{key:a,x:t.x,y:t.y,width:t.width,height:t.height,onMouseDown:function(a){return e.mousedownZoom(a,t.type)},style:{transform:"translate(-".concat(t.width/2,"px, -").concat(t.height/2,"px)"),fill:p}})}))))}}]),t}(G.Component),H()(j.prototype,"cropTick",[U.c],Object.getOwnPropertyDescriptor(j.prototype,"cropTick"),j.prototype),H()(j.prototype,"cropEnd",[U.c],Object.getOwnPropertyDescriptor(j.prototype,"cropEnd"),j.prototype),H()(j.prototype,"mousedownDrag",[U.c],Object.getOwnPropertyDescriptor(j.prototype,"mousedownDrag"),j.prototype),H()(j.prototype,"mousedownZoom",[U.c],Object.getOwnPropertyDescriptor(j.prototype,"mousedownZoom"),j.prototype),j),oe=(L=function(e){function t(e){var a;p()(this,t),a=m()(this,f()(t).call(this,e));var n=e.cropSet||{},o=n.width,r=void 0===o?0:o,s=n.height,i=void 0===s?0:s,c=n.top,l=void 0===c?0:c,u=n.left,h=void 0===u?0:u;return a.state={src:e.src,delbtn:void 0===e.delbtn||e.delbtn,width:r,height:i,top:0,left:0,boxWidth:0,boxHeight:0,naturalWidth:0,naturalHeight:0,cropLeft:h,cropTop:l,cropWidth:r,cropHeight:i},a}return v()(t,e),h()(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;e.src&&e.src!==this.props.src&&(console.log("设置了src，props数据更新"),this.setState({src:e.src},function(){U.i.imgLazy(e.src).then(function(){var a=ae()(ee.a.mark(function a(n){return ee.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(n)return a.next=3,t.initImage(e.src,{cropLeft:0,cropTop:0,cropWidth:n.naturalWidth,cropHeight:n.naturalHeight});a.next=4;break;case 3:t.onCropOk();case 4:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}())}))}},{key:"_countViewSet",value:function(e){var t=e.cropLeft,a=e.cropTop,n=e.cropWidth,o=e.cropHeight,r=e.naturalHeight,s=e.naturalWidth/(e.boxWidth||1)||1,i=r/(e.boxHeight||1)||1;return{top:a/i,left:t/s,width:n/s,height:o/i}}},{key:"_countCropData",value:function(e){var t=e.top,a=e.left,n=e.width,o=e.height,r=e.boxWidth,s=e.boxHeight,i=e.naturalHeight,c=e.naturalWidth/(r||1),l=i/(s||1),p=t*l,u=a*c,h=n*c,d=o*l;return Object.assign(e,{cropTop:p,cropLeft:u,cropWidth:h,cropHeight:d})}},{key:"initImage",value:function(e,t){var a=this;return new Promise(function(n,o){e?U.i.imgLazy(e).then(function(){var e=t.cropTop,o=t.cropLeft,r=t.cropWidth,s=t.cropHeight,i=$(a.imgRef);if(a.imgRef){t.boxWidth=i.width(),t.boxHeight=i.height(),t.naturalHeight=i[0].naturalHeight,t.naturalWidth=i[0].naturalWidth,e||(t.cropTop=0),o||(t.cropLeft=0),r||(t.cropWidth=t.naturalWidth),s||(t.cropHeight=t.naturalHeight),console.log("当前",t);var c=a._countViewSet(t),l=c.top,p=c.left,u=c.width,h=c.height;a.setState(E()({top:l,left:p,width:u,height:h},t),n)}else n()}):(console.error("src 参数为null"),o())})}},{key:"onCropBase64",value:function(){var e=this,t=this.state,a=t.src,n=t.cropLeft,o=t.cropTop,r=t.cropWidth,s=t.cropHeight;if(a)return U.i.getBase64(a,{width:r,height:s,x:n,y:o}).then(function(t){e.props.onCropBase64&&e.props.onCropBase64(E()({base64:t},e.state))});this.props.onCropBase64&&this.props.onCropBase64(E()({base64:""},this.state))}},{key:"onCropEnd",value:function(e){var t=0<arguments.length&&void 0!==e?e:{},a=this._countCropData(Object.assign(this.state,t));this.props.onCropEnd&&this.props.onCropEnd(a)}},{key:"onCropTick",value:function(e){this.props.onCropTick&&this.props.onCropTick(e)}},{key:"onCropOk",value:function(){var e=this.state,t=e.top,a=e.left,n=e.naturalWidth,o=e.naturalHeight,r=e.cropTop,s=e.cropLeft,i=e.cropHeight,c=e.cropWidth;this.props.onCropOk&&this.props.onCropOk(E()({},this.state)),t===r&&a===s&&n===c&&o===i||this.props.onCropBase64&&this.onCropBase64()}},{key:"delImage",value:function(){var e=this;this.setState({src:""},function(){e.props.onCropOk&&e.props.onCropOk(),e.props.onCropBase64&&e.onCropBase64()})}},{key:"componentDidMount",value:function(){var e=this.props.cropSet||{},t=e.left,a=e.top,n=e.width,o=e.height;this.props.src&&this.initImage(this.props.src,{cropLeft:t,cropTop:a,cropWidth:n,cropHeight:o})}},{key:"render",value:function(){var e=this,t=this.state,a=t.src,n=t.width,o=t.height,r=t.boxWidth,s=t.boxHeight,i=t.top,c=t.left,l=t.delbtn;return a?q.a.createElement("div",{className:"h5ds-util-cropimage"},q.a.createElement("div",{className:"h5ds-util-cropimage-imgbox"},q.a.createElement(ne,T()({onCropEnd:this.onCropEnd},{width:n,height:o,top:i,left:c,boxWidth:r,boxHeight:s})),q.a.createElement("img",{ref:function(t){return e.imgRef=t},src:a,alt:"",style:{clipPath:"none"}})),q.a.createElement("div",{className:"h5ds-util-cropimage-btns"},q.a.createElement("a",{onClick:this.props.onChangeImage},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-icoreset"})," 换图"),l?q.a.createElement("a",{onClick:this.delImage},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-icodel"})," 删除"):null,q.a.createElement("a",{onClick:this.onCropOk},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-icocrop"})," 裁剪"))):q.a.createElement("div",{className:"h5ds-util-cropimage-nullimg",onClick:this.props.onClickNullImage},"选择图片")}}]),t}(G.Component),H()(L.prototype,"initImage",[U.c],Object.getOwnPropertyDescriptor(L.prototype,"initImage"),L.prototype),H()(L.prototype,"onCropBase64",[U.c],Object.getOwnPropertyDescriptor(L.prototype,"onCropBase64"),L.prototype),H()(L.prototype,"onCropEnd",[U.c],Object.getOwnPropertyDescriptor(L.prototype,"onCropEnd"),L.prototype),H()(L.prototype,"onCropTick",[U.c],Object.getOwnPropertyDescriptor(L.prototype,"onCropTick"),L.prototype),H()(L.prototype,"onCropOk",[U.c],Object.getOwnPropertyDescriptor(L.prototype,"onCropOk"),L.prototype),H()(L.prototype,"delImage",[U.c],Object.getOwnPropertyDescriptor(L.prototype,"delImage"),L.prototype),L),re=(I=function(e){function t(e){var a;p()(this,t),a=m()(this,f()(t).call(this,e));var n=e.layer,o={};return n.data.crop&&(o=JSON.parse(n.data.crop)),a.state={src:n.data.src,crop:o,cropKey:U.i.randomID()},a.eventId=U.i.randomID(),a}return v()(t,e),h()(t,[{key:"renderLayer",value:function(e){var t=this,a=this.props,n=a.h5ds,o=a.layer;e?U.i.imgLazy(e).then(function(a){Object(Y.transaction)(function(){var r=JSON.stringify({top:0,left:0,width:a.naturalWidth,height:a.naturalWidth,naturalWidth:a.naturalWidth,naturalHeight:a.naturalWidth});o.data.src=e,o.data.crop=r,n.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory"),t.setState({src:e,crop:r,cropKey:U.i.randomID()})}),setTimeout(function(){$("#h5dsLayerList").find(".h5ds-layerlist-active").trigger("click")})}):Object(Y.transaction)(function(){o.data.crop=JSON.stringify(t.state.crop),n.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})}},{key:"changeImage",value:function(){U.e.publish("h5ds.img.modal.show",{callback:this.renderLayer})}},{key:"scaleEvent",value:function(){var e=this,t=this.props.h5ds;this.$layer=t.getLayerDom(),this.$layer.on("controlStart.h5ds.img",function(){e.layerBox=e.$layer.find(".layer-h5ds_img-inner")}),this.$layer.on("controlResizeTick.h5ds.img",function(t,a){var n=e.state.crop,o=n.width,r=void 0===o?1:o,s=n.height,i=void 0===s?1:s;e.layerBox.css({transform:"scale(".concat(a.width/r,", ").concat(a.height/i,")")})})}},{key:"cropCallback",value:function(e){if(e){var t=e.cropLeft,a=e.cropTop,n=e.cropWidth,o=e.cropHeight,r=e.naturalWidth,s=e.naturalHeight;this.setState({crop:{left:t,top:a,width:n,height:o,naturalWidth:r,naturalHeight:s}},this.renderLayer)}else U.e.publish("h5ds.shortcuts_dellayer")}},{key:"componentDidMount",value:function(){var e=this;this.scaleEvent(),$("#h5dsCanvas").on("dblclick.imgeditor",".h5ds-control",function(){e.changeImage()})}},{key:"componentWillUnmount",value:function(){this.$layer&&(this.$layer.off("controlStart.h5ds.img"),this.$layer.off("controlResizeTick.h5ds.img"),this.$layer=null),$("#h5dsCanvas").off("dblclick.imgeditor")}},{key:"render",value:function(){var e=this.state,t=e.src,a=e.crop,n=e.cropKey;return q.a.createElement("div",{className:"h5ds-edit-h5ds_img",key:n},q.a.createElement(oe,{cropSet:a,onClickNullImage:this.changeImage,onChangeImage:this.changeImage,onCropOk:this.cropCallback,src:t}))}}]),t}(G.Component),H()(I.prototype,"renderLayer",[U.c],Object.getOwnPropertyDescriptor(I.prototype,"renderLayer"),I.prototype),H()(I.prototype,"changeImage",[U.c],Object.getOwnPropertyDescriptor(I.prototype,"changeImage"),I.prototype),H()(I.prototype,"scaleEvent",[U.c],Object.getOwnPropertyDescriptor(I.prototype,"scaleEvent"),I.prototype),H()(I.prototype,"cropCallback",[U.c],Object.getOwnPropertyDescriptor(I.prototype,"cropCallback"),I.prototype),I),se=function e(){p()(this,e),this.id=null,this.className=null,this.animate=[],this.data={src:"http://cdn.h5ds.cn/lib/images/imgDom.jpg",naturalWidth:200,naturalHeight:150,crop:""},this.style={width:200,height:150,top:10,left:10},this.estyle={},this.events=[]},ie=q.a.createElement("i",{className:"h5ds-ico h5ds-ico-beijing"});function ce(e){U.e.publish("h5ds.img.modal.show",{callback:function(t){!function(e,t){var a=t.h5ds,n=t.scope.pluginsKey,o=a.getJsonByPid(n,"h5ds_img");U.i.imgLazy(e).then(function(t){t?Object(Y.transaction)(function(){var n=JSON.stringify({top:0,left:0,width:t.naturalWidth,height:t.naturalWidth,naturalWidth:t.naturalWidth,naturalHeight:t.naturalWidth}),r=$(".h5ds-canvas-realsize").position(),s=r.top,i=r.left;(s=-s/a.edata.phoneScale)<0&&(s=0),(i=-i/a.edata.phoneScale)<0&&(i=0),o.data.crop=n,o.style.top=s+20,o.style.left=i+20,o.style.width=t.naturalWidth/2||200,o.style.height=t.naturalHeight/2||200,o.data.src=e,a.addLayer(o),a.edata.keys=U.i.randomID(),a.setLayer(0),U.e.publish("h5ds.setHistory")}):Q.a.error("图片加载失败！")})}(t,e)}})}var le,pe,ue,he,de,me=a(43),ye=(a(42),a(25)),fe=a.n(ye),ge=(a(105),a(106),a(64)),ve=a.n(ge),be=(le=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).container=document.createElement("div"),document.body.appendChild(a.container),a}return v()(t,e),h()(t,[{key:"onClose",value:function(){this.props.close&&this.props.close()}},{key:"componentWillUnmount",value:function(){document.body.removeChild(this.container)}},{key:"render",value:function(){var e=this.props,t=e.show,a=e.title,n=e.className,o=["h5ds-modal"];return t&&o.push("h5ds-modal-show"),a&&o.push("h5ds-modal-hastitle"),n&&o.push(n),ve.a.createPortal(q.a.createElement("div",{className:o.join(" ")},q.a.createElement("a",{className:"h5ds-modal-close",onClick:this.onClose},"×"),a?q.a.createElement("div",{className:"h5ds-modal-title"},q.a.createElement("span",{className:"h5ds-modal-title-icon"}),q.a.createElement("h3",null,a)):null,q.a.createElement("div",{className:"h5ds-modal-content"},t?this.props.children:null)),this.container)}}]),t}(G.Component),H()(le.prototype,"onClose",[U.c],Object.getOwnPropertyDescriptor(le.prototype,"onClose"),le.prototype),le),we=(pe=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={visible:!1},a}return v()(t,e),h()(t,[{key:"hideModal",value:function(){this.setState({visible:!1})}},{key:"selectPicture",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};this.selectImgCallback&&this.selectImgCallback(t.url),this.hideModal()}},{key:"componentDidMount",value:function(){var e=this;U.e.subscribe("h5ds.img.modal.show",function(t,a){var n=a.callback,o=void 0===n?null:n;e.selectImgCallback=o,e.setState({visible:!0})})}},{key:"componentWillUnmount",value:function(){U.e.unsubscribe("h5ds.img.modal.show")}},{key:"render",value:function(){var e=this.props.scope.options,t=void 0===e?{}:e;return q.a.createElement(be,{className:"h5ds-modal-source",close:this.hideModal,title:q.a.createElement("div",null,"图片库"," ",q.a.createElement(fe.a,{onClick:this.hideModal,className:"h5ds-modal-close-button"},"关闭窗口")),show:this.state.visible},t.imageSourceModal?q.a.createElement(t.imageSourceModal,{select:this.selectPicture}):q.a.createElement("div",{style:{color:"#fff"}},"未设置options.imageSourceModal参数"))}}]),t}(G.Component),H()(pe.prototype,"hideModal",[U.c],Object.getOwnPropertyDescriptor(pe.prototype,"hideModal"),pe.prototype),H()(pe.prototype,"selectPicture",[U.c],Object.getOwnPropertyDescriptor(pe.prototype,"selectPicture"),pe.prototype),pe),ke=(a(36),a(21)),Ee=a.n(ke),xe=(a(107),a(108),a(82)),Oe=a(41),Se=a.n(Oe),Ce=(ue=function(e){function t(e){var a;p()(this,t);var n=(a=m()(this,f()(t).call(this,e))).filterColor(e.color);return a.state={colorStyle:{},show:!1,color:n},a.id=U.i.randomID(6),a}return v()(t,e),h()(t,[{key:"filterColor",value:function(e){if(e){var t=Se()(e),a=t.getAlpha();e=t.setAlpha(a).toRgbString()}else e="rgba(0,0,0,1)";return e}},{key:"showPicker",value:function(e){var t={};window.innerWidth<$(e.target).offset().left+220&&(t.left=window.innerWidth-($(e.target).offset().left+220)),window.innerHeight<$(e.target).offset().top+246&&(t.top=window.innerHeight-($(e.target).offset().top+310+10)),this.setState({show:!this.state.show,colorStyle:t})}},{key:"doChange",value:function(e){var t=this.props.onChange;if(t){var a=e.rgb,n=a.r,o=a.g,r=a.b,s=a.a;e.rgba="rgba(".concat(n,",").concat(o,",").concat(r,",").concat(s,")"),t(e)}}},{key:"changeColor",value:function(e){var t=this,a=e.rgb,n=a.r,o=a.g,r=a.b,s=a.a;this.setState({color:"rgba(".concat(n,",").concat(o,",").concat(r,",").concat(s,")")},function(){return t.doChange(e)})}},{key:"clickBank",value:function(e){this.unmount||$(e.target).closest(".h5ds-util-color")[0]||this.setState({show:!1})}},{key:"componentDidMount",value:function(){$(document).on("click.blank_"+this.id,this.clickBank)}},{key:"componentWillUnmount",value:function(){this.unmount=!0,$(document).off("click.blank_"+this.id)}},{key:"render",value:function(){var e=this.state,t=e.show,a=e.color,n=e.colorStyle,o=this.props.children;return n.zIndex=t?9999:"initial",q.a.createElement("div",{className:"h5ds-util-color"},o?q.a.createElement("span",{className:"h5ds-util-color-inner",style:{backgroundColor:a},onClick:this.showPicker},o):q.a.createElement("span",{className:"h5ds-util-color-btn",style:{backgroundColor:a},onClick:this.showPicker}),t?q.a.createElement("div",{className:"h5ds-util-color-box",style:E()({},n)},q.a.createElement(xe.SketchPicker,{presetColors:["#D0021B","#F5A623","#F8E71C","#8B572A","#7ED321","#417505","#BD10E0","#9013FE","#4A90E2","#50E3C2","#B8E986","#000000","#4A4A4A","#9B9B9B","#FFFFFF"],color:a,onChange:this.changeColor})):null)}}]),t}(G.Component),H()(ue.prototype,"showPicker",[U.c],Object.getOwnPropertyDescriptor(ue.prototype,"showPicker"),ue.prototype),H()(ue.prototype,"doChange",[U.c],Object.getOwnPropertyDescriptor(ue.prototype,"doChange"),ue.prototype),H()(ue.prototype,"changeColor",[U.c],Object.getOwnPropertyDescriptor(ue.prototype,"changeColor"),ue.prototype),H()(ue.prototype,"clickBank",[U.c],Object.getOwnPropertyDescriptor(ue.prototype,"clickBank"),ue.prototype),ue),De=(a(109),function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.span,n=["h5ds-layout-setgrid","h5ds-layout-setgrid-".concat(void 0===a?1:a)];return q.a.createElement("div",{className:n.join(" ")},t)}}]),t}(G.Component)),Ne=(a(110),function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.children,n=e.className,o=void 0===n?"":n;return q.a.createElement("div",{className:"h5ds-layout-setitem "+o},q.a.createElement("div",{className:"h5ds-layout-setitem-name"},t),q.a.createElement("div",{className:"h5ds-layout-setitem-content"},a))}}]),t}(G.Component)),Pe=(he=function(e){function t(e){var a;p()(this,t),a=m()(this,f()(t).call(this,e));var n=e.color;return a.state={color:a.filterColor(n)},a}return v()(t,e),h()(t,[{key:"filterColor",value:function(e){if(e){var t=Se()(e),a=t.getAlpha();e=t.setAlpha(a).toRgbString()}else e="rgba(0,0,0,0)";return e}},{key:"setColor",value:function(e){var t=e.rgb,a=t.r,n=t.g,o=t.b,r=t.a;this.setState({color:"rgba(".concat(a,",").concat(n,",").concat(o,",").concat(r,")")}),this.props.onChange&&this.props.onChange(e)}},{key:"render",value:function(){var e=this.state.color,t=this.props.title;return q.a.createElement("div",{className:"h5ds-util-bgcolor"},q.a.createElement(Ne,{name:t||"背景底色"},q.a.createElement(Ce,{onChange:this.setColor,color:e})))}}]),t}(G.Component),H()(he.prototype,"setColor",[U.c],Object.getOwnPropertyDescriptor(he.prototype,"setColor"),he.prototype),he),je=(de=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).renderLayer=U.i.debounce(function(){Object(Y.transaction)(function(){var e=a.props.layer.data,t=(e.style,F()(e,["style"]));a.props.layer.data=E()({style:E()({},a.state.data.style)},t),a.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})},500),a.state={data:Object(Y.toJS)(e.layer.data)||{}},a}return v()(t,e),h()(t,[{key:"changeColor",value:function(e){var t=this.state.data,a=e.rgb,n=a.r,o=a.g,r=a.b,s=a.a;t.style.fill="rgba(".concat(n,",").concat(o,",").concat(r,",").concat(s,")"),this.setState({data:t},this.renderLayer)}},{key:"changeStrokeWidth",value:function(e){var t=this.state.data;t.style.strokeWidth=e,this.setState({data:t},this.renderLayer)}},{key:"render",value:function(){var e=this.state.data;return q.a.createElement("div",{className:"h5ds-ex-h5ds_shape"},q.a.createElement(Ne,{name:"选择颜色"},q.a.createElement(Ce,{onChange:this.changeColor,color:e.style.fill||"rgba(0,0,0,1)"})),"line"===e.shape?q.a.createElement(Ne,{name:"线条宽度"},q.a.createElement(Ee.a,{min:1,max:1/0,size:"small",className:"h5ds-input",defaultValue:e.style.strokeWidth||1,onChange:this.changeStrokeWidth,placeholder:"边框样式"})):null)}}]),t}(G.Component),H()(de.prototype,"changeColor",[U.c],Object.getOwnPropertyDescriptor(de.prototype,"changeColor"),de.prototype),H()(de.prototype,"changeStrokeWidth",[U.c],Object.getOwnPropertyDescriptor(de.prototype,"changeStrokeWidth"),de.prototype),de),Le=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};p()(this,e),this.id=null,this.className=null,this.animate=[],this.data={shape:t,style:this.getStyle()},this.style={width:200,height:200,top:0,left:0},this.estyle={},this.events=[]}return h()(e,[{key:"getStyle",value:function(){var e={fill:"rgba(0, 0, 0, 1)"};switch(this.shape){case"line":e.strokeWidth=2,e.x1=0,e.y1=0,e.x2=0,e.y2=0}return e}}]),e}(),Ie=q.a.createElement("i",{className:"h5ds-ico h5ds-ico-xingzhuang"});function Ae(e){U.e.publish("h5ds.shape.modal.show",{callback:function(t){console.log(t,e)}})}var Te,ze,_e,$e=a(46),We=(a(111),a(112),Te=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).container=document.createElement("div"),document.body.appendChild(a.container),a}return v()(t,e),h()(t,[{key:"onClose",value:function(){this.props.close&&this.props.close()}},{key:"render",value:function(){var e=this.props,t=e.show,a=e.title,n=e.className,o=["h5ds-drawer"];return t&&o.push("h5ds-drawer-show"),a&&o.push("h5ds-drawer-hastitle"),n&&o.push(n),ve.a.createPortal(q.a.createElement("div",{className:o.join(" ")},q.a.createElement("a",{className:"h5ds-drawer-close",onClick:this.onClose},"×"),a?q.a.createElement("div",{className:"h5ds-drawer-title"},q.a.createElement("span",{className:"h5ds-drawer-title-icon"}),q.a.createElement("h3",null,a)):null,q.a.createElement("div",{className:"h5ds-drawer-content"},t?this.props.children:null)),this.container)}}]),t}(G.Component),H()(Te.prototype,"onClose",[U.c],Object.getOwnPropertyDescriptor(Te.prototype,"onClose"),Te.prototype),Te),He=a(83),Re=a(48),Me=(ze=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={visible:!1},a.willDrawShape="",a}return v()(t,e),h()(t,[{key:"hideModal",value:function(){this.setState({visible:!1})}},{key:"drawShape",value:function(e){this.willDrawShape=e,$(".h5ds-center").append('<div class="h5ds-shape-shapepanel"></div>'),this.hideModal()}},{key:"addLayerData",value:function(e){var t=this,a=e.left,n=e.top,o=e.width,r=e.height,s=e.quadrant,i=this.props.scope.pluginsKey,c=this.props.h5ds.getJsonByPid(i,"h5ds_shape",this.willDrawShape),l="";switch(s){case 1:l="1, -1";break;case 2:l="-1, -1";break;case 3:l="-1, 1";break;case 4:l="1, 1"}"line"===this.willDrawShape&&(c.data.style.strokeWidth=1);var p=parseFloat($(".h5ds-canvas-box").transform("scale"))||1;c.style.width=o/p,c.style.height=r/p,c.style.left=a/p,c.style.top=n/p,c.data.transform="scale(".concat(l,")"),Object(Y.transaction)(function(){t.props.h5ds.addLayer(c),t.props.h5ds.edata.keys=U.i.randomID()}),this.props.h5ds.clickLayer()}},{key:"drawTemporaryShape",value:function(e){var t=this,a=e.top,n=e.left,o=e.width,r=e.height,s=e.quadrant;if(this.$temporary){"line"===this.willDrawShape&&(this.$temporary.find("svg").attr({viewBox:"0 0 ".concat(o," ").concat(r)}),this.$temporary.find("line").attr({x1:0,y1:0,x2:o,y2:r}));var i="";switch(s){case 1:i="1, -1";break;case 2:i="-1, -1";break;case 3:i="-1, 1";break;case 4:i="1, 1"}this.$temporary.css({top:a,left:n,width:o,height:r,transform:"scale(".concat(i,")")})}else{var c,l="id_".concat(U.i.randomID()),p=Re.a.find(function(e){return e.type===t.willDrawShape});c=Object(He.renderToStaticMarkup)(p.dom()),$(".h5ds-shape-shapepanel").html('<div class="h5ds-shape-shapepanel-inner" id="'.concat(l,'">').concat(c,"</div>")),this.$temporary=$("#".concat(l))}}},{key:"drawShapeEvent",value:function(){var e=this;$(document).on("mousedown.h5ds.shapepanel",".h5ds-shape-shapepanel",function(t){var a=$(".h5ds-center").offset(),n=a.left,o=a.top,r={width:0,height:0,left:t.pageX-n,top:t.pageY-o},s=4;$(document).on("mousemove.h5ds.shapepanel",function(a){r.width=Math.abs(a.pageX-t.pageX),r.height=Math.abs(a.pageY-t.pageY),a.shiftKey&&(r.height=r.width),s=a.pageX>t.pageX?(r.left=t.pageX,a.pageY>t.pageY?4:1):(r.left=a.pageX,a.pageY>t.pageY?3:2),a.pageY>t.pageY?r.top=t.pageY:a.shiftKey?(a.pageX=a.pageY,r.top=t.pageY-r.height):r.top=a.pageY,r.left-=n,r.top-=o,e.drawTemporaryShape(E()({},r,{quadrant:s}))}).on("mouseup.h5ds.shapepanel",function(){e.$temporary=null;var t=$(".h5ds-js-canvas").offset();r.left=r.left-t.left+n,r.top=r.top-t.top+o,e.addLayerData(E()({},r,{quadrant:s})),$(".h5ds-shape-shapepanel")[0]&&$(".h5ds-shape-shapepanel").remove(),$(document).off("mousemove.h5ds.shapepanel"),$(document).off("mouseup.h5ds.shapepanel")})})}},{key:"componentDidMount",value:function(){var e=this;U.e.subscribe("h5ds.shape.modal.show",function(t,a){var n=a.callback,o=void 0===n?null:n;e.selectCallback=o,e.setState({visible:!0})}),this.drawShapeEvent()}},{key:"componentWillUnmount",value:function(){$(".h5ds-shape-shapepanel")[0]&&$(".h5ds-shape-shapepanel").remove(),$(document).off("mousedown.h5ds.shapepanel"),U.e.unsubscribe("h5ds.shape.modal.show")}},{key:"render",value:function(){var e=this;return q.a.createElement(We,{className:"h5ds-shape-source",close:this.hideModal,title:null,show:this.state.visible},q.a.createElement("div",{className:"h5ds-shape-list"},Re.a.map(function(t,a){return q.a.createElement("div",{className:"h5ds-shape-item",key:a,onClick:function(){return e.drawShape(t.type)}},t.img?q.a.createElement("img",{src:t.img}):t.dom({fill:"rgba(255,255,255,1)"}))})))}}]),t}(G.Component),H()(ze.prototype,"hideModal",[U.c],Object.getOwnPropertyDescriptor(ze.prototype,"hideModal"),ze.prototype),H()(ze.prototype,"drawShape",[U.c],Object.getOwnPropertyDescriptor(ze.prototype,"drawShape"),ze.prototype),H()(ze.prototype,"addLayerData",[U.c],Object.getOwnPropertyDescriptor(ze.prototype,"addLayerData"),ze.prototype),H()(ze.prototype,"drawTemporaryShape",[U.c],Object.getOwnPropertyDescriptor(ze.prototype,"drawTemporaryShape"),ze.prototype),H()(ze.prototype,"drawShapeEvent",[U.c],Object.getOwnPropertyDescriptor(ze.prototype,"drawShapeEvent"),ze.prototype),ze),Be=(a(37),a(23)),Fe=a.n(Be),Ge=(a(113),_e=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={keys:U.i.randomID()},a.loadSource=new U.a,a}return v()(t,e),h()(t,[{key:"changeDelay",value:function(e){this.props.layer.data.delay=e,this.setState({keys:U.i.randomID()})}},{key:"autoPlayDo",value:function(e){this.props.layer.data.autoplay=e,this.setState({keys:U.i.randomID()})}},{key:"changeMusicIcon",value:function(e){var t=this;Object(Y.transaction)(function(){t.props.layer.data.icon=e?"default":"null",t.props.h5ds.edata.keys=U.i.randomID(),t.setState({keys:U.i.randomID()}),U.e.publish("h5ds.setHistory")})}},{key:"changeMusicLoop",value:function(e){var t=this;Object(Y.transaction)(function(){t.props.layer.data.loop=e,t.props.h5ds.edata.keys=U.i.randomID(),t.setState({keys:U.i.randomID()}),U.e.publish("h5ds.setHistory")})}},{key:"changeMusicAutoPlay",value:function(e){var t=this;Object(Y.transaction)(function(){t.props.layer.data.autoplay=e,t.props.h5ds.edata.keys=U.i.randomID(),t.setState({keys:U.i.randomID()}),U.e.publish("h5ds.setHistory")})}},{key:"changeSound",value:function(){var e=this;U.e.publish("h5ds.sound.modal.show",{callback:function(t){var a=t.url,n=t.name;e.loadSource.soundLazy(a).then(function(t){Object(Y.transaction)(function(){e.props.layer.data.name=n,e.props.layer.data.sound=a,e.props.layer.data.duration=t.duration,e.setState({keys:U.i.randomID()}),U.e.publish("h5ds.setHistory")})})}})}},{key:"render",value:function(){this.state.keys;var e=this.props.layer.data,t=e.delay,a=e.autoplay,n=e.loop,o=e.icon,r=e.name,s=e.sound;return q.a.createElement("div",{className:"h5ds-ex-h5ds_sound"},q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"音乐图标"},q.a.createElement(Fe.a,{checked:"null"!==o,onChange:this.changeMusicIcon}))),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"循环播放"},q.a.createElement(Fe.a,{checked:n,onChange:this.changeMusicLoop}))),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"自动播放"},q.a.createElement(Fe.a,{checked:a,onChange:this.changeMusicAutoPlay}))),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"延迟时间"},q.a.createElement(Ee.a,{step:.1,min:0,value:t,onChange:this.changeDelay,size:"small"}))),q.a.createElement(Ne,{name:"当前音乐"},q.a.createElement("span",{className:"h5ds-ex-h5ds_sound-name"},r),q.a.createElement("audio",{className:"h5ds-sound-controls",key:s,controls:!0},q.a.createElement("source",{src:s,type:"audio/mpeg"})),q.a.createElement(fe.a,{type:"primary",onClick:this.changeSound},"替换音乐")))}}]),t}(G.Component),H()(_e.prototype,"changeDelay",[U.c],Object.getOwnPropertyDescriptor(_e.prototype,"changeDelay"),_e.prototype),H()(_e.prototype,"autoPlayDo",[U.c],Object.getOwnPropertyDescriptor(_e.prototype,"autoPlayDo"),_e.prototype),H()(_e.prototype,"changeMusicIcon",[U.c],Object.getOwnPropertyDescriptor(_e.prototype,"changeMusicIcon"),_e.prototype),H()(_e.prototype,"changeMusicLoop",[U.c],Object.getOwnPropertyDescriptor(_e.prototype,"changeMusicLoop"),_e.prototype),H()(_e.prototype,"changeMusicAutoPlay",[U.c],Object.getOwnPropertyDescriptor(_e.prototype,"changeMusicAutoPlay"),_e.prototype),H()(_e.prototype,"changeSound",[U.c],Object.getOwnPropertyDescriptor(_e.prototype,"changeSound"),_e.prototype),_e),qe=function e(){p()(this,e),this.id=null,this.className=null,this.animate=[],this.data={icon:"default",name:"圣诞节音乐",autoplay:!0,loop:!1,delay:0,duration:1.7,sound:"http://cdn.h5ds.cn/static/sound/星星闪耀的转场声音.mp3"},this.style={top:0,left:0,width:26,height:26,display:"block"},this.estyle={},this.events=[]},Ue=q.a.createElement("i",{className:"h5ds-ico h5ds-ico-yinle"});function Ye(e){U.e.publish("h5ds.sound.modal.show",{callback:function(t){!function(e,t){var a=t.h5ds,n=t.scope.pluginsKey,o=a.getJsonByPid(n,"h5ds_sound");(new U.a).soundLazy(e.url).then(function(t){t?Object(Y.transaction)(function(){o.data.name=e.name,o.data.sound=e.url,o.data.duration=t.duration,a.addLayer(o),a.edata.keys=U.i.randomID(),a.setLayer(0),U.e.publish("h5ds.setHistory")}):Q.a.error("音乐加载失败！")})}(t,e)}})}function Ve(e){return new Promise(function(t,a){var n=(Dt.find(function(t){return t.name===e})||{}).url;if(n){var o=new XMLHttpRequest;o.open("get",n),o.responseType="blob",o.onprogress=function(e){if(e.lengthComputable){var t=e.loaded/e.total;console.log("文字已经加载：",t)}},o.onload=function(a){200==a.target.status&&t(e)},o.ontimeout=function(){Q.a.error("请求超时！"),a(!1)},o.send()}else t(e)})}var Je,Xe,Ke,Qe,Ze,et,tt,at,nt,ot,rt,st,it,ct=a(45),lt=(Je=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={visible:!1},a}return v()(t,e),h()(t,[{key:"hideModal",value:function(){this.setState({visible:!1})}},{key:"selectSound",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};this.selectSoundCallback&&this.selectSoundCallback(t),this.hideModal()}},{key:"componentDidMount",value:function(){var e=this;U.e.subscribe("h5ds.sound.modal.show",function(t,a){var n=a.callback,o=void 0===n?null:n;e.selectSoundCallback=o,e.setState({visible:!0})})}},{key:"componentWillUnmount",value:function(){U.e.unsubscribe("h5ds.sound.modal.show")}},{key:"render",value:function(){var e=this.props.scope.options,t=void 0===e?{}:e;return q.a.createElement(be,{className:"h5ds-modal-source",close:this.hideModal,title:q.a.createElement("div",null,"音乐库"," ",q.a.createElement(fe.a,{onClick:this.hideModal,className:"h5ds-modal-close-button"},"关闭窗口")),show:this.state.visible},t.soundSourceModal?q.a.createElement(t.soundSourceModal,{select:this.selectSound}):q.a.createElement("div",{style:{color:"#fff"}},"未设置options.soundSourceModal参数"))}}]),t}(G.Component),H()(Je.prototype,"hideModal",[U.c],Object.getOwnPropertyDescriptor(Je.prototype,"hideModal"),Je.prototype),H()(Je.prototype,"selectSound",[U.c],Object.getOwnPropertyDescriptor(Je.prototype,"selectSound"),Je.prototype),Je),pt=(a(114),a(115),a(84)),ut=a.n(pt),ht=(a(54),a(34)),dt=a.n(ht),mt=(a(71),a(53)),yt=a.n(mt),ft=(a(72),a(30)),gt=a.n(ft),vt=a(50),bt=(Xe=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"emitChange",value:function(){var e=this.dom.innerHTML;this.props.onChange&&e!==this.lastHtml&&this.props.onChange({target:{value:e}}),this.lastHtml=e}},{key:"shouldComponentUpdate",value:function(e){return e.html!==this.dom.innerHTML}},{key:"componentDidMount",value:function(){$(this.dom).off("paste").on("paste",function(e){e.preventDefault();var t=e.originalEvent.clipboardData.getData("text/plain");document.execCommand("insertText",!1,t)})}},{key:"componentWillUnmount",value:function(){$(this.dom).off("paste")}},{key:"render",value:function(){var e=this,t=this.props,a=t.className,n=t.html;return q.a.createElement("div",{ref:function(t){return e.dom=t},className:a||"",onInput:this.emitChange,onBlur:this.emitChange,contentEditable:!0,dangerouslySetInnerHTML:{__html:n}})}}]),t}(G.Component),H()(Xe.prototype,"emitChange",[U.c],Object.getOwnPropertyDescriptor(Xe.prototype,"emitChange"),Xe.prototype),Xe),wt=(a(116),a(117),a(118),a(85)),kt=a.n(wt),Et=a(86),xt=a.n(Et),Ot=function(e){function t(e){return p()(this,t),m()(this,f()(t).call(this,e))}return v()(t,e),h()(t,[{key:"render",value:function(){var e=this.props,t=e.value,a=void 0===t?0:t,n=e.onChange,o=e.parser,r=void 0===o?void 0:o,s=e.formatter,i=void 0===s?void 0:s,c=e.name,l=void 0===c?"":c,p=e.min,u=void 0===p?0:p,h=e.max,d=void 0===h?100:h,m=e.step,y=void 0===m?1:m,f=e.size,g=void 0===f?"default":f,v=e.mouseWheelClassName,b=void 0===v?"":v;return q.a.createElement("div",{className:"h5ds-util-sliderinput "+("small"===g?"h5ds-util-sliderinput2":"")},l?q.a.createElement("label",{className:"h5ds-util-sliderinput-name"},l):null,q.a.createElement(xt.a,{onChange:n,tipFormatter:null,min:u,step:y,max:d,value:a}),q.a.createElement(kt.a,{className:b,step:y,size:"small",min:u,max:d,parser:r,formatter:i,value:a||0,onChange:n}))}}]),t}(G.Component),St=[{name:"快闪",interval:"0.05s",type:"in",animate:"fastShow",time:"0.1s",delay:"0s",count:1,fun:"linear"},{name:"缩小入",interval:"0.05s",type:"in",animate:"smallIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"弹入",interval:"0.05s",type:"in",animate:"bounceIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上弹入",interval:"0.05s",type:"in",animate:"bounceInDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左弹入",interval:"0.05s",type:"in",animate:"bounceInLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右弹入",interval:"0.05s",type:"in",animate:"bounceInRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下弹入",interval:"0.05s",type:"in",animate:"bounceInUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"渐显",interval:"0.05s",type:"in",animate:"fadeIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上渐显",interval:"0.05s",type:"in",animate:"fadeInDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上远渐显",interval:"0.05s",type:"in",animate:"fadeInDownBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左渐显",interval:"0.05s",type:"in",animate:"fadeInLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左远渐显",interval:"0.05s",type:"in",animate:"fadeInLeftBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右渐入",interval:"0.05s",type:"in",animate:"fadeInRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右远渐入",interval:"0.05s",type:"in",animate:"fadeInRightBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下渐入",interval:"0.05s",type:"in",animate:"fadeInUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下远渐入",interval:"0.05s",type:"in",animate:"fadeInUpBig",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"X翻牌",interval:"0.05s",type:"in",animate:"flipInX",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"Y翻牌",interval:"0.05s",type:"in",animate:"flipInY",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"光速入",interval:"0.05s",type:"in",animate:"lightSpeedIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"滚入",interval:"0.05s",type:"in",animate:"rotateIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左上滚入",interval:"0.05s",type:"in",animate:"rotateInDownLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右上滚入",interval:"0.05s",type:"in",animate:"rotateInDownRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左下滚入",interval:"0.05s",type:"in",animate:"rotateInUpLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右下滚入",interval:"0.05s",type:"in",animate:"rotateInUpRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"下滑入",interval:"0.05s",type:"in",animate:"slideInUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"上滑入",interval:"0.05s",type:"in",animate:"slideInDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左滑入",interval:"0.05s",type:"in",animate:"slideInLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"右滑入",interval:"0.05s",type:"in",animate:"slideInRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"放大",interval:"0.05s",type:"in",animate:"zoomIn",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"从上放大",interval:"0.05s",type:"in",animate:"zoomInDown",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"从左放大",interval:"0.05s",type:"in",animate:"zoomInLeft",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"从右放大",interval:"0.05s",type:"in",animate:"zoomInRight",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"从下放大",interval:"0.05s",type:"in",animate:"zoomInUp",time:"1s",delay:"0s",count:1,fun:"ease"},{name:"左滚入",interval:"0.05s",type:"in",animate:"rollIn",time:"1s",delay:"0s",count:1,fun:"ease"}],Ct=[12,14,16,18,20,22,24,26,28,30,32,34,36,38,42,48,60,72,84,96,108,120,132,144,156,168,180,192,204,216,228,240,252,264,276,288,300,312,324,336,348,360,372,384,396,408,420,432,444,456,468,480,492],Dt=[{name:"默认字体",url:""},{name:"站酷高端黑",url:"/assets/fonts/站酷高端黑.TTF"},{name:"站酷快乐体",url:"/assets/fonts/站酷快乐体.TTF"}],Nt=[{type:"3d",name:"3D",colors:["#ffab00","#67490d"]},{type:"kaTong",name:"卡通",colors:["#4e1515"]},{type:"jiaXin",name:"夹心",colors:["#bf2929","#fff"]},{type:"yinYing",name:"阴影",colors:["#3c9df3","#12e686"]},{type:"niHong",name:"霓虹",colors:["#f33c3c"]},{type:"border",name:"边框",colors:["#fff","#3c5ef3"]},{type:"cuoJue",name:"错觉",colors:["#000","#ff1dff","#4affff"]},{type:"jianBian",name:"渐变",colors:["#fff","#1d24ff","#00efff"]},{type:"qieGe",name:"切割",colors:["#9075ff","#e227b1"]},{type:"fire",name:"火焰",colors:["#F00"]},{type:"snow",name:"冰雪",colors:["#9dffff","#98e7ff"]},{type:"louKong",name:"镂空",colors:["#ff7c7c","#de0000"]}],Pt=(Ke=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).renderLayer=U.i.debounce(a.renderLayerAsyncFlase,100),a.changeText=U.i.debounce(function(e){a.props.layer.data.data=e.target.value,a.calibration()},500);var n=Object(Y.toJS)(e.layer.data)||{};return a.state={html:n.data,fontFamilySet:n.fontFamilySet||{},style:n.style||{},animate:n.animate,artword:n.artword||{},artwordKey:U.i.randomID(),fontLoading:!1},a.unmount=!1,a}var a;return v()(t,e),h()(t,[{key:"renderLayerAsyncFlase",value:function(){var e=this,t=this.props.layer,a=this.state,n=a.style,o=a.animate,r=a.artword,s=a.fontFamilySet;Object(Y.transaction)(function(){t.data.fontFamilySet=E()({},s),t.data.style=E()({},n),t.data.animate=o?E()({},o):"",t.data.artword=U.i.cloneDeep(r),e.calibration()})}},{key:"calibration",value:function(){var e=this;Object(Y.transaction)(function(){e.props.h5ds.edata.keys=U.i.randomID();var t=e.props.h5ds.getLayerDom();t&&(e.editAuto=t.find(".layer-h5ds_text-auto"),e.editAuto&&(e.props.layer.style.height=e.editAuto.height(),U.e.publish("h5ds.initControl"),U.e.publish("h5ds.setHistory")))})}},{key:"setClassName",value:function(e){var t=["h5ds-ex-h5ds_text-btn"];return e&&t.push("h5ds-active"),t.join(" ")}},{key:"fontWeight",value:function(){var e=this.state.style;"bold"===e.fontWeight?e.fontWeight="normal":e.fontWeight="bold",this.setState({style:e},this.renderLayer)}},{key:"fontStyle",value:function(e){var t=this.state.style;t.fontStyle===e?t.fontStyle="normal":t.fontStyle=e,this.setState({style:t},this.renderLayer)}},{key:"fontDecoration",value:function(e){var t=this.state.style;t.textDecoration===e?t.textDecoration="none":t.textDecoration=e,this.setState({style:t},this.renderLayer)}},{key:"textAlign",value:function(e){var t=this.state.style;t.textAlign===e?t.textAlign="normal":t.textAlign=e,this.setState({style:t},this.renderLayer)}},{key:"setFontSize",value:function(e){var t=this.state.style;t.fontSize=e,this.setState({style:t},this.renderLayer)}},{key:"setFontColor",value:function(e){var t=e.rgb,a=t.r,n=t.g,o=t.b,r=t.a,s=this.state.style;s.color="rgba(".concat(a,",").concat(n,",").concat(o,",").concat(r,")"),this.setState({style:s},this.renderLayer)}},{key:"changeFontSpace",value:function(e){var t=this.state.style;t.letterSpacing=e,this.setState({style:t},this.renderLayerAsyncFlase)}},{key:"changeFontLineHeight",value:function(e){var t=this.state.style;t.lineHeight=e,this.setState({style:t},this.renderLayerAsyncFlase)}},{key:"selectAnimate",value:function(e){for(var t={},a=0;a<St.length;a++)if(St[a].animate===e){t=E()({},St[a]);break}this.setState({animate:t},this.renderLayerAsyncFlase)}},{key:"loadFontFamily",value:(a=ae()(ee.a.mark(function e(t){var a=this;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({fontLoading:!0}),e.next=3,Ve(t).then(function(e){var t=a.state,n=t.style,o=t.fontFamilySet;o="默认字体"!==(n.fontFamily=e)?Dt.filter(function(t){return t.name===e})[0]:{name:"默认字体",url:""},a.setState({style:n,fontFamilySet:o,fontLoading:!1},a.renderLayerAsyncFlase)});case 3:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"setAnimate",value:function(e,t){var a=this.state.animate;a[t]="fun"!==t?e+"s":e,this.setState({animate:a},this.renderLayerAsyncFlase)}},{key:"onSwitchAnimate",value:function(e){var t="";e&&(t=E()({},St[0])),this.setState({animate:t},this.renderLayer)}},{key:"onSwitchArtWord",value:function(e){var t;t=e?E()({},Nt[0]):{type:"",name:"",colors:[]},this.setState({artword:t},this.renderLayer)}},{key:"selectArtWord",value:function(e){this.props.layer.data.artword=U.i.cloneDeep(e),this.setState({artword:U.i.cloneDeep(e),artwordKey:U.i.randomID()},this.renderLayer)}},{key:"onChangeArtWordSize",value:function(e){var t=this.state.artword;t.size=e,this.setState({artword:t},this.renderLayer)}},{key:"setArtWordColor",value:function(e,t){var a=e.rgb,n=a.r,o=a.g,r=a.b,s=a.a,i="rgba(".concat(n,",").concat(o,",").concat(r,",").concat(s,")"),c=this.state.artword;c.colors[t]=i,this.setState({artword:c},this.renderLayer)}},{key:"loadFontSource",value:function(){var e=this;console.log("新初始化了 <EditorSet />");var t=this.state.style,a=t.fontFamily,n=t.fontFamilySet;this.setState({fontLoading:!0}),Ve(a).then(function(t){n="默认字体"!==t?Dt.filter(function(e){return e.name===t})[0]:{name:"默认字体",url:""},e.unmount||e.setState({fontFamilySet:n,fontLoading:!1},e.renderLayerAsyncFlase)})}},{key:"componentDidMount",value:function(){this.loadFontSource()}},{key:"componentWillUnmount",value:function(){this.unmount=!0}},{key:"render",value:function(){var e=this,t=gt.a.Option,a=this.state.style,n=a.fontWeight,o=void 0===n?"normal":n,r=a.textAlign,s=void 0===r?"left":r,i=a.textDecoration,c=void 0===i?"none":i,l=a.fontStyle,p=void 0===l?"normal":l,u=a.color,h=void 0===u?"rgba(0,0,0,1)":u,d=a.fontSize,m=void 0===d?"14px":d,y=a.lineHeight,f=void 0===y?1:y,g=a.letterSpacing,v=void 0===g?0:g,b=a.fontFamily,w=this.state.animate||{},k=w.animate,E=void 0===k?"bounceIn":k,x=w.time,O=void 0===x?"0s":x,S=w.delay,C=void 0===S?"0s":S,D=w.interval,N=void 0===D?"0.2s":D,P=w.fun,j=void 0===P?"ease":P,L=this.state.artword;return q.a.createElement("div",{key:this.props.keyid},q.a.createElement(De,{className:"h5ds-ex-h5ds_text-btns"},q.a.createElement("a",{onClick:this.fontWeight,className:this.setClassName("bold"===o)},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-bold"})),q.a.createElement("a",{onClick:function(){return e.fontStyle("italic")},className:this.setClassName("italic"===p)},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-italic"})),q.a.createElement("a",{onClick:function(){return e.fontDecoration("line-through")},className:this.setClassName("line-through"===c)},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-strikethrough"})),q.a.createElement("a",{onClick:function(){return e.fontDecoration("underline")},className:this.setClassName("underline"===c)},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-underline"})),q.a.createElement("a",{onClick:function(){return e.textAlign("left")},className:this.setClassName("left"===s)},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-alignleft"})),q.a.createElement("a",{onClick:function(){return e.textAlign("center")},className:this.setClassName("center"===s)},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-aligncenter"})),q.a.createElement("a",{onClick:function(){return e.textAlign("right")},className:this.setClassName("right"===s)},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-alignright"}))),q.a.createElement(De,null,q.a.createElement(bt,{className:"h5ds-ex-h5ds_text-richtext",onChange:this.changeText,html:this.state.html})),q.a.createElement(Ne,{name:"选择字体"},q.a.createElement(gt.a,{key:b,onChange:function(t){return e.loadFontFamily(t)},size:"small",value:b||"",style:{width:120}},Dt.map(function(e,a){return q.a.createElement(t,{key:a,value:e.name},e.name)}))),q.a.createElement(Ne,{name:"字体大小"},q.a.createElement(gt.a,{key:m,onChange:this.setFontSize,size:"small",value:m||"14px",style:{width:120}},Ct.map(function(e){return q.a.createElement(t,{key:e,value:e+"px"},e,"px")}))),L.type?null:q.a.createElement(Ne,{name:"字体颜色"},q.a.createElement(Ce,{onChange:this.setFontColor,color:h})),q.a.createElement(Ne,{name:"艺术字"},q.a.createElement(Fe.a,{checked:!!L.type,onChange:this.onSwitchArtWord}),L.type?q.a.createElement("div",{className:"h5ds-artword-selects"},q.a.createElement(yt.a,{placement:"left",title:"字体特效",content:q.a.createElement("div",null,Nt.map(function(t){return q.a.createElement("div",{onClick:function(){return e.selectArtWord(t)},style:{margin:10},key:t.type},q.a.createElement(vt.a,T()({},t,{style:{fontSize:24,fontWeight:"bolder"}}),t.name,"艺术字效果"))})),trigger:"click"},q.a.createElement(fe.a,{size:"small",type:"primary"},L.name,"艺术字效果")),"   ",L.colors.map(function(t,a){return q.a.createElement(Ce,{key:a+e.state.artwordKey,onChange:function(t){return e.setArtWordColor(t,a)},color:t})}),q.a.createElement(Ne,{name:"效果强度"},q.a.createElement(Ee.a,{size:"small",min:1,max:1e4,value:L.size||10,onChange:this.onChangeArtWordSize}))):null),q.a.createElement(Ne,{name:"文字间距"},q.a.createElement(Ot,{mouseWheelClassName:"h5ds-scroll-SetLayerEtext",name:null,onChange:this.changeFontSpace,value:isNaN(v)?0:v,step:1,min:0,max:100})),q.a.createElement(Ne,{name:"文字行距"},q.a.createElement(Ot,{mouseWheelClassName:"h5ds-scroll-setLayerEtext2",name:null,onChange:this.changeFontLineHeight,value:isNaN(f)?1:f,step:.1,min:.1,max:100})),q.a.createElement(Ne,{name:"文字动画"},q.a.createElement(Fe.a,{checked:!!this.state.animate,onChange:this.onSwitchAnimate})),this.state.animate?q.a.createElement(De,{className:"h5ds-atext-animate"},q.a.createElement(Ne,{name:"动画类型"},q.a.createElement(gt.a,{onChange:this.selectAnimate,size:"small",style:{width:"100%"},value:E||"bounceIn"},St.map(function(e,a){return q.a.createElement(t,{key:a,value:e.animate},e.name)}))," ",this.state.fontLoading?q.a.createElement(ut.a,{indicator:q.a.createElement(dt.a,{type:"loading",style:{fontSize:16},spin:!0})}):null),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"动画时间"},q.a.createElement(Ee.a,{size:"small",step:.01,min:.01,max:1/0,value:U.i.toFixed(O,2),onChange:function(t){return e.setAnimate(t,"time")}}))),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"动画间隔"},q.a.createElement(Ee.a,{size:"small",step:.01,min:.01,max:1/0,value:U.i.toFixed(N,2),onChange:function(t){return e.setAnimate(t,"interval")}}))),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"延迟时间"},q.a.createElement(Ee.a,{size:"small",step:.1,min:0,max:1/0,value:U.i.toFixed(C,1),onChange:function(t){return e.setAnimate(t,"delay")}}))),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"缓动效果"},q.a.createElement(gt.a,{onChange:function(t){return e.setAnimate(t,"fun")},size:"small",style:{width:"100%"},value:j||"ease"},q.a.createElement(t,{value:"ease"},"默认"),q.a.createElement(t,{value:"linear"},"匀速"),q.a.createElement(t,{value:"ease-in"},"加速"),q.a.createElement(t,{value:"ease-out"},"减速"),q.a.createElement(t,{value:"ease-in-out"},"起始慢"),q.a.createElement(t,{value:"cubic-bezier(0.68, -0.55, 0.27, 1.55)"},"回弹"))))):null)}}]),t}(G.Component),H()(Ke.prototype,"renderLayerAsyncFlase",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"renderLayerAsyncFlase"),Ke.prototype),H()(Ke.prototype,"calibration",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"calibration"),Ke.prototype),H()(Ke.prototype,"setClassName",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"setClassName"),Ke.prototype),H()(Ke.prototype,"fontWeight",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"fontWeight"),Ke.prototype),H()(Ke.prototype,"fontStyle",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"fontStyle"),Ke.prototype),H()(Ke.prototype,"fontDecoration",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"fontDecoration"),Ke.prototype),H()(Ke.prototype,"textAlign",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"textAlign"),Ke.prototype),H()(Ke.prototype,"setFontSize",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"setFontSize"),Ke.prototype),H()(Ke.prototype,"setFontColor",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"setFontColor"),Ke.prototype),H()(Ke.prototype,"changeFontSpace",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"changeFontSpace"),Ke.prototype),H()(Ke.prototype,"changeFontLineHeight",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"changeFontLineHeight"),Ke.prototype),H()(Ke.prototype,"selectAnimate",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"selectAnimate"),Ke.prototype),H()(Ke.prototype,"loadFontFamily",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"loadFontFamily"),Ke.prototype),H()(Ke.prototype,"setAnimate",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"setAnimate"),Ke.prototype),H()(Ke.prototype,"onSwitchAnimate",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"onSwitchAnimate"),Ke.prototype),H()(Ke.prototype,"onSwitchArtWord",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"onSwitchArtWord"),Ke.prototype),H()(Ke.prototype,"selectArtWord",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"selectArtWord"),Ke.prototype),H()(Ke.prototype,"onChangeArtWordSize",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"onChangeArtWordSize"),Ke.prototype),H()(Ke.prototype,"setArtWordColor",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"setArtWordColor"),Ke.prototype),H()(Ke.prototype,"loadFontSource",[U.c],Object.getOwnPropertyDescriptor(Ke.prototype,"loadFontSource"),Ke.prototype),Ke),jt=(Qe=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={keys:U.i.randomID()},a}return v()(t,e),h()(t,[{key:"selectText",value:function(e){if(document.body.createTextRange){var t=document.body.createTextRange();t.moveToElementText(e),t.select()}else if(window.getSelection){var a=window.getSelection(),n=document.createRange();if(!n)return!1;n.selectNodeContents(e),a.removeAllRanges(),a.addRange(n)}else console.error("selectText none")}},{key:"dbclickEvent",value:function(){var e=this;$("#h5dsCanvas").on("dblclick.texteditor",".h5ds-control",function(t){var a=e.props,n=a.h5ds,o=a.layer;e.$layer=n.getLayerDom(),e.control=$(t.target),e.control.css("z-index","-1"),e.editAuto=e.$layer.find(".layer-h5ds_text-auto"),e.editAuto.html(o.data.data),e.editAuto.attr("contenteditable","true"),e.selectText(e.editAuto[0]),e.editAuto.off("blur").on("blur",function(t){t.stopPropagation(),Object(Y.transaction)(function(){var t=e.editAuto.html();e.props.layer.style.height=e.editAuto.height(),e.props.layer.data.data=t,e.props.layer.data.keyid=U.i.randomID(),e.props.h5ds.edata.keys=U.i.randomID(),$(".h5ds-ex-h5ds_text-richtext")[0]&&$(".h5ds-ex-h5ds_text-richtext").html(t),U.e.publish("h5ds.setHistory")})}),e.editAuto.off("paste").on("paste",function(e){e.preventDefault();var t=e.originalEvent.clipboardData.getData("text/plain");document.execCommand("insertText",!1,t)})})}},{key:"scaleEvent",value:function(){var e=this,t=this.props,a=t.h5ds,n=t.layer;this.$layer=a.getLayerDom(),this.$layer.on("controlStart.h5ds.text",function(t,a){e.startHeight=a?a.height:null,e.fontSize=parseInt(n.data.style.fontSize,10),e.layerBox=e.$layer.find(".layer-h5ds_text-auto")}),this.$layer.on("controlResizeTick.h5ds.text",function(t,a){if(e.moveHeight=a?a.height:null,e.startHeight&&e.moveHeight){var n=e.startHeight/e.moveHeight,o=e.fontSize/n;e.layerBox.css("font-size",(o<12?12:o)+"px")}}),this.$layer.on("controlEnd.h5ds.text",function(t,a){if(a){e.endHeight=a?a.height:null;var o=e.startHeight/e.endHeight,r=e.fontSize/o;r=parseInt(r<12?12:r,10)+"px",n.data.style.fontSize=r,setTimeout(function(){e.editAuto=e.$layer.find(".layer-h5ds_text-auto"),e.editAuto&&(n.style.height=e.editAuto.height(),U.e.publish("h5ds.setHistory"),e.setState({keys:U.i.randomID()}))}),e.editorSetRef.setFontSize(r)}})}},{key:"componentDidMount",value:function(){this.dbclickEvent(),this.scaleEvent()}},{key:"componentWillUnmount",value:function(){$("#h5dsCanvas").off("dblclick.texteditor"),this.layerBox=null,this.editAuto&&(this.editAuto.removeAttr("contenteditable"),this.editAuto.off("blur"),this.editAuto.off("paste"),this.editAuto.off("input"),this.editAuto=null),this.control&&(this.control.removeAttr("style"),this.control=null),this.$layer&&(this.$layer.off("controlStart.h5ds.text"),this.$layer.off("controlResizeTick.h5ds.text"),this.$layer.off("controlEnd.h5ds.text"),this.$layer=null)}},{key:"render",value:function(){var e=this,t=this.state.keys;return q.a.createElement("div",{className:"h5ds-ex-h5ds_text"},q.a.createElement(Pt,{ref:function(t){return e.editorSetRef=t},h5ds:this.props.h5ds,keyid:t,app:this.props.app,layer:this.props.layer}))}}]),t}(G.Component),H()(Qe.prototype,"dbclickEvent",[U.c],Object.getOwnPropertyDescriptor(Qe.prototype,"dbclickEvent"),Qe.prototype),H()(Qe.prototype,"scaleEvent",[U.c],Object.getOwnPropertyDescriptor(Qe.prototype,"scaleEvent"),Qe.prototype),Qe),Lt=function(){function e(){p()(this,e),this.id=null,this.className=null,this.animate=[],this.data={data:"请输入文本内容",fontFamilySet:{name:"默认字体",url:""},style:{letterSpacing:"normal",color:"rgba(0,0,0,1)",textDecoration:"normal",textAlign:"left",fontFamily:"默认字体",fontSize:"18px"},artword:{type:"",name:"",colors:[]},animate:""},this.style={width:132,height:this.setLineHeight(),top:0,left:0},this.estyle={},this.events=[]}return h()(e,[{key:"setLineHeight",value:function(){var e=parseInt(this.data.style.fontSize,10);return e/2+e}}]),e}(),It=q.a.createElement("i",{className:"h5ds-ico h5ds-ico-wenben"}),At=a(44),Tt=a(13),zt=a(9),_t=a(35),$t=(a(119),function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=1<arguments.length?arguments[1]:void 0,n=2<arguments.length?arguments[2]:void 0;p()(this,e),this.set=Object.assign({gap:5},t),this.$lines=a||$(".h5ds-adsorb-line"),this.$outbox=n||$("#h5dsCanvasApp"),this.lines={xt:this.$lines.eq(0),xc:this.$lines.eq(1),xb:this.$lines.eq(2),yl:this.$lines.eq(3),yc:this.$lines.eq(4),yr:this.$lines.eq(5)},this.scale=parseFloat($(".h5ds-canvas-box").transform("scale"))||1,this.canvasRect=this.$outbox[0].getBoundingClientRect()}return h()(e,[{key:"correct",value:function(e){var t=this,a=[];return e.each(function(e,n){var o=$(n).transform("rotate"),r=$(n).find(".h5ds-adsorb-layer-item");if(o&&!r[0]){var s=n.getBoundingClientRect(),i=s.top,c=s.left,l=s.right,p=s.bottom,u=s.width,h=s.height;$(n).append('<div class="h5ds-adsorb-layer-item" style="\n        left: '.concat(-(l-c-n.offsetWidth)/2,"px;\n        top: ").concat(-(p-i-n.offsetHeight)/2,"px;\n        width: ").concat(u,"px;\n        height: ").concat(h,"px;\n        transform: rotate(-").concat(o,"deg) scale(").concat(1/t.scale,');\n        "></div>')),a.push($(n).find(".h5ds-adsorb-layer-item")[0])}else r[0]?a.push(r[0]):($(n).append('<div class="h5ds-default-layer-item" style="\n        width: '.concat(n.offsetWidth,"px;\n        height: ").concat(n.offsetHeight,'px;"></div>')),a.push(n))}),a}},{key:"clear",value:function(){$(".h5ds-adsorb-layer-item").remove(),$(".h5ds-default-layer-item").remove()}},{key:"check",value:function(e,t){var a=this,n=e[0].getBoundingClientRect();this.uncheck(),t.forEach(function(t){t.classList.remove("h5ds-adsorb-line-active");var o=a.canvasRect;if(t!==e[0]){var r=e.find(".h5ds-adsorb-layer-item");if(!r[0]||t!==r[0]){var s=t.getBoundingClientRect(),i=s.top,c=s.height,l=s.bottom,p=s.left,u=s.width,h=s.right,d=n.width/2,m=u/2,y=n.height/2,f=c/2,g={top:[{type:"xt-top",isNearly:a._isNearly(n.top,i),lineNode:a.lines.xt,lineValue:i,dragValue:i-o.top},{type:"xt-bottom",isNearly:a._isNearly(n.bottom,i),lineNode:a.lines.xt,lineValue:i,dragValue:i-n.height-o.top},{type:"xc",isNearly:a._isNearly(n.top+y,i+f),lineNode:a.lines.xc,lineValue:i+f,dragValue:i+f-y-o.top},{type:"xb-top",isNearly:a._isNearly(n.bottom,l),lineNode:a.lines.xb,lineValue:l,dragValue:l-n.height-(o.bottom-o.height)},{type:"xb-bottom",isNearly:a._isNearly(n.top,l),lineNode:a.lines.xb,lineValue:l,dragValue:l-o.top}],left:[{type:"yl-left",isNearly:a._isNearly(n.left,p),lineNode:a.lines.yl,lineValue:p,dragValue:p-o.left},{type:"yl-right",isNearly:a._isNearly(n.right,p),lineNode:a.lines.yl,lineValue:p,dragValue:p-n.width-o.left},{type:"yc",isNearly:a._isNearly(n.left+d,p+m),lineNode:a.lines.yc,lineValue:p+m,dragValue:p+m-d-o.left},{type:"yr-left",isNearly:a._isNearly(n.right,h),lineNode:a.lines.yr,lineValue:h,dragValue:h-n.width-(o.right-o.width)},{type:"yr-right",isNearly:a._isNearly(n.left,h),lineNode:a.lines.yr,lineValue:h,dragValue:h-(o.right-o.width)}]},v=function(n){g[n].forEach(function(o){if(o.isNearly){if(t.classList.add("h5ds-adsorb-line-active"),e.find(".h5ds-adsorb-layer-item")[0]){var r;r="left"===n?(e.find(".h5ds-adsorb-layer-item").width()-e.width()*a.scale)/2:(e.find(".h5ds-adsorb-layer-item").height()-e.height()*a.scale)/2,e.css(n,"".concat((o.dragValue+r)/a.scale,"px"))}else e.css(n,"".concat(o.dragValue/a.scale,"px"));o.lineNode.css(n,"".concat(o.lineValue,"px")),o.lineNode.show()}})};for(var b in g)v(b)}}})}},{key:"uncheck",value:function(){this.$lines.hide(),$(".h5ds-adsorb-line-active").removeClass("h5ds-adsorb-line-active")}},{key:"_isNearly",value:function(e,t){return Math.abs(e-t)<=this.set.gap}}]),e}()),Wt=Object(zt.inject)("h5ds")(Ze=Object(zt.observer)(Ze=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={lines:{xt:null,xc:null,xb:null,yl:null,yc:null,yr:null}},a}return v()(t,e),h()(t,[{key:"componentDidMount",value:function(){var e=this;U.e.subscribe("h5ds.control.absorb.start",function(){e.adsorb=new $t,e.layersTarget=e.props.h5ds.getPageLayerDom(),e.layersTarget=e.adsorb.correct(e.layersTarget),e.layersTarget=[].concat(_()(e.layersTarget),[$("#h5dsCanvasApp")[0]],_()($(".h5ds-ruler-guides"))),e.thisTarget=e.props.h5ds.getLayerDom()}),U.e.subscribe("h5ds.control.absorb.move",function(){e.adsorb.check(e.thisTarget,e.layersTarget)}),U.e.subscribe("h5ds.control.absorb.end",function(){e.adsorb.uncheck(),e.adsorb.clear()})}},{key:"componentWillUnmount",value:function(){U.e.unsubscribe("h5ds.control.absorb.start"),U.e.unsubscribe("h5ds.control.absorb.move"),U.e.unsubscribe("h5ds.control.absorb.end")}},{key:"render",value:function(){var e=this.state.lines;return q.a.createElement("div",{className:"h5ds-adsorb-lines"},Object.keys(e).map(function(e,t){var a;return a="x"===e[0]?{width:"100%",height:1,left:0}:{width:1,height:"100%",top:0},q.a.createElement("div",{className:"h5ds-adsorb-line",key:t,style:a})}))}}]),t}(G.Component))||Ze)||Ze,Ht=(a(52),a(26)),Rt=a.n(Ht),Mt=(a(120),Object(zt.inject)("h5ds")(et=Object(zt.observer)((tt=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"setAnimate",value:function(e){e.delay=U.i.toFixed(e.delay,1),e.time=U.i.toFixed(e.time,1),U.e.publish("h5ds.animateList.add",e)}},{key:"closeList",value:function(){this.props.h5ds.edata.animateListShow=!1}},{key:"render",value:function(){var e=this,t=Rt.a.TabPane,a=this.props.h5ds.edata.animateListShow,n=window.innerHeight-150,o=["h5ds-animatelist"];return a&&o.push("h5ds-animatelist-show"),q.a.createElement("div",{className:o.join(" ")},q.a.createElement("a",{onClick:this.closeList,className:"h5ds-basic-animatelist-close"},q.a.createElement(dt.a,{type:"right",theme:"outlined"})),q.a.createElement(Rt.a,{size:"small",defaultActiveKey:"1"},q.a.createElement(t,{tab:"进入",key:"1"},q.a.createElement("ul",{style:{height:n},className:"h5ds-basic-animatelist-ul clearfix"},Tt.c.map(function(t,a){return q.a.createElement("li",{onClick:function(){return e.setAnimate(t)},key:a},t.name)}))),q.a.createElement(t,{tab:"离开",key:"2"},q.a.createElement("ul",{style:{height:n},className:"h5ds-basic-animatelist-ul clearfix"},Tt.d.map(function(t,a){return q.a.createElement("li",{onClick:function(){return e.setAnimate(t)},key:a},t.name)}))),q.a.createElement(t,{tab:"强调",key:"3"},q.a.createElement("ul",{style:{height:n},className:"h5ds-basic-animatelist-ul clearfix"},Tt.b.map(function(t,a){return q.a.createElement("li",{onClick:function(){return e.setAnimate(t)},key:a},t.name)})))))}}]),t}(G.Component),H()(tt.prototype,"setAnimate",[U.c],Object.getOwnPropertyDescriptor(tt.prototype,"setAnimate"),tt.prototype),H()(tt.prototype,"closeList",[U.c],Object.getOwnPropertyDescriptor(tt.prototype,"closeList"),tt.prototype),et=tt))||et)||et),Bt=(a(121),a(122),Object(zt.inject)("h5ds")(at=Object(zt.observer)((nt=function(e){function t(e){return p()(this,t),m()(this,f()(t).call(this,e))}return v()(t,e),h()(t,[{key:"setPageHei",value:function(e){e.stopPropagation();var t=this.props.h5ds,a=t.edata,n=(0,t.getPage)();n.style.height||(n.style.height=Tt.e.appHeight);var o=e.pageY,r=n.style.height,s=a.phoneScale,i=$(".h5ds-js-setsize"),c=$(".h5ds-js-setpage-height"),l="phone"===Tt.e.type?Tt.e.appHeight:0;$(document).on("mousemove.h5ds.setPageHei",function(e){(r=parseInt(n.style.height+(e.pageY-o)/s,10))<l&&(r=l),i.height(r),c.html(r)}).on("mouseup.h5ds.setPageHei",function(){Object(Y.transaction)(function(){n.style.height=r,a.pageSize.height=n.style.height,a.keys=U.i.randomID(),U.e.publish("h5ds.setHistory"),$(document).off("mousemove.h5ds.setPageHei mouseup.h5ds.setPageHei")})})}},{key:"render",value:function(){var e=this.props.height,t=this.props.h5ds.edata;return q.a.createElement("div",{className:"h5ds-setpage-height"},q.a.createElement("span",{key:e,className:"h5ds-setpage-px"},q.a.createElement("span",{className:"h5ds-js-setpage-height"},e),"px [缩放：",t.phoneScale,"]"),q.a.createElement("a",{onMouseDown:this.setPageHei,className:"h5ds-js-setpage h5ds-setpage-height-btn"},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-shangxiawen"})))}}]),t}(G.Component),H()(nt.prototype,"setPageHei",[U.c],Object.getOwnPropertyDescriptor(nt.prototype,"setPageHei"),nt.prototype),at=nt))||at)||at),Ft=Object(zt.inject)("h5ds")(ot=Object(zt.observer)((rt=function(e){function t(e){return p()(this,t),m()(this,f()(t).call(this,e))}return v()(t,e),h()(t,[{key:"setPageWidth",value:function(e){e.stopPropagation();var t=this.props.h5ds,a=t.edata,n=(0,t.getPage)();n.style.width||(n.style.width=Tt.e.appWidth);var o=e.pageX,r=n.style.width,s=n.style.width,i=a.phoneScale||1,c=$(".h5ds-js-setsize"),l=$(".h5ds-js-setpage-width"),p="phone"===Tt.e.type?Tt.e.appWidth:0;$(document).on("mousemove.h5ds.setPageWidth",function(e){(s=parseInt(r+(e.pageX-o)/i,10))<p&&(s=p),c.css({width:s}),l.html(s+"px")}).on("mouseup.h5ds.setPageWidth",function(){Object(Y.transaction)(function(){n.style.width=s,a.pageSize.width=s,a.keys=U.i.randomID(),U.e.publish("h5ds.setHistory"),$(document).off("mousemove.h5ds.setPageWidth mouseup.h5ds.setPageWidth")})})}},{key:"componentDidMount",value:function(){$(this.btn).on("mousedown",this.setPageWidth)}},{key:"componentWillUnmount",value:function(){$(this.btn).off("mousedown")}},{key:"render",value:function(){var e=this,t=this.props.width;return q.a.createElement("div",{className:"h5ds-setpage-width"},q.a.createElement("span",{key:t,className:"h5ds-setpage-px h5ds-js-setpage-width"},t,"px"),q.a.createElement("a",{ref:function(t){return e.btn=t},className:"h5ds-js-setpage h5ds-setpage-width-btn"},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-shangxiawen"})))}}]),t}(G.Component),H()(rt.prototype,"setPageWidth",[U.c],Object.getOwnPropertyDescriptor(rt.prototype,"setPageWidth"),rt.prototype),ot=rt))||ot)||ot,Gt=a(20);function qt(e,t){var a=e();a.find(".h5ds-control").remove(),t.forEach(function(e){var t=a.children().children(".layer").eq(e);t.find(".h5ds-control")[0]||t.append('<div class="h5ds-control">\n    <span class="h5ds-control-top"></span>\n    <span class="h5ds-control-left"></span>\n    <span class="h5ds-control-right"></span>\n    <span class="h5ds-control-bottom"></span>\n    <span class="h5ds-control-topleft"></span>\n    <span class="h5ds-control-topright"></span>\n    <span class="h5ds-control-bottomleft"></span>\n    <span class="h5ds-control-bottomright"></span>\n    <span class="h5ds-control-center"></span>\n</div>')})}function Ut(e,t,a){$("#h5dsCanvas").off("mousedown.h5ds.group").on("mousedown.h5ds.group",".h5ds-control",function(n){if(a.selectGroup){n.stopPropagation();var o={},r=e();a.selectGroup.forEach(function(e){o[e]={x:parseInt(r[e].style.left,10),y:parseInt(r[e].style.top,10)}});var s=t();$(document).on("mousemove.h5ds.group",function(e){e.stopPropagation();var t=e.pageX-n.pageX,r=e.pageY-n.pageY;a.selectGroup.forEach(function(e){s.eq(e).css({left:o[e].x+t/a.phoneScale,top:o[e].y+r/a.phoneScale})})}).on("mouseup.h5ds.group",function(e){var t=e.pageX-n.pageX,s=e.pageY-n.pageY;Object(Y.transaction)(function(){a.selectGroup.forEach(function(e){r[e]&&(r[e].style.left=o[e].x+t/a.phoneScale,r[e].style.top=o[e].y+s/a.phoneScale)})}),$(document).off("mousemove.h5ds.group mouseup.h5ds.group"),U.e.publish("h5ds.setHistory")})}})}var Yt,Vt,Jt=Object(zt.inject)("h5ds","scope")(st=Object(zt.observer)((it=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).layer=e.h5ds.getLayer(),a}return v()(t,e),h()(t,[{key:"initControlCallback",value:function(){var e=this,t=this.props.h5ds;this.$nowlayer=t.getLayerDom();var a=t.getPageDom().find(".h5ds-control");if(a[0]&&(a.remove(),a=null),this.$nowlayer)if(this.$nowlayer[0]){this.layer=t.getLayer();var n=this.props.scope.pluginsKey[this.layer.pid];if(n){var o=n.editorSet||{};this.$nowlayer.control({setHeight:!1!==o.height,setWidth:!1!==o.width,movex:!1!==o.x,movey:!1!==o.y,rotate:!1!==o.rotate,autosize:!0,fixedsize:!0}),this.$nowlayer.off("controlStart.h5ds.canvas").on("controlStart.h5ds.canvas",function(t,a){if(!a)return!1;e.$elementInner||(e.$elementInner=e.$nowlayer.children(".element").children(".element-flip").children());var n=e.$elementInner.width(),o=e.$elementInner.height();e.startWidth=e.$nowlayer.width(),e.startHeight=e.$nowlayer.height(),e.startScale=[e.startWidth/n,e.startHeight/o]}),this.$nowlayer.off("controlResizeTick.h5ds.canvas").on("controlResizeTick.h5ds.canvas",function(t,a){if(!a)return!1;["h5ds_img","h5ds_combin"].includes(e.layer.pid)&&e.$elementInner.css({transform:"scale(".concat(a.width/e.startWidth*e.startScale[0],", ").concat(a.height/e.startHeight*e.startScale[1],")")})}),this.$nowlayer.off("change.h5ds.canvas").on("change.h5ds.canvas",function(t,a){if(e.tickData&&(e.tickData=null),e.$elementInner&&(e.$elementInner=null),!a)return!1;Object(Y.transaction)(function(){if(!e.layer)return null;for(var t in a)switch(t){case"left":e.layer.style.left=a[t];break;case"top":e.layer.style.top=a[t];break;case"width":e.layer.style.width=a[t];break;case"height":e.layer.style.height=a[t];break;case"transform":e.layer.style.transform=a.transform}e.props.h5ds.edata.keys=U.i.randomID()}),U.e.publish("h5ds.setHistory")})}else console.error("插件异常",this.layer.pid)}else console.warn("未选择layer");else console.warn("未选择layer")}},{key:"initGroupEvent",value:function(){!function(e,t){var a=e.edata;$("#h5dsCanvas").off("mousedown.h5ds.layerGroup").on("mousedown.h5ds.layerGroup",function(n){if(!($(n.target).closest(".h5ds-ruler")[0]||$(n.target).closest(".h5ds-canvas-navigator")[0]||$(n.target).closest(".h5ds-js-setpage")[0]||a.selectGroup||null!==a.selectLayer)){var o=[];e.getPageDom().children().children(".layer").each(function(){var e=$(this),t={left:e.offset().left,top:e.offset().top,width:e.width(),height:e.height(),dom:e};t.center={x:t.left+t.width/2,y:t.top+t.height/2},e.hasClass("layer-temporary-lock")||e.closest(".layer-combinbox")[0]||o.push(t)}),$(".layer-group-select")[0]||$("body").append('<div class="layer-group-select"></div>');var r,s,i,c,l=$(".layer-group-select");$(document).on("mousemove.h5ds.layerGroup",function(e){r=Math.abs(e.pageX-n.pageX),s=Math.abs(e.pageY-n.pageY),c=e.pageX>n.pageX?n.pageX:e.pageX,i=e.pageY>n.pageY?n.pageY:e.pageY,l.css({top:i,left:c,width:r,height:s,display:r+s===0?"none":"block"}),o.forEach(function(e){var t=e.center,a=t.x,n=t.y;c<a&&a<c+r&&i<n&&n<i+s?e.dom.find(".h5ds-control")[0]||e.dom.append('<div class="h5ds-control">\n                    <span class="h5ds-control-top"></span>\n                    <span class="h5ds-control-left"></span>\n                    <span class="h5ds-control-right"></span>\n                    <span class="h5ds-control-bottom"></span>\n                    <span class="h5ds-control-topleft"></span>\n                    <span class="h5ds-control-topright"></span>\n                    <span class="h5ds-control-bottomleft"></span>\n                    <span class="h5ds-control-bottomright"></span>\n                    <span class="h5ds-control-center"></span>\n                </div>'):e.dom.find(".h5ds-control").remove()})}).on("mouseup.h5ds.layerGroup",function(){var a=e.getPageDom().find(".h5ds-control");1<a.length?t(function(t){var a=[];return e.getPageDom().find(".h5ds-control").each(function(){var e=$(this).closest(".layer");a.push(e.index())}),a}()):1===a.length&&a.closest(".layer").trigger("click"),o=null,$(document).off("mousemove.h5ds.layerGroup"),$(document).off("mouseup.h5ds.layerGroup"),l.remove()})}})}(this.props.h5ds,function(e){Object(Y.transaction)(function(){t.selectGroup=e,t.setType="group"})});var e=this.props.h5ds,t=e.edata,a=e.getPageLayerDom;Ut(e.getLayers,a,t)}},{key:"initControlEvent",value:function(){var e=this;$(document).on("mousedown.h5ds.destoryControl",function(e){!$(e.target).closest(".layer")[0]&&$(e.target).closest("#h5dsCanvas")[0]&&U.e.publish("h5ds.destoryControl")}),U.e.subscribe("h5ds.destoryControl",function(t,a){console.log("销毁控制器的事件",a);var n=e.props.h5ds.edata,o=n.selectType,r=n.pageNum,s=$("#h5dsCanvasApp").find(".h5ds-control");s[0]&&(s.remove(),s=null),Object(Y.transaction)(function(){n.setType="page",n.selectGroup=!1,n.selectLayer=null,a&&(r=a.pageNum,o=a.selectType),U.i.isEmpty(r)||e.props.h5ds.setPage(r,o)})}),U.e.subscribe("h5ds.initControl",function(){e.initControlCallback()})}},{key:"initLayerControl",value:function(e,t){t.stopPropagation(),t.nativeEvent.stopImmediatePropagation();var a=this.props.h5ds;t&&t.ctrlKey?Object(Y.transaction)(function(){a.edata.selectGroup||(a.edata.selectGroup=[],a.getPageDom().find(".h5ds-control")[0]&&a.edata.selectGroup.push(a.edata.selectLayer)),-1===a.edata.selectGroup.indexOf(e)?a.edata.selectGroup.push(e):a.edata.selectGroup.splice(a.edata.selectGroup.findIndex(function(t){return t===e}),1),a.edata.selectGroup=_()(new Set(a.edata.selectGroup)),1<a.edata.selectGroup.length&&(a.edata.selectLayer=null,a.edata.setType="group"),qt(a.getPageDom,a.edata.selectGroup),Ut(a.getLayers,a.getPageLayerDom,a.edata)}):a.edata.selectGroup&&U.i.isEmpty(a.edata.selectLayer)&&$(t.currentTarget).find(".h5ds-control")[0]||e!==a.edata.selectLayer&&(a.edata.selectGroup=null,a.setLayer(e))}},{key:"setPageStyle",value:function(e){var t=this.props.h5ds.edata,a=t.selectType,n=t.selectFixed,o={},r=this.props.h5ds.getPage();if(r){switch(a){case"popups":"popups"===e?o.display="block":o.pointerEvents="none";break;case"fixeds":"popups"===e&&(o.display="none"),e+n==="fixedUp0"||e+n==="fixedDown1"?(o.width="100%",o.height="100%"):o.pointerEvents="none";break;case"pages":"popups"===e?o.display="none":"pages"===e||(o.pointerEvents="none")}return Object.assign(o,r.style||{})}console.warn("未找到page")}},{key:"componentDidMount",value:function(){this.initControlEvent(),this.initGroupEvent()}},{key:"componentWillUnmount",value:function(){U.e.unsubscribe("h5ds.initControl"),U.e.unsubscribe("h5ds.destoryControl"),$(document).off("mousedown.h5ds.destoryControl"),$("#h5dsCanvas").off("mousedown.h5ds.group"),$("#h5dsCanvas").off("mousedown.h5ds.layerGroup"),this.$nowlayer&&this.$nowlayer.off("change.h5ds.canvas controlResizeTick.h5ds.canvas controlStart.h5ds.canvas")}},{key:"render",value:function(){console.log("render canvas viewwwwwwwww>>>>>>>>>>>");var e=this.props.h5ds,t=e.edata,a=e.getPage,n=e.renderPageList,o=this.props,r=o.plugins,s=o.pageData;return n(),t.keys,q.a.createElement("div",{className:"h5ds-pages-app",key:t.canvasAnimate},"popups"===t.selectType&&q.a.createElement("div",{className:"h5ds-fixed-view h5ds-js-setsize",id:"h5dsPageViewPopup",style:E()({},this.setPageStyle("popups"))},q.a.createElement(Gt.d,{initControl:this.initLayerControl,plugins:r,isRenderThis:!0,data:a("popups"),renderIn:Tt.g.RENDER_IN_CANVAS})),q.a.createElement("div",{className:"h5ds-fixed-view h5ds-js-setsize",id:"h5dsPageViewFixedUp",style:E()({},this.setPageStyle("fixedUp"))},q.a.createElement(Gt.a,{initControl:this.initLayerControl,plugins:r,isRenderThis:!0,data:a("fixeds",0),renderIn:Tt.g.RENDER_IN_CANVAS})),q.a.createElement("div",{className:"h5ds-fixed-view h5ds-js-setsize",id:"h5dsPageViewFixedDown",style:E()({},this.setPageStyle("fixedDown"))},q.a.createElement(Gt.a,{initControl:this.initLayerControl,plugins:r,isRenderThis:!0,data:a("fixeds",1),renderIn:Tt.g.RENDER_IN_CANVAS})),q.a.createElement("div",{className:"h5ds-page-view h5ds-js-setsize",id:"h5dsPageView",style:E()({},this.setPageStyle("pages"))},s&&"popups"!==t.selectType&&q.a.createElement(Gt.c,{isRenderThis:!0,initControl:this.initLayerControl,plugins:r,data:s,renderIn:Tt.g.RENDER_IN_CANVAS})))}}]),t}(G.Component),H()(it.prototype,"initControlCallback",[U.c],Object.getOwnPropertyDescriptor(it.prototype,"initControlCallback"),it.prototype),H()(it.prototype,"initGroupEvent",[U.c],Object.getOwnPropertyDescriptor(it.prototype,"initGroupEvent"),it.prototype),H()(it.prototype,"initControlEvent",[U.c],Object.getOwnPropertyDescriptor(it.prototype,"initControlEvent"),it.prototype),H()(it.prototype,"initLayerControl",[U.c],Object.getOwnPropertyDescriptor(it.prototype,"initLayerControl"),it.prototype),H()(it.prototype,"setPageStyle",[U.c],Object.getOwnPropertyDescriptor(it.prototype,"setPageStyle"),it.prototype),st=it))||st)||st,Xt=(a(123),Object(zt.inject)("h5ds")(Yt=Object(zt.observer)(Yt=function(e){function t(){var e,a;p()(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=m()(this,(e=f()(t)).call.apply(e,[this].concat(o)))).state={show:!1},a}return v()(t,e),h()(t,[{key:"componentDidMount",value:function(){var e=this;U.e.subscribe("h5ds.show.grid",function(){e.setState({show:!e.state.show})})}},{key:"componentWillUnmount",value:function(){U.e.unsubscribe("h5ds.show.grid")}},{key:"render",value:function(){var e=this.state.show,t=this.props,a=t.width,n=t.height,o=this.props.h5ds.edata,r=o.gridSize,s=o.gridAdsorb,i=["h5ds-grid","h5ds-js-grid"];return e&&i.push("h5ds-grid-show"),q.a.createElement("div",{className:i.join(" "),"data-adsorb":s,"data-size":r},q.a.createElement("ul",{className:"h5ds-grid-row"},Array(Math.ceil(parseInt(n,10)/r)).fill(1).map(function(e,t){return q.a.createElement("li",{key:t,style:{top:r*t}})})),q.a.createElement("ul",{className:"h5ds-grid-col"},Array(Math.ceil(parseInt(a,10)/r)).fill(1).map(function(e,t){return q.a.createElement("li",{key:t,style:{left:r*t}})})))}}]),t}(G.Component))||Yt)||Yt);function Kt(e,t){var a,n;return t<e?n=t/(e/(a=180)):a=e/(t/(n=180)),{width:a,height:n}}function Qt(e,t){var a=e.width,n=e.height,o=(e.top,e.left,null);if(t.width/t.height>a/n){var r=t.height,s=n/r;o={height:r,width:a/s,top:0,left:(t.width-a/s)/2}}else{var i=t.width,c=a/i;o={width:i,height:n/c,top:(t.height-n/c)/2,left:0}}return o}function Zt(e,t){var a=e.canvasWidth,n=e.canvasHeight,o=e.page,r=(a-o.width)/2,s=(n-o.height)/2,i=o.width/t.width;return{width:a/i,height:n/i,top:t.top-s/i,left:t.left-r/i}}a(124);var ea,ta,aa,na,oa,ra,sa,ia,ca,la,pa,ua,ha,da,ma,ya,fa,ga,va,ba,wa,ka,Ea,xa,Oa,Sa,Ca,Da,Na,Pa,ja,La,Ia,Aa,Ta,za,_a,$a,Wa,Ha,Ra,Ma,Ba,Fa,Ga,qa,Ua,Ya,Va,Ja,Xa,Ka,Qa,Za,en,tn,an,nn,on,rn,sn,cn,ln,pn,un,hn,dn,mn,yn,fn,gn,vn,bn,wn,kn,En,xn,On,Sn,Cn,Dn,Nn,Pn,jn,Ln,In,An,Tn,zn,_n,$n,Wn,Hn,Rn,Mn,Bn,Fn,Gn,qn,Un,Yn,Vn,Jn,Xn,Kn,Qn,Zn,eo,to,ao,no,oo,ro,so,io,co,lo,po,uo,ho,mo,yo,fo,go,vo,bo,wo,ko,Eo,xo,Oo,So=(Vt=function(e){function t(e){var a;p()(this,t),a=m()(this,f()(t).call(this,e));var n=Kt(e.canvasWidth,e.canvasHeight),o=n.width,r=n.height,s=Qt(e.page,{width:o,height:r}),i=e.page.height/s.height;return a.state={boxStyle:{width:o,height:r},pageStyle:s,controlStyle:Zt(E()({},e),s),propsData:JSON.stringify(e),scale:i,open:!0},a}return v()(t,e),h()(t,[{key:"limitSize",value:function(e,t,a){var n=a.top,o=a.left,r=a.width,s=a.height,i=this.state,c=i.boxStyle,l=i.controlStyle,p=i.pageStyle;return e+o<-20&&(e=-20-o),e+o+r>c.width+20&&(e=c.width+20-o-r),t+n<-20&&(t=-20-n),t+n+s>c.height+20&&(t=c.height+20-n-s),l.width>p.width&&(e=0),l.height>p.height&&(t=0),{x:e,y:t}}},{key:"onMouseDown",value:function(e){var t=this;e.stopPropagation();var a=e.pageX,n=e.pageY,o=this.state.controlStyle,r=o.top,s=o.left,i=o.width,c=o.height,l=$(".h5ds-canvas-realsize"),p=l.position(),u=this.state.scale;$(document).on("mousemove.h5ds.navigator",function(e){var o=e.pageX-a,h=e.pageY-n,d=t.limitSize(o,h,{top:r,left:s,width:i,height:c}),m=d.x,y=d.y;t.setState({controlStyle:{top:y+r,left:m+s,width:i,height:c}});var f=-m*u+p.left,g=-y*u+p.top;l.css({left:f,top:g}),U.e.publish("h5ds.rulerline.position",{left:f,top:g})}).on("mouseup.h5ds.navigator",function(){$(document).off("mousemove.h5ds.navigator mouseup.h5ds.navigator")})}},{key:"changeNavigatorWindow",value:function(){this.setState({open:!this.state.open})}},{key:"componentDidMount",value:function(){var e=this;$(".h5ds-canvas-navigator").on("mousewheel.h5ds.navigator",function(e){e.stopPropagation(),0<e.originalEvent.deltaY?U.e.publish("h5ds.shortcuts_tomin"):U.e.publish("h5ds.shortcuts_tomax")}),$("#h5dsCanvas").on("mousewheel.h5ds.navigator",function(t){var a=e.state.controlStyle,n=a.top,o=a.left,r=a.width,s=a.height,i=$(".h5ds-canvas-realsize"),c=i.position(),l=e.state.scale,p=e.limitSize(0,t.originalEvent.deltaY/50,{top:n,left:o,width:r,height:s}).y;e.setState({controlStyle:{top:p+n,left:o,width:r,height:s}});var u=-p*l+c.top;i.css({top:u}),U.e.publish("h5ds.rulerline.position",{top:u})})}},{key:"componentWillUnmount",value:function(){$(".h5ds-canvas-navigator").off("mousewheel.h5ds.navigator"),$("#h5dsCanvas").off("mousewheel.h5ds.navigator")}},{key:"render",value:function(){var e=this.state,t=e.boxStyle,a=e.pageStyle,n=e.controlStyle,o=e.open,r=t;return o||(r={width:0,height:0}),q.a.createElement("div",{className:"h5ds-canvas-navigator-box",style:E()({},r)},q.a.createElement("div",{className:"h5ds-canvas-navigator",style:E()({},r)},q.a.createElement("div",{className:"h5ds-canvas-navigator-control",onMouseDown:this.onMouseDown,style:E()({},n)}),q.a.createElement("div",{className:"h5ds-canvas-navigator-page",style:E()({},a)})),q.a.createElement("a",{style:{transform:"rotate(".concat(o?-180:0,"deg)")},onClick:this.changeNavigatorWindow,className:"h5ds-canvas-navigator-btn"},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-shouqi"})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=E()({},t);if(JSON.stringify(e)!==t.propsData){var n=Kt(e.canvasWidth,e.canvasHeight),o=n.width,r=n.height,s=Qt(e.page,{width:o,height:r}),i=e.page.height/s.height;a.boxStyle={width:o,height:r},a.pageStyle=s,a.controlStyle=Zt(E()({},e),s),a.propsData=JSON.stringify(e),a.scale=i}return a}}]),t}(G.Component),H()(Vt.prototype,"limitSize",[U.c],Object.getOwnPropertyDescriptor(Vt.prototype,"limitSize"),Vt.prototype),H()(Vt.prototype,"onMouseDown",[U.c],Object.getOwnPropertyDescriptor(Vt.prototype,"onMouseDown"),Vt.prototype),H()(Vt.prototype,"changeNavigatorWindow",[U.c],Object.getOwnPropertyDescriptor(Vt.prototype,"changeNavigatorWindow"),Vt.prototype),Vt),Co=(a(125),ea=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={guides:[]},a}return v()(t,e),h()(t,[{key:"filterLine",value:function(){var e=this,t=[];this.state.guides.forEach(function(a){"col"===a.type?0<=a.style.left&&a.style.left<=e.props.canvasWidth&&t.push(a):0<=a.style.top&&a.style.top<=e.props.canvasHeight&&t.push(a)}),this.setState({guides:t})}},{key:"guidesMousedown",value:function(e,t){var a=this;e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var n=e.pageX,o=e.pageY,r=t.style.left,s=t.style.top,i=this.state.guides;$(document).on("mousemove.h5ds.ruler.line",function(e){"col"===t.type?t.style.left=e.pageX-n+r:t.style.top=e.pageY-o+s,a.setState({guides:i})}).on("mouseup.h5ds.rulerline",function(){if("row"===t.type){var e=$(".h5ds-canvas-realsize").position().left;t.value=(t.style.left-e)/a.props.phoneScale}else{var n=$(".h5ds-canvas-realsize").position().top;t.value=(t.style.top-n)/a.props.phoneScale}a.filterLine(),$(document).off("mousemove.h5ds.ruler.line mouseup.h5ds.ruler.line")})}},{key:"rowMousedown",value:function(e){var t=this;e.stopPropagation();var a={id:U.i.randomID(),type:"row",style:{left:0,top:0,height:1,width:$("#h5dsCanvas").width()}},n=this.state.guides;n.push(a);var o=e.pageY;$(document).on("mousemove.h5ds.ruler",function(e){a.style.top=e.pageY-o,t.setState({guides:n})}).on("mouseup.h5ds.ruler",function(){var e=$(".h5ds-canvas-realsize").position().top;a.value=(a.style.top-e)/t.props.phoneScale,t.filterLine(),$(document).off("mousemove.h5ds.ruler mouseup.h5ds.ruler")})}},{key:"colMousedown",value:function(e){var t=this;e.stopPropagation();var a={id:U.i.randomID(),type:"col",style:{left:0,top:0,width:1,height:2e3}},n=this.state.guides;n.push(a);var o=e.pageX,r=$(".h5ds-canvas-realsize").position().left;$(document).on("mousemove.h5ds.ruler",function(e){a.style.left=e.pageX-o,t.setState({guides:n})}).on("mouseup.h5ds.ruler",function(){a.value=(a.style.left-r)/t.props.phoneScale,t.filterLine(),$(document).off("mousemove.h5ds.ruler mouseup.h5ds.ruler")})}},{key:"componentDidMount",value:function(){var e=this;$(document).on("mousedown.h5ds.h5dsRulerCol","#h5dsRulerCol",this.colMousedown),$(document).on("mousedown.h5ds.h5dsRulerRow","#h5dsRulerRow",this.rowMousedown),U.e.subscribe("h5ds.ruler.drawline",function(t,a){if(e.data===JSON.stringify(a))return!1;e.data=JSON.stringify(a);var n=a.type,o=a.value,r=a.phoneScale,s=e.state.guides;s.forEach(function(e){"col"===n&&"row"===e.type?e.style.top=o+e.value*r:"row"===n&&"col"===e.type&&(e.style.left=o+e.value*r)}),e.setState({guides:s})})}},{key:"componentWillUnmount",value:function(){$(document).off("mousedown.h5ds.h5dsRulerCol mousedown.h5ds.h5dsRulerRow"),U.e.unsubscribe("h5ds.ruler.drawline")}},{key:"render",value:function(){var e=this;return q.a.createElement(q.a.Fragment,null,this.state.guides.map(function(t){return q.a.createElement("li",{onMouseDown:function(a){return e.guidesMousedown(a,t)},className:"h5ds-ruler-guides h5ds-ruler-guides-"+t.type,key:t.id,style:E()({},t.style)})}))}}]),t}(G.Component),H()(ea.prototype,"filterLine",[U.c],Object.getOwnPropertyDescriptor(ea.prototype,"filterLine"),ea.prototype),H()(ea.prototype,"guidesMousedown",[U.c],Object.getOwnPropertyDescriptor(ea.prototype,"guidesMousedown"),ea.prototype),H()(ea.prototype,"rowMousedown",[U.c],Object.getOwnPropertyDescriptor(ea.prototype,"rowMousedown"),ea.prototype),H()(ea.prototype,"colMousedown",[U.c],Object.getOwnPropertyDescriptor(ea.prototype,"colMousedown"),ea.prototype),ea),Do=function(e){function t(){var e,a;p()(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=m()(this,(e=f()(t)).call.apply(e,[this].concat(o)))).state={left:0,top:0},a}return v()(t,e),h()(t,[{key:"componentDidMount",value:function(){var e=this;$(".h5ds-center").on("mousemove",function(t){e.setState({left:t.pageX-140,top:t.pageY-60})})}},{key:"componentWillUnmount",value:function(){$(".h5ds-center").off("mousemove")}},{key:"render",value:function(){return q.a.createElement(q.a.Fragment,null,q.a.createElement("span",{className:"h5ds-ruler-span-x",style:{height:this.props.lineWidth,left:this.state.left}}),q.a.createElement("span",{className:"h5ds-ruler-span-y",style:{width:this.props.lineWidth,top:this.state.top}}))}}]),t}(G.Component),No=(ta=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).lineWidth=24,a.eachWidth=5,a.size=10,a.minLine=5,a.maxLine=12,a.calibration=a.size*e.phoneScale,a}return v()(t,e),h()(t,[{key:"drawLine",value:function(e,t,a,n,o){var r=this,s=this.props.phoneScale;if(o=parseInt(o,10),U.e.publish("h5ds.ruler.drawline",{type:n,value:o,phoneScale:s}),e?e.clearRect(0,0,a.width,a.height):(e=t.getContext("2d")).font="9px normal",e.strokeStyle="#748392",e.fillStyle="#748392","row"===n){var i=parseInt((a.width-o)/this.calibration,10);if(i<0)return;new Array(i).fill(1).forEach(function(t,a){var n=a*r.calibration+.5;e.beginPath(),e.moveTo(n+o,0),e.lineTo(n+o,a%r.eachWidth==0?r.maxLine:r.minLine),e.stroke(),e.closePath(),a%r.eachWidth==0&&e.fillText(parseInt(a*r.calibration/s,10),n+o,r.lineWidth-4),a<o/r.calibration&&0!==a&&(e.beginPath(),e.moveTo(o-n,0),e.lineTo(o-n,a%r.eachWidth==0?r.maxLine:r.minLine),e.stroke(),e.closePath(),a%r.eachWidth==0&&e.fillText(parseInt(-a*r.calibration/s,10),o-n,r.lineWidth-4))})}else{var c=parseInt((a.height-o)/this.calibration,10);if(c<0)return;new Array(c).fill(1).forEach(function(t,a){var n=a*r.calibration+.5;e.beginPath(),e.moveTo(0,n+o),e.lineTo(a%r.eachWidth==0?r.maxLine:r.minLine,n+o),e.stroke(),e.closePath(),a%r.eachWidth==0&&(e.save(),e.translate(r.lineWidth-10,n+o),e.rotate(Math.PI/2),e.fillText(parseInt(a*r.calibration/s,10),0,0),e.restore()),a<o/r.calibration&&0!==a&&(e.beginPath(),e.moveTo(0,o-n),e.lineTo(a%r.eachWidth==0?r.maxLine:r.minLine,o-n),e.stroke(),e.closePath(),a%r.eachWidth==0&&(e.save(),e.translate(r.lineWidth-10,o-n),e.rotate(Math.PI/2),e.fillText(parseInt(-a*r.calibration/s),0,0),e.restore()))})}return e}},{key:"drawRowLine",value:function(e,t){this.rowCtx=this.drawLine(this.rowCtx,this.rowRef,{width:t,height:this.lineWidth},"row",e)}},{key:"drawColLine",value:function(e,t){this.colCtx=this.drawLine(this.colCtx,this.colRef,{width:this.lineWidth,height:t},"col",e)}},{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.canvasHeight,n=t.canvasWidth,o=t.phoneScale,r=t.top,s=t.left;this.calibration=this.size*o,this.drawRowLine(s,n),this.drawColLine(r,a),U.e.subscribe("h5ds.rulerline.position",function(t,o){o.left&&e.drawRowLine(o.left,n),o.top&&e.drawColLine(o.top,a)})}},{key:"componentDidUpdate",value:function(){console.log("............................... 怎么就更新了呢",this.props);var e=this.props,t=e.canvasHeight,a=e.canvasWidth,n=e.phoneScale,o=e.top,r=e.left;this.calibration=this.size*n,this.drawRowLine(r,a),this.drawColLine(o,t)}},{key:"componentWillUnmount",value:function(){U.e.unsubscribe("h5ds.rulerline.position")}},{key:"render",value:function(){var e=this,t=this.props,a=t.canvasHeight,n=t.canvasWidth,o=t.phoneScale;return q.a.createElement("div",{className:"h5ds-ruler-line"},q.a.createElement("canvas",{id:"h5dsRulerCol",ref:function(t){return e.colRef=t},width:this.lineWidth,height:a}),q.a.createElement("canvas",{id:"h5dsRulerRow",ref:function(t){return e.rowRef=t},width:n,height:this.lineWidth}),q.a.createElement(Co,{canvasHeight:a,canvasWidth:n,phoneScale:o}),q.a.createElement(Do,{lineWidth:this.lineWidth}))}}]),t}(G.Component),H()(ta.prototype,"drawLine",[U.c],Object.getOwnPropertyDescriptor(ta.prototype,"drawLine"),ta.prototype),H()(ta.prototype,"drawRowLine",[U.c],Object.getOwnPropertyDescriptor(ta.prototype,"drawRowLine"),ta.prototype),H()(ta.prototype,"drawColLine",[U.c],Object.getOwnPropertyDescriptor(ta.prototype,"drawColLine"),ta.prototype),ta),Po=Object(zt.inject)("h5ds","scope")(aa=Object(zt.observer)(aa=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"componentDidMount",value:function(){var e=this;$(window).on("resize.ruler",function(){e.props.h5ds.setCanvasSize()})}},{key:"componentWillUnmount",value:function(){$(window).off("resize.ruler")}},{key:"render",value:function(){var e=this.props.h5ds,t=e.data,a=e.edata,n=e.getPage,o=a.phoneScale,r=a.canvasHeight,s=a.canvasWidth,i=t.style,c=(i.width,i.height,F()(i,["width","height"])),l=n("pages",a.selectPage),p={};if(!l)return console.error("page不存在:",a.selectPage),null;Object.assign(p,E()({},l.style));var u={pluginsKey:this.props.scope.pluginsKey,scripts:this.props.scope.scripts};console.log("render canvas >>>>>>>>>>>");var h=(s-l.style.width*o)/2,d=(r-l.style.height*o)/2;return q.a.createElement("div",{className:"h5ds-center",style:{height:r,width:s},onDragStart:function(e){e.preventDefault()}},q.a.createElement(No,{canvasHeight:r,canvasWidth:s,phoneScale:o,top:d,left:h}),q.a.createElement(So,T()({phoneScale:a.phoneScale,page:{width:p.width*a.phoneScale,height:p.height*a.phoneScale}},{canvasHeight:r,canvasWidth:s})),q.a.createElement("div",{style:{height:r,width:s},className:"h5ds-canvas"+(a.banAnimate?" h5ds-ban-animate":""),id:"h5dsCanvas"},q.a.createElement("div",{className:"h5ds-canvas-realsize",style:{left:h,top:d,width:l.style.width*o,height:l.style.height*o}},q.a.createElement("div",{className:"h5ds-canvas-box h5ds-js-canvas",style:Object.assign(E()({},c),{transform:"scale(".concat(a.phoneScale,") translate3d(0,0,0)")})},"phone"===Tt.e.appType&&q.a.createElement("div",{className:"h5ds-canvas-lines",style:{width:Tt.e.appWidth,height:p.height}},q.a.createElement("div",{className:"h5ds-canvas-lines-iphone678"}),q.a.createElement("div",{style:{top:(p.height-640)/2<0?(p.height-640)/2:0},className:"h5ds-canvas-lines-iphoneX"})),q.a.createElement("div",{className:"h5ds-canvas-preview h5ds-canvas-app h5ds-js-setsize",id:"h5dsCanvasApp",style:E()({},p)},q.a.createElement(Xt,{width:Tt.e.appWidth,height:p.height}),q.a.createElement(Bt,{height:p.height}),"phone"===Tt.e.appType?null:q.a.createElement(Ft,{width:p.width}),q.a.createElement(Jt,{plugins:u,pageData:l})),q.a.createElement("div",{className:"h5ds-canvas-border"})))))}}]),t}(G.Component))||aa)||aa,jo=(a(126),a(62),a(29)),Lo=a.n(jo),Io=(a(63),a(32)),Ao=a.n(Io),To=a(33),zo=a.n(To),_o=(a(127),Object(zt.inject)("h5ds","scope")(na=Object(zt.observer)((oa=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"showSourceImgs",value:function(){U.e.publish("h5ds.img.modal.show",{callback:this.changeImage})}},{key:"changeImage",value:function(e){var t=this;Object(Y.transaction)(function(){t.props.h5ds.data.img=e,t.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})}},{key:"onCropOk",value:function(e){var t=this;console.log("data",e);var a=this.props.uploadSet;e.src&&(a?$.ajax({type:"post",url:a.action,headers:E()({},a.headers),data:{content:e.base64.split(",")[1]}}).done(function(e){e.path?t.changeImage(e.path):console.error("数据返回格式错误： {path: 'xxxx'}")}):console.error("图片裁剪需要配置 uploadBase64 接口参数！"))}},{key:"render",value:function(){var e=this.props.h5ds.data.img;return q.a.createElement("div",{className:"h5ds-util-background"},q.a.createElement("h1",{className:"h5ds-util-background-title"},"H5主图:"),q.a.createElement("div",{className:"h5ds-util-background-img"},q.a.createElement(oe,{cropSet:null,onClickNullImage:this.showSourceImgs,onChangeImage:this.showSourceImgs,onCropBase64:this.onCropOk,src:e})))}}]),t}(G.Component),H()(oa.prototype,"showSourceImgs",[U.c],Object.getOwnPropertyDescriptor(oa.prototype,"showSourceImgs"),oa.prototype),H()(oa.prototype,"changeImage",[U.c],Object.getOwnPropertyDescriptor(oa.prototype,"changeImage"),oa.prototype),H()(oa.prototype,"onCropOk",[U.c],Object.getOwnPropertyDescriptor(oa.prototype,"onCropOk"),oa.prototype),na=oa))||na)||na),$o=(a(128),a(129),a(78)),Wo=a.n($o),Ho=(ra=function(e){function t(e){var a;p()(this,t),a=m()(this,f()(t).call(this,e));var n=e.data||{},o=n.backgroundColor,r=void 0===o?"rgba(255,255,255,1)":o,s=n.backgroundImage,i=void 0===s?"":s,c=n.backgroundImageCrop,l=void 0===c?"{}":c,u=n.backgroundRepeat,h=void 0===u?"no-repeat":u,d=n.backgroundSize,y=void 0===d?"initial":d;return r=Object(U.h)(r),a.state={backgroundColor:Object(U.h)(r),backgroundRepeat:h,backgroundImageCrop:l,backgroundSize:y,backgroundImage:i},a.eventId=U.i.randomID(),a}return v()(t,e),h()(t,[{key:"onChange",value:function(){this.props.onChange&&this.props.onChange(E()({},this.state))}},{key:"changeImage",value:function(e){this.setState({backgroundImage:"url(".concat(e,")")},this.onChange)}},{key:"showSourceImgs",value:function(){U.e.publish("h5ds.img.modal.show",{callback:this.changeImage})}},{key:"onCropOk",value:function(e){var t=this,a=this.props.uploadSet;console.log("裁剪OK",e),e.src?a?$.ajax({type:"post",url:a.action,headers:E()({},a.headers),data:{content:e.base64.split(",")[1]}}).done(function(e){e.path?t.setState({backgroundImage:"url(".concat(e.path,")")},t.onChange):console.error("数据返回格式错误： {path: 'xxxx'}")}):console.error("图片裁剪需要配置 uploadBase64 接口参数！"):this.setState({backgroundImage:""},this.onChange)}},{key:"sliderDo",value:function(e,t){this.setState(zo()({},t,e),this.onChange)}},{key:"changeColor",value:function(e){var t=e.rgb,a=t.r,n=t.g,o=t.b,r=t.a;this.setState({backgroundColor:"rgba(".concat(a,",").concat(n,",").concat(o,",").concat(r,")")},this.onChange)}},{key:"render",value:function(){var e=this,t=Wo.a.Group,a=Wo.a.Button,n=this.state,o=n.backgroundColor,r=n.backgroundRepeat,s=n.backgroundImage,i=n.backgroundSize,c=this.props,l=c.title,p=void 0===l?"页面背景":l,u=c.colorTitle,h=void 0===u?"背景颜色":u;return q.a.createElement("div",{className:"h5ds-util-background"},q.a.createElement("h1",{className:"h5ds-util-background-title"},p),q.a.createElement("div",{className:"h5ds-util-background-img"},q.a.createElement(oe,{cropSet:{},onClickNullImage:this.showSourceImgs,onChangeImage:this.showSourceImgs,onCropBase64:this.onCropOk,src:U.i.getBackGroundImageUrl(s)})),q.a.createElement(Ne,{name:"背景模式"},q.a.createElement(t,{size:"small",onChange:function(t){return e.sliderDo(t.target.value,"backgroundRepeat")},value:r},q.a.createElement(a,{value:"no-repeat"},"默认"),q.a.createElement(a,{value:"repeat-x"},"X平铺"),q.a.createElement(a,{value:"repeat-y"},"Y平铺"),q.a.createElement(a,{value:"repeat"},"平铺"))),q.a.createElement(Ne,{name:"背景尺寸"},q.a.createElement(t,{size:"small",onChange:function(t){return e.sliderDo(t.target.value,"backgroundSize")},value:i},q.a.createElement(a,{value:"initial"},"默认"),q.a.createElement(a,{value:"contain"},"适配"),q.a.createElement(a,{value:"100% 100%"},"拉伸"))),q.a.createElement(Pe,{title:h,color:o,onChange:this.changeColor}))}}]),t}(G.Component),H()(ra.prototype,"onChange",[U.c],Object.getOwnPropertyDescriptor(ra.prototype,"onChange"),ra.prototype),H()(ra.prototype,"changeImage",[U.c],Object.getOwnPropertyDescriptor(ra.prototype,"changeImage"),ra.prototype),H()(ra.prototype,"showSourceImgs",[U.c],Object.getOwnPropertyDescriptor(ra.prototype,"showSourceImgs"),ra.prototype),H()(ra.prototype,"onCropOk",[U.c],Object.getOwnPropertyDescriptor(ra.prototype,"onCropOk"),ra.prototype),H()(ra.prototype,"sliderDo",[U.c],Object.getOwnPropertyDescriptor(ra.prototype,"sliderDo"),ra.prototype),H()(ra.prototype,"changeColor",[U.c],Object.getOwnPropertyDescriptor(ra.prototype,"changeColor"),ra.prototype),ra),Ro=Object(zt.inject)("h5ds","scope")(sa=Object(zt.observer)((ia=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).syncProxyData=U.i.debounce(function(e,t){a.appData[t]=e,a.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")},300),a.syncSlider=U.i.debounce(function(){a.appData.slider=E()({},a.state.slider),U.e.publish("h5ds.setHistory")},500);var n=e.h5ds.data,o=(a.appData=n).desc,r=n.name,s=n.loading,i=void 0===s?"":s,c=n.set,l=void 0===c?{}:c,u=n.type,h=void 0===u?"phone":u,d=n.slider,y=void 0===d?{}:d,g=n.style,v=void 0===g?{}:g,b=v.width,w=v.height,k=v.backgroundImageCrop,x=void 0===k?"{}":k,O=v.backgroundImage,S=void 0===O?"":O,C=v.backgroundRepeat,D=void 0===C?"no-repeat":C,N=v.backgroundSize,P=void 0===N?"initial":N,j=v.backgroundColor,L=void 0===j?"":j;return a.state={desc:o,name:r,loading:i,set:E()({},l),type:h,slider:E()({},y),width:b,height:w,backgroundImageCrop:x,backgroundImage:S,backgroundRepeat:D,backgroundSize:P,backgroundColor:L},a}return v()(t,e),h()(t,[{key:"changeVal",value:function(e,t){var a=this.state;a[t]=e,this.setState(E()({},a)),this.syncProxyData(e,t)}},{key:"selectSilder",value:function(e,t){var a=this.state.slider;a.animate=t,this.setState({slider:a}),this.appData.slider.animate=t,U.e.publish("h5ds.setHistory")}},{key:"backGroundChange",value:function(e){var t=this;this.setState(E()({},e)),Object(Y.transaction)(function(){for(var a in e){var n=e[a];void 0===t.appData.style[a]?Object(Y.extendObservable)(t.appData.style,zo()({},a,n)):t.appData.style[a]=n}t.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})}},{key:"switchDo",value:function(e){var t=this.state.slider;t.autoplay=e,this.setState({slider:t},this.syncSlider)}},{key:"onChangeTime",value:function(e){var t=this.state.slider;t.time=e,this.setState({slider:t},this.syncSlider)}},{key:"changeEffect",value:function(e){var t=this.state.slider;t.effect=e.target.value,this.setState({slider:t},this.syncSlider)}},{key:"onChangeSpeed",value:function(e){var t=this.state.slider;t.speed=e,this.setState({slider:t},this.syncSlider)}},{key:"componentWillReact",value:function(){var e=this.appData,t=e.name,a=e.desc,n=e.img;this.setState({name:t,desc:a,img:n})}},{key:"render",value:function(){var e=this,t=this.state,a=t.desc,n=t.name,o=t.slider,r=F()(t,["desc","name","slider"]),s=Rt.a.TabPane,i=Ao.a.TextArea,c=o.autoplay,l=o.time,p=o.effect,u=void 0===p?"slide":p,h=o.speed,d=void 0===h?.5:h;return this.appData.name,this.appData.desc,q.a.createElement("div",{className:"h5ds-appset"},q.a.createElement(Rt.a,{size:"small",defaultActiveKey:"1",className:"h5ds-basic-tabs"},q.a.createElement(s,{key:"1",tab:"分享"},q.a.createElement(_o,null),q.a.createElement(Ne,{className:"h5ds-appset-item",name:"H5标题"},q.a.createElement(Ao.a,{value:n,onChange:function(t){return e.changeVal(t.target.value,"name")}})),q.a.createElement(Ne,{className:"h5ds-appset-item",name:"H5描述"},q.a.createElement(i,{rows:6,value:a,onChange:function(t){return e.changeVal(t.target.value,"desc")}}))),q.a.createElement(s,{key:"2",tab:"背景"},q.a.createElement(Ho,{uploadSet:this.props.scope.options.uploadBase64,onChange:this.backGroundChange,data:r})),q.a.createElement(s,{key:"3",tab:"翻页"},q.a.createElement("div",{className:"h5ds-appset-slider"},q.a.createElement(Ne,{name:"翻页动画"},q.a.createElement(Lo.a.Group,{onChange:this.changeEffect,value:u,buttonStyle:"solid"},q.a.createElement(Lo.a.Button,{value:"slide"},"位移"),q.a.createElement(Lo.a.Button,{value:"fade"},"淡入"),q.a.createElement(Lo.a.Button,{value:"coverflow"},"3d流"),q.a.createElement(Lo.a.Button,{value:"flip"},"3d翻转"))),q.a.createElement(Ot,{name:"动画速度",onChange:this.onChangeSpeed,tipFormatter:null,step:.1,min:0,max:10,value:d}),q.a.createElement(Ne,{name:"自动播放"},q.a.createElement(Fe.a,{value:c,onChange:this.switchDo})),c&&q.a.createElement(Ot,{name:"切换时间",onChange:this.onChangeTime,tipFormatter:null,step:.1,min:0,max:100,value:l})))))}}]),t}(G.Component),H()(ia.prototype,"changeVal",[U.c],Object.getOwnPropertyDescriptor(ia.prototype,"changeVal"),ia.prototype),H()(ia.prototype,"selectSilder",[U.c],Object.getOwnPropertyDescriptor(ia.prototype,"selectSilder"),ia.prototype),H()(ia.prototype,"backGroundChange",[U.c],Object.getOwnPropertyDescriptor(ia.prototype,"backGroundChange"),ia.prototype),H()(ia.prototype,"switchDo",[U.c],Object.getOwnPropertyDescriptor(ia.prototype,"switchDo"),ia.prototype),H()(ia.prototype,"onChangeTime",[U.c],Object.getOwnPropertyDescriptor(ia.prototype,"onChangeTime"),ia.prototype),H()(ia.prototype,"changeEffect",[U.c],Object.getOwnPropertyDescriptor(ia.prototype,"changeEffect"),ia.prototype),H()(ia.prototype,"onChangeSpeed",[U.c],Object.getOwnPropertyDescriptor(ia.prototype,"onChangeSpeed"),ia.prototype),sa=ia))||sa)||sa,Mo=(a(79),Object(zt.inject)("h5ds")(ca=Object(zt.observer)((la=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"alignLeft",value:function(){var e=this,t=this.props.getSortGroups(function(e,t){return e.box.left-t.box.left}),a=0;Object(Y.transaction)(function(){t.forEach(function(e,t){0===t?a=e.box.left:e.layer.style.left=a+e.box.boxWidth/2-e.box.width/2}),e.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})}},{key:"alignRight",value:function(){var e=this,t=this.props.getSortGroups(function(e,t){return t.box.left+t.box.boxWidth-(e.box.left+e.box.boxWidth)}),a=0;Object(Y.transaction)(function(){t.forEach(function(e,t){0===t?a=e.box.left+e.box.boxWidth:e.layer.style.left=a-e.box.boxWidth/2-e.box.width/2}),e.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})}},{key:"alignTop",value:function(){var e=this,t=this.props.getSortGroups(function(e,t){return e.box.top-t.box.top}),a=0;Object(Y.transaction)(function(){t.forEach(function(e,t){0===t?a=e.box.top:e.layer.style.top=a+e.box.boxHeight/2-e.box.height/2}),e.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})}},{key:"alignDown",value:function(){var e=this,t=this.props.getSortGroups(function(e,t){return t.box.top+t.box.boxHeight-(e.box.top+e.box.boxHeight)}),a=0;Object(Y.transaction)(function(){t.forEach(function(e,t){0===t?a=e.box.top+e.box.boxHeight:e.layer.style.top=a-e.box.boxHeight/2-e.box.height/2}),e.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})}},{key:"horizontalCenter",value:function(){var e=this,t=this.props.getSortGroups(function(e,t){return e.box.left-t.box.left});Object(Y.transaction)(function(){var a=0;t.forEach(function(e,t){var n=e.layer.style,o=n.top,r=n.height;0===t?a=o+r/2:e.layer.style.top=a-r/2}),e.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})}},{key:"verticalCenter",value:function(){var e=this,t=this.props.getSortGroups(function(e,t){return e.layer.style.top-t.layer.style.top});Object(Y.transaction)(function(){var a=0;t.forEach(function(e,t){var n=e.layer.style,o=n.left,r=n.width;0===t?a=o+r/2:e.layer.style.left=a-r/2}),e.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})}},{key:"verticalSplit",value:function(){var e=this,t=this.props.getSortGroups(function(e,t){return e.layer.style.top-t.layer.style.top}),a=t[t.length-1],n=a.layer.style.top+a.layer.style.height-t[0].layer.style.top,o=0;t.forEach(function(e){o+=e.layer.style.height});var r=(n-o)/(t.length-1);Object(Y.transaction)(function(){t.forEach(function(e,a){if(0!==a){var n=t[a-1];e.layer.style.top=n.layer.style.top+n.layer.style.height+r}}),e.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})}},{key:"horizontalSplit",value:function(){var e=this,t=this.props.getSortGroups(function(e,t){return e.layer.style.left-t.layer.style.left}),a=t[t.length-1],n=a.layer.style.left+a.layer.style.width-t[0].layer.style.left,o=0;t.forEach(function(e){o+=e.layer.style.width});var r=(n-o)/(t.length-1);Object(Y.transaction)(function(){t.forEach(function(e,a){if(0!==a){var n=t[a-1];e.layer.style.left=n.layer.style.left+n.layer.style.width+r}}),e.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})}},{key:"randomDistrib",value:function(){var e=this,t=this.props.getSortGroups(),a=(0,this.props.h5ds.getPage)();Object(Y.transaction)(function(){t.forEach(function(e){e.layer.style.left=U.i.randomNumber(-20,a.style.width+20-e.layer.style.width),e.layer.style.top=U.i.randomNumber(-20,20+a.style.height-e.layer.style.height)}),e.props.h5ds.edata.keys=U.i.randomID()})}},{key:"randomSize",value:function(){var e=this,t=this.props.getSortGroups();Object(Y.transaction)(function(){t.forEach(function(e){var t=e.layer.style.height,a=e.layer.style.width;e.layer.style.height=U.i.randomNumber(10,40),e.layer.style.width=e.layer.style.height*(a/t)}),e.props.h5ds.edata.keys=U.i.randomID()})}},{key:"componentDidMount",value:function(){var e=this;U.e.subscribe("h5ds.shortcuts_y",function(t,a){var n=e.props.getSortGroups();Object(Y.transaction)(function(){n.forEach(function(e){e.layer.style.top+=a}),U.e.publish("h5ds.setHistory")})}),U.e.subscribe("h5ds.shortcuts_x",function(t,a){var n=e.props.getSortGroups();Object(Y.transaction)(function(){n.forEach(function(e){e.layer.style.left+=a}),U.e.publish("h5ds.setHistory")})})}},{key:"componentWillUnmount",value:function(){U.e.unsubscribe("h5ds.shortcuts_y"),U.e.unsubscribe("h5ds.shortcuts_x")}},{key:"render",value:function(){return q.a.createElement("ul",null,q.a.createElement("li",{className:"h5ds-item",onClick:this.alignLeft},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-duiqi"})," ",q.a.createElement("span",null,"左对齐")),q.a.createElement("li",{className:"h5ds-item",onClick:this.alignRight},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-duiqi_youduiqi"})," ",q.a.createElement("span",null,"右对齐")),q.a.createElement("li",{className:"h5ds-item",onClick:this.alignTop},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-duiqi_xiangxia"})," ",q.a.createElement("span",null,"上对齐")),q.a.createElement("li",{className:"h5ds-item",onClick:this.alignDown},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-duiqi_xiangshang"})," ",q.a.createElement("span",null,"下对齐")),q.a.createElement("li",{className:"h5ds-item",onClick:this.horizontalCenter},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-duiqi_hengxiangjuzhong"})," ",q.a.createElement("span",null,"水平居中")),q.a.createElement("li",{className:"h5ds-item",onClick:this.verticalCenter},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-duiqi_juzhong"})," ",q.a.createElement("span",null,"垂直居中")),q.a.createElement("li",{className:"h5ds-item",onClick:this.verticalSplit},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-meun"})," ",q.a.createElement("span",null,"垂直均分")),q.a.createElement("li",{className:"h5ds-item",onClick:this.horizontalSplit},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-caidan1"})," ",q.a.createElement("span",null,"水平均分")),q.a.createElement("li",{className:"h5ds-item",onClick:this.randomDistrib},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-ttpodicon"})," ",q.a.createElement("span",null,"随机分布")),q.a.createElement("li",{className:"h5ds-item",onClick:this.randomSize},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-fenbushinengyuan"})," ",q.a.createElement("span",null,"随机大小")))}}]),t}(G.Component),H()(la.prototype,"alignLeft",[U.c],Object.getOwnPropertyDescriptor(la.prototype,"alignLeft"),la.prototype),H()(la.prototype,"alignRight",[U.c],Object.getOwnPropertyDescriptor(la.prototype,"alignRight"),la.prototype),H()(la.prototype,"alignTop",[U.c],Object.getOwnPropertyDescriptor(la.prototype,"alignTop"),la.prototype),H()(la.prototype,"alignDown",[U.c],Object.getOwnPropertyDescriptor(la.prototype,"alignDown"),la.prototype),H()(la.prototype,"horizontalCenter",[U.c],Object.getOwnPropertyDescriptor(la.prototype,"horizontalCenter"),la.prototype),H()(la.prototype,"verticalCenter",[U.c],Object.getOwnPropertyDescriptor(la.prototype,"verticalCenter"),la.prototype),H()(la.prototype,"verticalSplit",[U.c],Object.getOwnPropertyDescriptor(la.prototype,"verticalSplit"),la.prototype),H()(la.prototype,"horizontalSplit",[U.c],Object.getOwnPropertyDescriptor(la.prototype,"horizontalSplit"),la.prototype),H()(la.prototype,"randomDistrib",[U.c],Object.getOwnPropertyDescriptor(la.prototype,"randomDistrib"),la.prototype),H()(la.prototype,"randomSize",[U.c],Object.getOwnPropertyDescriptor(la.prototype,"randomSize"),la.prototype),ca=la))||ca)||ca),Bo=Object(zt.inject)("h5ds")(pa=Object(zt.observer)((ua=function(e){function t(){var e,a;p()(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=m()(this,(e=f()(t)).call.apply(e,[this].concat(o)))).onChangeDelayTime=U.i.debounce(function(e){var t=a.getSortGroups();Object(Y.transaction)(function(){var n=null;t.forEach(function(t){var a=t.layer.animate;if(a[0])if(null===n)n=U.d.getAnimation(a[0].style).delay;else{n+=e;var o=a[0];o.style=U.d.setAnimation(o.style,{delay:n})}}),a.props.h5ds.edata.keys=U.i.randomID()})},200),a}return v()(t,e),h()(t,[{key:"getSortGroups",value:function(e){var t=(0,this.props.h5ds.getGroups)(),a=_()(t);return a.forEach(function(e){e.box=U.f.rectParamObj(e.layer)}),e&&a.sort(e),a}},{key:"render",value:function(){var e=Rt.a.TabPane;return q.a.createElement("div",{className:"h5ds-layerset-tabsbox h5ds-setlayer-group"},q.a.createElement(Rt.a,{defaultActiveKey:"1",className:"h5ds-tabs"},q.a.createElement(e,{key:"1",tab:"组合设置"},q.a.createElement("div",{className:"h5ds-setlayer-group-box"},q.a.createElement(Mo,{getSortGroups:this.getSortGroups}),q.a.createElement(De,null,q.a.createElement(Ne,{name:"动画间隔"},q.a.createElement(Ee.a,{size:"small",step:.1,min:0,style:{width:80},max:1/0,defaultValue:0,onChange:this.onChangeDelayTime})))))))}}]),t}(G.Component),H()(ua.prototype,"getSortGroups",[U.c],Object.getOwnPropertyDescriptor(ua.prototype,"getSortGroups"),ua.prototype),pa=ua))||pa)||pa,Fo=(a(130),a(131),Object(zt.inject)("h5ds")(ha=Object(zt.observer)((da=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).layer=a.props.h5ds.getLayer();var n=Object(Y.toJS)(a.layer.animate);return a.state={animate:n,active:null},a.keys=U.i.randomID(),a}return v()(t,e),h()(t,[{key:"resetDelay",value:function(e){var t=null;return e.forEach(function(e,a){if(0!==a){var n=t,o=n.duration,r=void 0===o?0:o,s=n.delay,i=void 0===s?0:s,c=n.count,l=void 0===c?0:c,p=U.d.getAnimation(e.style).delay;(i=r*l+i)<=p&&(i=p),e.style=U.d.setAnimation(e.style,{delay:i})}t=U.d.getAnimation(e.style)}),e}},{key:"setActive",value:function(e){this.props.h5ds.edata.animateListShow=!0,this.setState({active:e})}},{key:"animateType",value:function(e){switch(e){case"in":e="进入";break;case"out":e="离开";break;default:e="强调"}return e}},{key:"setLayer",value:function(){var e=this,t=this.state.animate;Object(Y.transaction)(function(){t[0]&&"in"===t[0].type?e.layer.estyle.opacity=0:e.layer.estyle.opacity=1,e.layer.animate=Object(Y.toJS)(t),e.props.h5ds.edata.banAnimate=!1,e.props.h5ds.edata.canvasAnimate=U.i.randomID(),U.e.publish("h5ds.setHistory")}),setTimeout(function(){U.e.publish("h5ds.initControl")})}},{key:"delAnimate",value:function(e,t){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation();var a=this.state.animate;a.splice(t,1),this.resetDelay(a),this.setState({animate:a,active:null},this.setLayer),this.props.h5ds.edata.animateListShow=!1}},{key:"addAnimate",value:function(){var e=this,t=this.state.animate;t.push({name:"渐变进入",type:"in",style:"".concat("fadeIn"," ").concat(1,"s ").concat("ease"," ").concat(0,"s ").concat(1," normal forwards running")}),this.resetDelay(t),this.setState({animate:t},function(){e.setActive(t.length-1)},this.setLayer)}},{key:"onChange",value:function(e,t,a){var n=this.state,o=n.animate,r=o[n.active];if(r){var s=U.d.getAnimation(r.style),i=s.name,c=s.duration,l=s.delay,p=s.timing,u=s.count;switch(t){case"duration":a?c+=e:c=e,c<0&&(c=0);break;case"delay":a?l+=e:l=e,l<0&&(l=0);break;case"count":a?u+=e:u=e,u<1&&(u=1);break;case"timing":a?p+=e:p=e,p<0&&(p=0)}c=U.i.toFixed(c,1),r.style="".concat(i," ").concat(c,"s ").concat(p," ").concat(U.i.toFixed(l,1),"s ").concat(u," normal forwards running"),this.resetDelay(o),this.setState({animate:o},this.setLayer)}}},{key:"componentDidMount",value:function(){var e=this;U.e.subscribe("h5ds.animateList.add",function(t,a){var n=e.state,o=n.animate,r=o[n.active];if(r){var s=U.d.getAnimation(r.style),i=s.duration,c=s.delay,l=s.timing,p=s.count;r.name=a.name,r.type=a.type,r.style="".concat(a.animate," ").concat(i||a.time,"s ").concat(a.fun||l," ").concat(c||a.delay,"s ").concat(p||a.count," normal forwards running"),e.resetDelay(o),e.setState({animate:o},e.setLayer)}}),$("#h5dsUniqAnimateSetList").on("uniqend",function(t,a){if(a){e.keys=U.i.randomID();var n=e.state.animate;U.i.exchageArrayElem(n,a.to,a.from),e.resetDelay(n),e.setState({active:null,animate:n},e.setLayer)}}),$(document).on("mousewheel.h5ds.AnimateSet",".h5ds-scroll-AnimateSet",function(t){t.preventDefault();var a,n=$(t.target).attr("data-key");a="count"===n?t.originalEvent.deltaY<0?-1:1:t.originalEvent.deltaY<0?-.1:.1,e.onChange(a,n,!0)})}},{key:"componentWillUnmount",value:function(){this.props.h5ds.edata.animateListShow=!1,U.e.unsubscribe("h5ds.animateList.add"),$("#h5dsUniqAnimateSetList").off("uniqend"),$(document).off("mousewheel.h5ds.AnimateSet")}},{key:"render",value:function(){var e=this;if(!this.layer)return null;var t=this.state,a=t.active,n=t.animate;return this.layer.animate,q.a.createElement("div",{className:"h5ds-basic-animateset"},q.a.createElement("div",{className:"h5ds-basic-animateset-list"},q.a.createElement("ul",{className:"h5ds-uniqlist",id:"h5dsUniqAnimateSetList"},n.map(function(t,n){var o=["h5ds-basic-animateset-item"];a===n&&o.push("h5ds-basic-animateset-active");var r=t.name,s=t.type,i=t.style,c=U.d.getAnimation(i),l=c.duration,p=c.timing,u=c.delay,h=c.count;return q.a.createElement("li",{onClick:function(){return e.setActive(n)},className:o.join(" "),key:n+e.keys},q.a.createElement("a",{onClick:function(t){return e.delAnimate(t,n)},className:"h5ds-basic-animateset-btndel"},q.a.createElement(dt.a,{type:"close",theme:"outlined"})),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"动画名称:"},r||"-")),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"动画类型:"},e.animateType(s)||"-")),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"持续时间:"},q.a.createElement(Ee.a,{className:"h5ds-scroll-AnimateSet","data-key":"duration",size:"small",step:.1,min:0,max:1/0,value:U.i.isEmpty(l)?0:l,onChange:function(t){return e.onChange(t,"duration")}}))),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"延迟时间:"},q.a.createElement(Ee.a,{className:"h5ds-scroll-AnimateSet","data-key":"delay",size:"small",step:.1,min:0,max:1/0,value:U.i.isEmpty(u)?0:u,onChange:function(t){return e.onChange(t,"delay")}}))),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"重复次数:"},q.a.createElement(Ee.a,{className:"h5ds-scroll-AnimateSet","data-key":"count",size:"small",step:1,min:1,max:1/0,value:U.i.isEmpty(h)?1:h,onChange:function(t){return e.onChange(t,"count")}}))),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"缓动函数:"},q.a.createElement(gt.a,{size:"small",onChange:function(t){return e.onChange(t,"timing")},value:p,style:{width:78},placeholder:"缓动函数"},q.a.createElement(gt.a.Option,{value:"ease"},"默认"),q.a.createElement(gt.a.Option,{value:"linear"},"匀速"),q.a.createElement(gt.a.Option,{value:"ease-in"},"加速"),q.a.createElement(gt.a.Option,{value:"ease-out"},"减速"),q.a.createElement(gt.a.Option,{value:"ease-in-out"},"起始慢")))))})),q.a.createElement(fe.a,{className:"h5ds-basic-animateset-addbtn",onClick:this.addAnimate,type:"primary",icon:"plus"},"添加动画")))}}]),t}(G.Component),H()(da.prototype,"resetDelay",[U.c],Object.getOwnPropertyDescriptor(da.prototype,"resetDelay"),da.prototype),H()(da.prototype,"setActive",[U.c],Object.getOwnPropertyDescriptor(da.prototype,"setActive"),da.prototype),H()(da.prototype,"animateType",[U.c],Object.getOwnPropertyDescriptor(da.prototype,"animateType"),da.prototype),H()(da.prototype,"setLayer",[U.c],Object.getOwnPropertyDescriptor(da.prototype,"setLayer"),da.prototype),H()(da.prototype,"delAnimate",[U.c],Object.getOwnPropertyDescriptor(da.prototype,"delAnimate"),da.prototype),H()(da.prototype,"addAnimate",[U.c],Object.getOwnPropertyDescriptor(da.prototype,"addAnimate"),da.prototype),H()(da.prototype,"onChange",[U.c],Object.getOwnPropertyDescriptor(da.prototype,"onChange"),da.prototype),ha=da))||ha)||ha),Go=(a(132),a(133),a(134),ma=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"ok",value:function(){var e=!0;this.props.ok&&(e=this.props.ok()),!0!==e&&void 0!==e||this.props.close()}},{key:"clear",value:function(){var e=this.props,t=e.layer,a=e.id,n=e.clear,o=e.close;t.events&&t.events.splice(t.events.findIndex(function(e){return e.id===a}),1),n&&n(),o()}},{key:"render",value:function(){return q.a.createElement("div",null,q.a.createElement("div",null,q.a.createElement("a",{onClick:this.ok,className:"h5ds-close-event"},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-jia"})," 确定"),q.a.createElement("a",{onClick:this.clear,className:"h5ds-clear-event"},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-icodel"})," 删除事件")),q.a.createElement("div",{className:"h5ds-event-set-box"},q.a.createElement("div",{className:"h5ds-eventbox"},q.a.createElement("h3",{className:"h5ds-event-title"},"交互名称：",this.props.name),q.a.createElement("div",{className:"h5ds-event-links"},this.props.children),q.a.createElement("div",{className:"h5ds-event-tips"},q.a.createElement("h3",{className:"h5ds-event-title"},"交互说明："),q.a.createElement("div",{className:"h5ds-eventbox-content"},this.props.describe)))))}}]),t}(G.Component),H()(ma.prototype,"ok",[U.c],Object.getOwnPropertyDescriptor(ma.prototype,"ok"),ma.prototype),H()(ma.prototype,"clear",[U.c],Object.getOwnPropertyDescriptor(ma.prototype,"clear"),ma.prototype),ma),qo={EventEditor:Object(zt.inject)("h5ds")(ya=Object(zt.observer)((fa=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).layer=e.h5ds.getLayer();var n=Object(Y.toJS)(a.props.eventData).eventParam;return a.state={eventName:n.eventName,value:n.value},a}return v()(t,e),h()(t,[{key:"changeText",value:function(e){this.setState({val:e.target.value})}},{key:"ok",value:function(){var e=this,t=this.state,a=t.value,n=t.eventName;if(!n||U.i.isEmpty(a))return Q.a.error("请设置eventName和value参数"),!1;Object(Y.transaction)(function(){e.props.eventData.eventParam.value=a,e.props.eventData.eventParam.eventName=n,U.e.publish("h5ds.setHistory")})}},{key:"onChangeRadio",value:function(e){this.setState({eventName:e.target.value})}},{key:"setValue",value:function(e){this.setState({value:e.keyid})}},{key:"ReactEdit",value:function(e,t){var a=this,n=null;switch(e){case"h5ds_show_modal":var o=this.props.h5ds.getPages("popups");n=q.a.createElement("div",{className:"h5ds-event-click-content"},q.a.createElement("h1",null,"请选择要显示或者隐藏的弹窗"),q.a.createElement("ul",{className:"h5ds-event-click-modals"},(o||[]).map(function(e,n){return console.log(t,e.keyid,t===e.keyid),q.a.createElement("li",{onClick:function(){return a.setValue(e)},className:t===e.keyid?"active":"",key:e.keyid},"【",n,"】",e.name)})));break;case"h5ds_show_hide_layer":var r=this.props.h5ds.getLayers();n=q.a.createElement("div",{className:"h5ds-event-click-content"},q.a.createElement("h1",null,"请选择要显示或者隐藏的图层"),q.a.createElement("ul",{className:"h5ds-event-click-layers"},(r||[]).map(function(e,n){return q.a.createElement("li",{onClick:function(){return a.setValue(e)},className:t===e.keyid?"active":"",key:e.keyid},"【",n,"】",e.name)})));break;case"h5ds_custom_event_name":n=q.a.createElement("div",{className:"h5ds-event-click-content"},q.a.createElement("h1",null,"请设置自定义事件名称"),q.a.createElement(Ao.a,null))}return n}},{key:"render",value:function(){var e=this.state,t=e.value,a=e.eventName,n=Lo.a.Button,o=Lo.a.Group;return console.log("value, eventName",t,a),q.a.createElement(Go,{layer:this.layer,id:this.props.id,close:this.props.close,name:"点击事件",describe:"描述信息",ok:this.ok},q.a.createElement("div",{className:"h5ds-event-click"},q.a.createElement(o,{value:a,onChange:this.onChangeRadio,size:"small"},q.a.createElement(n,{value:"h5ds_show_modal"},"显/隐弹窗"),q.a.createElement(n,{value:"h5ds_show_hide_layer"},"显/隐图层"),q.a.createElement(n,{value:"h5ds_custom_event_name"},"自定义事件")),this.ReactEdit(a,t)))}}]),t}(G.Component),H()(fa.prototype,"changeText",[U.c],Object.getOwnPropertyDescriptor(fa.prototype,"changeText"),fa.prototype),H()(fa.prototype,"ok",[U.c],Object.getOwnPropertyDescriptor(fa.prototype,"ok"),fa.prototype),H()(fa.prototype,"onChangeRadio",[U.c],Object.getOwnPropertyDescriptor(fa.prototype,"onChangeRadio"),fa.prototype),H()(fa.prototype,"setValue",[U.c],Object.getOwnPropertyDescriptor(fa.prototype,"setValue"),fa.prototype),H()(fa.prototype,"ReactEdit",[U.c],Object.getOwnPropertyDescriptor(fa.prototype,"ReactEdit"),fa.prototype),ya=fa))||ya)||ya,name:"点击事件",eventId:"h5ds_event_click",eventParam:{value:"",eventName:""},icon:q.a.createElement("i",{className:"h5ds-ico h5ds-ico-lianjie"})},Uo=(a(135),{EventEditor:Object(zt.inject)("h5ds")(ga=Object(zt.observer)((va=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).layer=e.h5ds.getLayer();var n=Object(Y.toJS)(a.props.eventData);return a.state={value:n.eventParam.value},a}return v()(t,e),h()(t,[{key:"changeText",value:function(e){this.setState({value:e.target.value})}},{key:"ok",value:function(){var e=this.state.value;return U.i.isUrl(e)?(this.props.eventData.eventParam.value=e,!0):(Q.a.error("url格式不正确，格式示例：http://www.h5ds.com"),!1)}},{key:"render",value:function(){var e=this.state.value;return q.a.createElement(Go,{layer:this.layer,id:this.props.id,close:this.props.close,name:"超链接",describe:"在输入框中输入要跳转到的链接地址就可以了",ok:this.ok,clear:this.clear},q.a.createElement("div",{className:"h5ds-event-links-txt"},q.a.createElement("textarea",{style:{width:"100%"},placeholder:"请输入带http的链接地址",onChange:this.changeText,value:e})))}}]),t}(G.Component),H()(va.prototype,"changeText",[U.c],Object.getOwnPropertyDescriptor(va.prototype,"changeText"),va.prototype),H()(va.prototype,"ok",[U.c],Object.getOwnPropertyDescriptor(va.prototype,"ok"),va.prototype),ga=va))||ga)||ga,name:"超链接",eventId:"h5ds_event_link",eventParam:{value:""},icon:q.a.createElement("i",{className:"h5ds-ico h5ds-ico-lianjie"})}),Yo=(a(136),{EventEditor:Object(zt.inject)("h5ds")(ba=Object(zt.observer)((wa=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).layer=e.h5ds.getLayer();var n=Object(Y.toJS)(a.props.eventData);return a.state={value:n.eventParam.value},a}return v()(t,e),h()(t,[{key:"changeText",value:function(e){this.setState({value:e.target.value})}},{key:"ok",value:function(){var e=this.state.value;return U.i.isPhoneNum(e)?(this.props.eventData.eventParam.value=e,!0):(Q.a.error("电话格式不正确，格式示例：13866688800"),!1)}},{key:"render",value:function(){var e=this.state.value;return q.a.createElement(Go,{layer:this.layer,id:this.props.id,close:this.props.close,name:"发短信",describe:"在输入框中输入电话号码即可",ok:this.ok,clear:this.clear},q.a.createElement("div",{className:"h5ds-event-links-txt"},q.a.createElement("input",{placeholder:"请输入电话号码",onChange:this.changeText,value:e})))}}]),t}(G.Component),H()(wa.prototype,"changeText",[U.c],Object.getOwnPropertyDescriptor(wa.prototype,"changeText"),wa.prototype),H()(wa.prototype,"ok",[U.c],Object.getOwnPropertyDescriptor(wa.prototype,"ok"),wa.prototype),ba=wa))||ba)||ba,name:"发短信",eventId:"h5ds_event_msg",eventParam:{value:""},icon:q.a.createElement("i",{className:"h5ds-ico h5ds-ico-duanxin"})}),Vo=(a(137),{EventEditor:Object(zt.inject)("h5ds")(ka=Object(zt.observer)((Ea=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).layer=e.h5ds.getLayer();var n=Object(Y.toJS)(a.props.eventData);return a.state={value:n.eventParam.value},a}return v()(t,e),h()(t,[{key:"changeText",value:function(e){this.setState({value:e.target.value})}},{key:"ok",value:function(){var e=this.state.value;return U.i.isPhoneNum(e)?(this.props.eventData.eventParam.value=e,!0):(Q.a.error("电话格式不正确，格式示例：13866688800"),!1)}},{key:"render",value:function(){var e=this.state.value;return q.a.createElement(Go,{layer:this.layer,id:this.props.id,close:this.props.close,name:"打电话",describe:"在输入框中输入电话号码即可",ok:this.ok,clear:this.clear},q.a.createElement("div",{className:"h5ds-event-links-txt"},q.a.createElement("input",{placeholder:"请输入电话号码",onChange:this.changeText,value:e})))}}]),t}(G.Component),H()(Ea.prototype,"changeText",[U.c],Object.getOwnPropertyDescriptor(Ea.prototype,"changeText"),Ea.prototype),H()(Ea.prototype,"ok",[U.c],Object.getOwnPropertyDescriptor(Ea.prototype,"ok"),Ea.prototype),ka=Ea))||ka)||ka,name:"打电话",eventId:"h5ds_event_tel",eventParam:{value:""},icon:q.a.createElement("i",{className:"h5ds-ico h5ds-ico-shoujidadianhua"})}),Jo=(a(138),[qo,Uo,Yo,Vo,{EventEditor:Object(zt.inject)("h5ds")(xa=Object(zt.observer)((Oa=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).layer=e.h5ds.getLayer();var n=Object(Y.toJS)(a.props.eventData);return a.state={value:n.eventParam.value},a}return v()(t,e),h()(t,[{key:"changeVal",value:function(e){this.setState({value:e})}},{key:"ok",value:function(){var e=this.state.value;return U.i.isEmpty(e)?(Q.a.error("请选择要跳转的页面"),!1):(this.props.eventData.eventParam.value=e,U.e.publish("h5ds.setHistory"),!0)}},{key:"render",value:function(){var e=this,t=this.state.value,a=this.props.h5ds.data.pages;return q.a.createElement(Go,{layer:this.layer,id:this.props.id,close:this.props.close,name:"跳转页面",describe:"选择一个要跳转的页面，点击会触发交互效果，跳转到指定的页面",ok:this.ok,clear:this.clear},q.a.createElement("div",{className:"h5ds-uebox-topages"},q.a.createElement("h4",null,"请选择您要跳转的页面："),q.a.createElement("ul",{id:"ueBoxToPage"},a.map(function(a,n){return q.a.createElement("li",{key:n,onClick:function(t){return e.changeVal(n)},title:a.name,className:parseInt(t,10)===n?"active":""},q.a.createElement("span",{className:"num"},n+1),q.a.createElement("span",{className:"name"},a.name))}))))}}]),t}(G.Component),H()(Oa.prototype,"changeVal",[U.c],Object.getOwnPropertyDescriptor(Oa.prototype,"changeVal"),Oa.prototype),H()(Oa.prototype,"ok",[U.c],Object.getOwnPropertyDescriptor(Oa.prototype,"ok"),Oa.prototype),xa=Oa))||xa)||xa,name:"跳页面",eventId:"h5ds_event_topage",eventParam:{value:""},icon:q.a.createElement("i",{className:"h5ds-ico h5ds-ico-tiaozhuan"})}]),Xo=Object(zt.inject)("h5ds")(Sa=Object(zt.observer)((Ca=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={eventId:null,selectId:null},a}return v()(t,e),h()(t,[{key:"addEvent",value:function(){this.props.h5ds.edata.eventListShow=!0}},{key:"closePanel",value:function(){U.e.publish("h5ds.setHistory"),this.setState({eventId:null})}},{key:"clickHandler",value:function(e,t){this.setState({eventId:e,selectId:t})}},{key:"componentWillUnmount",value:function(){this.props.h5ds.edata.eventListShow=!1}},{key:"render",value:function(){var e=this;this.layer=this.props.h5ds.getLayer();var t=this.state,a=t.eventId,n=t.selectId;if(!this.layer)return null;var o=this.layer.events,r=void 0===o?[]:o,s=(Jo.find(function(e){return e.eventId===a})||{}).EventEditor;return q.a.createElement("div",{className:"h5ds-event"},q.a.createElement("div",{className:"h5ds-event-list"},q.a.createElement("ul",null,r.map(function(t){var a=t.eventId,n=t.id,o=t.name;return q.a.createElement("li",{onClick:function(){return e.clickHandler(a,n)},key:n,className:"h5ds-event"},q.a.createElement("p",null,q.a.createElement("span",null,"事件名称："),o),q.a.createElement("p",null,q.a.createElement("a",null,"【点击设置参数】")))})),this.props.h5ds.edata.eventListShow?null:q.a.createElement(fe.a,{className:"h5ds-basic-animateset-addbtn",onClick:this.addEvent,type:"primary",icon:"plus"},"添加事件")),q.a.createElement("div",{className:"h5ds-event-set "+(a?"h5ds-event-show":"h5ds-event-hide")},s?q.a.createElement(s,{eventData:r.find(function(e){return e.id===n}),id:n,close:this.closePanel}):null))}}]),t}(G.Component),H()(Ca.prototype,"addEvent",[U.c],Object.getOwnPropertyDescriptor(Ca.prototype,"addEvent"),Ca.prototype),H()(Ca.prototype,"closePanel",[U.c],Object.getOwnPropertyDescriptor(Ca.prototype,"closePanel"),Ca.prototype),H()(Ca.prototype,"clickHandler",[U.c],Object.getOwnPropertyDescriptor(Ca.prototype,"clickHandler"),Ca.prototype),Sa=Ca))||Sa)||Sa,Ko=(a(139),Object(zt.inject)("h5ds","scope")(Da=Object(zt.observer)((Na=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).layer=e.h5ds.getLayer(),a.state={checked:!!a.layer.adsorb,active:"h5ds-adsorbset-".concat(a.layer.adsorb)},a}return v()(t,e),h()(t,[{key:"onChange",value:function(e){this.setState({checked:e}),this.layer.adsorb=""}},{key:"setAdsorb",value:function(e){this.setState({active:e}),this.layer.adsorb=e.replace("h5ds-adsorbset-","")}},{key:"render",value:function(){var e=this,t=this.state,a=t.checked,n=t.active,o=(this.props.scope.pluginsKey[this.layer.pid]||{}).editorConfig,r=void 0===o?{}:o;return q.a.createElement("div",{className:"h5ds-adsorbset"},!1!==r.adsorb&&q.a.createElement(Ne,{name:"外框吸附"},q.a.createElement(Fe.a,{checked:a,onChange:this.onChange}),";",a?q.a.createElement(q.a.Fragment,null,q.a.createElement("div",{className:"h5ds-adsorbset-tips"},"外框吸附说明：吸附效果会根据整个视图区域进行定位，选择一个相对的对齐点"),q.a.createElement("div",{className:"h5ds-adsorbset-dots"},["h5ds-adsorbset-top-left","h5ds-adsorbset-top-center","h5ds-adsorbset-top-right","h5ds-adsorbset-left-center","h5ds-adsorbset-right-center","h5ds-adsorbset-bottom-left","h5ds-adsorbset-bottom-center","h5ds-adsorbset-bottom-right"].map(function(t){var a=[t];return t===n&&a.push("h5ds-adsorbset-active"),q.a.createElement("a",{onClick:function(){return e.setAdsorb(t)},key:t,className:a.join(" ")})}))):null))}}]),t}(G.Component),H()(Na.prototype,"onChange",[U.c],Object.getOwnPropertyDescriptor(Na.prototype,"onChange"),Na.prototype),H()(Na.prototype,"setAdsorb",[U.c],Object.getOwnPropertyDescriptor(Na.prototype,"setAdsorb"),Na.prototype),Da=Na))||Da)||Da),Qo=(a(140),Object(zt.inject)("h5ds","scope")(Pa=Object(zt.observer)((ja=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).layer=e.h5ds.getLayer();var n=a.layer.style,o=n.width,r=n.height,s=n.top,i=n.left;return a.state={width:o,height:r,top:s,left:i,id:a.layer.id,className:a.layer.className},a}return v()(t,e),h()(t,[{key:"setLayer",value:function(){var e=this,t=this.state,a=t.id,n=t.className,o=F()(t,["id","className"]),r=this.props.h5ds.edata;Object(Y.transaction)(function(){var t=e.layer.style;e.layer.id=a,e.layer.className=n,["width","height","top","left"].forEach(function(e){t[e]=o[e]}),r.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")}),this.isInnerChange=!1}},{key:"onChange",value:function(e,t){this.isInnerChange=!0,this.setState(zo()({},t,e),this.setLayer)}},{key:"mouseWheelVal",value:function(e,t){this.isInnerChange=!0,this.setState(zo()({},e,this.state[e]+t),this.setLayer)}},{key:"flipLayer",value:function(e){var t=this,a=this.layer.style.flip,n=void 0===a?[1,1]:a,o=w()(n,2),r=o[0],s=void 0===r?1:r,i=o[1],c=void 0===i?1:i;"left-right"===e?s=1===parseInt(s,10)?-1:1:c=1===parseInt(c,10)?-1:1,Object(Y.transaction)(function(){t.layer.style.flip=[s,c],t.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})}},{key:"componentDidMount",value:function(){var e=this,t=this.props.scope.pluginsKey;U.e.subscribe("h5ds.shortcuts_y",function(a,n){var o=e.layer,r=o.style,s=o.pid,i=(t[s]||{}).editorConfig;!1!==(void 0===i?{}:i).y&&e.onChange((r.top||0)+n,"top")}),U.e.subscribe("h5ds.shortcuts_x",function(a,n){var o=e.layer,r=o.style,s=o.pid,i=(t[s]||{}).editorConfig;!1!==(void 0===i?{}:i).x&&e.onChange((r.left||0)+n,"left")}),$(document).on("mousewheel.h5ds.basicSet",".h5ds-scroll-BasicSet",function(t){t.stopPropagation();var a=$(t.target).attr("data-key");e.mouseWheelVal(a,t.originalEvent.deltaY<0?-1:1)})}},{key:"componentWillUnmount",value:function(){$(document).off("mousewheel.h5ds.basicSet"),U.e.unsubscribe("h5ds.shortcuts_y"),U.e.unsubscribe("h5ds.shortcuts_x")}},{key:"componentWillReact",value:function(){if(!this.isInnerChange){var e=this.layer.style,t=e.width,a=e.height,n=e.top,o=e.left,r=this.layer,s=r.id,i=r.className;this.setState({width:t,height:a,top:n,left:o,id:s,className:i})}}},{key:"render",value:function(){var e=this;if(!this.layer)return null;this.layer.id,this.layer.className,this.layer.style.top,this.layer.style.left,this.layer.style.width,this.layer.style.height;var t=(this.props.scope.pluginsKey[this.layer.pid]||{}).editorConfig,a=void 0===t?{}:t,n=this.state,o=n.width,r=n.height,s=n.left,i=n.top;return n.id,n.className,q.a.createElement("div",{className:"h5ds-baiscset"},!1!==a.left&&q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"x坐标"},q.a.createElement(Ee.a,{className:"h5ds-scroll-BasicSet","data-key":"left",size:"small",min:-1/0,max:1/0,placeholder:"x坐标",value:s,onChange:function(t){return e.onChange(t,"left")}}))),!1!==a.top&&q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"y坐标"},q.a.createElement(Ee.a,{className:"h5ds-scroll-BasicSet","data-key":"top",size:"small",min:-1/0,max:1/0,placeholder:"y坐标",value:i,onChange:function(t){return e.onChange(t,"top")}}))),!1!==a.width&&q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"宽度"},q.a.createElement(Ee.a,{className:"h5ds-scroll-BasicSet","data-key":"width",size:"small",min:0,max:1/0,placeholder:"宽",value:o,onChange:function(t){return e.onChange(t,"width")}}))),!1!==a.height&&q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"高度"},q.a.createElement(Ee.a,{className:"h5ds-scroll-BasicSet","data-key":"height",size:"small",min:0,max:1/0,placeholder:"高",value:r,onChange:function(t){return e.onChange(t,"height")}}))),!1!==a.flip&&q.a.createElement(De,null,q.a.createElement(Ne,{className:"h5ds-layer-flip",name:"翻转"},q.a.createElement("a",{className:"",onClick:function(){return e.flipLayer("left-right")}},"左右翻转"),"  ",q.a.createElement("a",{onClick:function(){return e.flipLayer("up-down")}},"上下翻转"))))}}]),t}(G.Component),H()(ja.prototype,"setLayer",[U.c],Object.getOwnPropertyDescriptor(ja.prototype,"setLayer"),ja.prototype),H()(ja.prototype,"onChange",[U.c],Object.getOwnPropertyDescriptor(ja.prototype,"onChange"),ja.prototype),H()(ja.prototype,"mouseWheelVal",[U.c],Object.getOwnPropertyDescriptor(ja.prototype,"mouseWheelVal"),ja.prototype),Pa=ja))||Pa)||Pa),Zo=(a(141),Object(zt.inject)("h5ds")(La=Object(zt.observer)((Ia=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).setLayer=U.i.debounce(function(){var e=a.state,t=e.bsize,n=void 0===t?2:t,o=e.btype,r=void 0===o?"solid":o,s=e.bcolor,i=void 0===s?"rgba(0,0,0,1)":s,c=a.layer.estyle,l=a.props.h5ds.edata;Object(Y.transaction)(function(){U.i.isEmpty(c.border)?Object(Y.extendObservable)(c,{border:"".concat(n,"px ").concat(r," ").concat(i)}):c.border=U.d.setBorder(c.border,{size:n,type:r,color:i}),l.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})},300),a.layer=e.h5ds.getLayer();var n=a.layer.estyle,o=U.d.getBorder(n.border),r=o.size,s=void 0===r?0:r,i=o.type,c=o.color;return a.state={bsize:s,btype:i,bcolor:c},a}return v()(t,e),h()(t,[{key:"switchBorder",value:function(e){e?this.setState({bsize:2,btype:"solid",bcolor:"rgba(0,0,0,1)"},this.setLayer):this.setState({bsize:0,btype:"solid",bcolor:"rgba(0,0,0,1)"},this.setLayer)}},{key:"changeBorderType",value:function(e){this.setState({btype:e},this.setLayer)}},{key:"changeBorderSize",value:function(e){this.setState({bsize:e},this.setLayer)}},{key:"setBorderColor",value:function(e){var t=e.rgb,a=t.r,n=t.g,o=t.b,r=t.a,s=void 0===r?1:r;this.setState({bcolor:"rgba(".concat(a,",").concat(n,",").concat(o,",").concat(s,")")},this.setLayer)}},{key:"componentDidMount",value:function(){var e=this;$(".h5ds-scroll-SetBorder").on("mousewheel.h5ds.SetBorder",function(t){t.preventDefault();var a=t.originalEvent.deltaY<0?-1:1;(a=e.state.bsize+a)<0&&(a=0),e.setState({bsize:a},e.setLayer)})}},{key:"componentWillUnmount",value:function(){$(".h5ds-scroll-SetBorder").off("mousewheel.h5ds.SetBorder")}},{key:"render",value:function(){var e=gt.a.Option,t=this.state,a=t.bsize,n=void 0===a?0:a,o=t.btype,r=t.bcolor;return q.a.createElement("div",null,q.a.createElement(De,{span:1},q.a.createElement(Ne,{name:"开启边框"},q.a.createElement(Fe.a,{onChange:this.switchBorder,checked:!!n}))),n?q.a.createElement("div",null,q.a.createElement(De,{span:1},q.a.createElement(Ne,{name:"边框类型"},q.a.createElement(gt.a,{size:"small",onChange:this.changeBorderType,value:o||"",style:{width:100},placeholder:"下拉选择"},q.a.createElement(e,{value:"solid"},"实线"),q.a.createElement(e,{value:"double"},"双线"),q.a.createElement(e,{value:"dashed"},"虚线"),q.a.createElement(e,{value:"dotted"},"点线")))),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"边框大小"},q.a.createElement(Ee.a,{className:"h5ds-scroll-SetBorder",size:"small",min:1,max:1e4,value:n,onChange:this.changeBorderSize}))),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"边框颜色"},q.a.createElement(Ce,{onChange:this.setBorderColor,color:r})))):null)}}]),t}(G.Component),H()(Ia.prototype,"switchBorder",[U.c],Object.getOwnPropertyDescriptor(Ia.prototype,"switchBorder"),Ia.prototype),H()(Ia.prototype,"changeBorderType",[U.c],Object.getOwnPropertyDescriptor(Ia.prototype,"changeBorderType"),Ia.prototype),H()(Ia.prototype,"changeBorderSize",[U.c],Object.getOwnPropertyDescriptor(Ia.prototype,"changeBorderSize"),Ia.prototype),H()(Ia.prototype,"setBorderColor",[U.c],Object.getOwnPropertyDescriptor(Ia.prototype,"setBorderColor"),Ia.prototype),La=Ia))||La)||La),er=Object(zt.inject)("h5ds")(Aa=Object(zt.observer)((Ta=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).setLayer=U.i.debounce(function(){var e=a.state.borderRadius,t=a.layer.estyle;Object(Y.transaction)(function(){void 0===t.borderRadius?Object(Y.extendObservable)(t,{borderRadius:e}):t.borderRadius=e,a.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")}),a.isInnerChange=!1},500),a.layer=e.h5ds.getLayer(),a.element=e.h5ds.getLayerDom().find(".element");var n=a.layer.estyle.borderRadius||0;return a.state={borderRadius:n},a}return v()(t,e),h()(t,[{key:"componentWillReact",value:function(){if(!this.isInnerChange){var e=this.layer.estyle.borderRadius;this.setState({borderRadius:e})}}},{key:"sliderChange",value:function(e){this.isInnerChange=!0,this.element.css("border-radius",e+"px"),this.setState({borderRadius:e},this.setLayer)}},{key:"componentDidMount",value:function(){var e=this;$(".h5ds-scroll-SetBorderRadius").on("mousewheel.h5ds.SetBorderRadius",function(t){t.preventDefault(),e.isInnerChange=!0;var a=t.originalEvent.deltaY<0?-1:1;(a=e.state.borderRadius+a)<0&&(a=0),e.setState({borderRadius:a},e.setLayer)})}},{key:"componentWillUnmount",value:function(){$(".h5ds-scroll-SetBorderRadius").off("mousewheel.h5ds.SetBorderRadius")}},{key:"render",value:function(){var e=this.state.borderRadius;return this.layer.estyle.borderRadius,q.a.createElement(Ne,{name:"设置圆角"},q.a.createElement(Ot,{mouseWheelClassName:"h5ds-scroll-SetBorderRadius",onChange:this.sliderChange,value:e,min:0,max:1e3}))}}]),t}(G.Component),H()(Ta.prototype,"sliderChange",[U.c],Object.getOwnPropertyDescriptor(Ta.prototype,"sliderChange"),Ta.prototype),Aa=Ta))||Aa)||Aa,tr=Object(zt.inject)("h5ds")(za=Object(zt.observer)((_a=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).setLayer=U.i.debounce(function(){var e=a.state,t=e.bsize,n=e.bcolor,o=void 0===n?"rgba(0,0,0,1)":n,r=a.layer.estyle,s=a.props.h5ds.edata;Object(Y.transaction)(function(){U.i.isEmpty(r.boxShadow)?Object(Y.extendObservable)(r,{boxShadow:"0 0 ".concat(t,"px ").concat(o)}):r.boxShadow=U.d.setBoxshadow(r.border,{size:t,color:o}),null===t&&(r.boxShadow="none"),s.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})},500),a.layer=e.h5ds.getLayer();var n=a.layer.estyle,o=U.d.getBoxshadow(n.boxShadow),r=o.size,s=void 0===r?null:r,i=o.color;return a.state={bsize:s,bcolor:i},a}return v()(t,e),h()(t,[{key:"sliderChange",value:function(e){var t=this.state.bcolor,a=void 0===t?"rgba(0,0,0,1)":t,n=this.layer.estyle,o=U.d.setBoxshadow(n.border,{size:e,color:a});this.props.h5ds.getLayerDom().find(".element").css("box-shadow",o),this.setState({bsize:e},this.setLayer)}},{key:"switchDo",value:function(e){e?this.setState({bsize:2,bcolor:"rgba(0,0,0,1)"},this.setLayer):this.setState({bsize:null},this.setLayer)}},{key:"setColor",value:function(e){var t=e.rgb,a=t.r,n=t.g,o=t.b,r=t.a,s=void 0===r?1:r;this.setState({bcolor:"rgba(".concat(a,",").concat(n,",").concat(o,",").concat(s,")")},this.setLayer)}},{key:"componentDidMount",value:function(){var e=this;$(".h5ds-scroll-SetBoxShadow").on("mousewheel.h5ds.SetBoxShadow",function(t){t.preventDefault();var a=t.originalEvent.deltaY<0?-1:1;(a=e.state.bsize+a)<0?a=0:100<a&&(a=100),e.setState({bsize:a},e.setLayer)})}},{key:"componentWillUnmount",value:function(){$(".h5ds-scroll-SetBoxShadow").off("mousewheel.h5ds.SetBoxShadow")}},{key:"render",value:function(){var e=this.state,t=e.bsize,a=e.bcolor;return q.a.createElement("div",null,q.a.createElement(De,null,q.a.createElement(Ne,{name:"开启阴影"},q.a.createElement(Fe.a,{onChange:this.switchDo,checked:!!t}))),null!==t?q.a.createElement(q.a.Fragment,null,q.a.createElement(Ne,{name:"阴影设置"},q.a.createElement(Ot,{mouseWheelClassName:"h5ds-scroll-SetBoxShadow",onChange:this.sliderChange,value:t,min:0,max:100})),q.a.createElement(Ne,{name:"阴影颜色"},q.a.createElement(Ce,{onChange:this.setColor,color:a}))):null)}}]),t}(G.Component),H()(_a.prototype,"sliderChange",[U.c],Object.getOwnPropertyDescriptor(_a.prototype,"sliderChange"),_a.prototype),H()(_a.prototype,"switchDo",[U.c],Object.getOwnPropertyDescriptor(_a.prototype,"switchDo"),_a.prototype),H()(_a.prototype,"setColor",[U.c],Object.getOwnPropertyDescriptor(_a.prototype,"setColor"),_a.prototype),za=_a))||za)||za,ar=Object(zt.inject)("h5ds")($a=Object(zt.observer)((Wa=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).setLayer=U.i.debounce(function(){var e=a.state.backgroundColor,t=a.layer.estyle;Object(Y.transaction)(function(){void 0===t.backgroundColor?Object(Y.extendObservable)(t,{backgroundColor:e}):t.backgroundColor=e,a.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})},200),a.layer=e.h5ds.getLayer();var n=a.layer.estyle.backgroundColor,o=void 0===n?"rgba(0,0,0,1)":n;return a.state={backgroundColor:o},a}return v()(t,e),h()(t,[{key:"changeColor",value:function(e){var t=e.rgb,a=t.r,n=t.g,o=t.b,r=t.a;this.setState({backgroundColor:"rgba(".concat(a,",").concat(n,",").concat(o,",").concat(r,")")},this.setLayer)}},{key:"render",value:function(){var e=this.state.backgroundColor;return this.layer.estyle.backgroundColor,q.a.createElement(De,{span:1},q.a.createElement(Pe,{title:"背景颜色",color:e,onChange:this.changeColor}))}}]),t}(G.Component),H()(Wa.prototype,"changeColor",[U.c],Object.getOwnPropertyDescriptor(Wa.prototype,"changeColor"),Wa.prototype),$a=Wa))||$a)||$a,nr=Object(zt.inject)("h5ds")(Ha=Object(zt.observer)((Ra=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).layer=e.h5ds.getLayer();var n=a.layer.style.display||"block";return a.state={hide:"none"===n},a}return v()(t,e),h()(t,[{key:"setLayer",value:function(){var e=this,t=this.state.hide,a=this.layer.style,n="block";t&&(n="none"),Object(Y.transaction)(function(){void 0===a.display?Object(Y.extendObservable)(a,{display:n}):a.display=n,e.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})}},{key:"changeColor",value:function(e){this.setState({hide:e},this.setLayer)}},{key:"render",value:function(){var e=this.state.hide;return this.layer.style.display,q.a.createElement(De,{span:1},q.a.createElement(Ne,{name:"隐藏元素"},q.a.createElement(Fe.a,{onChange:this.changeColor,checked:e})))}}]),t}(G.Component),H()(Ra.prototype,"setLayer",[U.c],Object.getOwnPropertyDescriptor(Ra.prototype,"setLayer"),Ra.prototype),H()(Ra.prototype,"changeColor",[U.c],Object.getOwnPropertyDescriptor(Ra.prototype,"changeColor"),Ra.prototype),Ha=Ra))||Ha)||Ha,or=Object(zt.inject)("h5ds")(Ma=Object(zt.observer)(Ma=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).setLayer=U.i.debounce(function(){var e=a.state.opacity,t=a.layer.style;Object(Y.transaction)(function(){void 0===t.opacity?Object(Y.extendObservable)(t,{opacity:e}):t.opacity=e,a.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})},500),a.sliderChange=function(e){a.layerdom.css("opacity",e),a.setState({opacity:e},a.setLayer)},a.layer=e.h5ds.getLayer(),a.layerdom=e.h5ds.getLayerDom();var n=a.layer.style.opacity||1;return a.state={opacity:n},a}return v()(t,e),h()(t,[{key:"componentDidMount",value:function(){var e=this;$(".h5ds-scroll-SetOpacity").on("mousewheel.h5ds.SetOpacity",function(t){t.preventDefault();var a=t.originalEvent.deltaY<0?-.1:.1;(a=e.state.opacity+a)<0?a=0:1<a&&(a=1),e.setState({opacity:a},e.setLayer)})}},{key:"componentWillUnmount",value:function(){$(".h5ds-scroll-SetOpacity").off("mousewheel.h5ds.SetOpacity")}},{key:"render",value:function(){var e=this.state.opacity;return this.layer.style.opacity,q.a.createElement(Ne,{name:"透明度"},q.a.createElement(Ot,{mouseWheelClassName:"h5ds-scroll-SetOpacity",onChange:this.sliderChange,value:e,step:.1,min:0,max:1}))}}]),t}(G.Component))||Ma)||Ma,rr=Object(zt.inject)("h5ds")(Ba=Object(zt.observer)((Fa=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).setLayer=U.i.debounce(function(){var e=a.state.rotate,t=a.layer.style,n=U.d.setTransform(t.transform,{rotate:e});Object(Y.transaction)(function(){t.transform=n,a.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")}),a.isInnerChange=!1},500),a.layer=e.h5ds.getLayer(),a.layerdom=e.h5ds.getLayerDom();var n=U.d.getTransform(a.layer.style.transform);return a.state={rotate:n.rotate},a}return v()(t,e),h()(t,[{key:"componentWillReact",value:function(){if(!this.isInnerChange){var e=U.d.getTransform(this.layer.style.transform);this.setState({rotate:e.rotate})}}},{key:"sliderChange",value:function(e){this.isInnerChange=!0;var t=U.d.setTransform(this.layer.style.transform,{rotate:e});this.layerdom.css("transform",t),this.setState({rotate:e},this.setLayer)}},{key:"componentDidMount",value:function(){var e=this;$(".h5ds-scroll-SetRotate").on("mousewheel.h5ds.SetRotate",function(t){t.preventDefault(),e.isInnerChange=!0;var a=t.originalEvent.deltaY<0?-1:1;(a=e.state.rotate+a)<0?a=0:360<a&&(a=360),e.setState({rotate:a},e.setLayer)})}},{key:"componentWillUnmount",value:function(){$(".h5ds-scroll-SetRotate").off("mousewheel.h5ds.SetRotate")}},{key:"render",value:function(){var e=this.state.rotate;return this.layer.style.transform,q.a.createElement(Ne,{name:"旋转角度"},q.a.createElement(Ot,{mouseWheelClassName:"h5ds-scroll-SetRotate",onChange:this.sliderChange,value:e,min:0,max:360}))}}]),t}(G.Component),H()(Fa.prototype,"sliderChange",[U.c],Object.getOwnPropertyDescriptor(Fa.prototype,"sliderChange"),Fa.prototype),Ba=Fa))||Ba)||Ba,sr=Object(zt.inject)("h5ds","scope")(Ga=Object(zt.observer)(Ga=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).layer=e.h5ds.getLayer(),a}return v()(t,e),h()(t,[{key:"render",value:function(){if(!this.layer)return null;var e=(this.props.scope.pluginsKey[this.layer.pid]||{}).editorConfig,t=void 0===e?{}:e;return q.a.createElement("div",{className:"h5ds-layout-moreset"},!1!==t.rotate&&q.a.createElement(rr,null),!1!==t.borderRadius&&q.a.createElement(er,null),!1!==t.opacity&&q.a.createElement(or,null),!1!==t.backgroundColor&&q.a.createElement(ar,null),!1!==t.hide&&q.a.createElement(nr,null),!1!==t.shadow&&q.a.createElement(tr,null),!1!==t.border&&q.a.createElement(Zo,null))}}]),t}(G.Component))||Ga)||Ga,ir=Object(zt.inject)("h5ds","scope")(qa=Object(zt.observer)((Ua=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"doRender",value:function(){var e=null,t=this.props.h5ds.getLayer(),a=this.props.scope.pluginsKey[t.pid];return a?e=a.Editor||null:Q.a.error("无".concat(t.name,":").concat(t.pid,"图层！")),e}},{key:"render",value:function(){var e=this.props.h5ds.getLayer();if(!e)return null;var t=this.doRender();return q.a.createElement("div",{key:e.keyid},q.a.createElement(Qo,null),q.a.createElement(Ko,null),t?q.a.createElement(t,{scope:this.props.scope,h5ds:this.props.h5ds,layer:e}):null,q.a.createElement(sr,null))}}]),t}(G.Component),H()(Ua.prototype,"doRender",[U.c],Object.getOwnPropertyDescriptor(Ua.prototype,"doRender"),Ua.prototype),qa=Ua))||qa)||qa,cr=Object(zt.inject)("h5ds","scope")(Ya=Object(zt.observer)((Va=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"changeTabs",value:function(){var e=this;Object(Y.transaction)(function(){e.props.h5ds.edata.eventListShow=!1,e.props.h5ds.edata.animateListShow=!1})}},{key:"render",value:function(){var e=this.props.h5ds,t=e.edata.selectlayerKeys,a=e.getLayer();if(!a)return null;var n=(this.props.scope.pluginsKey[a.pid]||{}).editorConfig,o=void 0===n?{}:n,r=Rt.a.TabPane;return q.a.createElement("div",{className:"h5ds-layerset"},q.a.createElement("div",{className:"h5ds-layerset-tabsbox"},q.a.createElement(Rt.a,{className:"h5ds-layerset-tabs",onChange:this.changeTabs,defaultActiveKey:"1"},q.a.createElement(r,{key:"1",tab:"图层样式"},q.a.createElement("div",{className:"h5ds-tabs-edit-box"},q.a.createElement(ir,{key:t+"1"}))),!1!==o.animate&&q.a.createElement(r,{key:"2",tab:"图层动画"},q.a.createElement("div",{className:"h5ds-tabs-edit-box"},q.a.createElement(Fo,{key:t+"2"}))),!1!==o.layerEvent&&q.a.createElement(r,{key:"3",tab:"图层交互"},q.a.createElement("div",{className:"h5ds-tabs-edit-box"},q.a.createElement(Xo,{key:t+"3"}))))))}}]),t}(G.Component),H()(Va.prototype,"changeTabs",[U.c],Object.getOwnPropertyDescriptor(Va.prototype,"changeTabs"),Va.prototype),Ya=Va))||Ya)||Ya,lr=(a(142),Object(zt.inject)("h5ds","scope")(Ja=Object(zt.observer)((Xa=function(e){function t(e){var a;p()(this,t),(a=m()(this,f()(t).call(this,e))).setInfo=U.i.debounce(function(){var e=a.state,t=e.id,n=e.name,o=e.desc,r=e.className;t&&!/^[_a-z][_a-z0-9]+/i.test(t)||r&&!/^[_a-z][_a-z0-9]+/i.test(r)?Q.a.error("id, class 必须是字母或者下划线开头，且必须由字母，数字，或者下划线组成！"):Object(Y.transaction)(function(){a.page.id=t,a.page.className=r,a.page.name=n,a.page.desc=o,U.e.publish("h5ds.setHistory")})},500),a.page=e.h5ds.getPage()||{};var n=a.page.style||{},o=n.backgroundImage,r=void 0===o?"":o,s=n.backgroundRepeat,i=void 0===s?"no-repeat":s,c=n.backgroundSize,l=void 0===c?"initial":c,u=n.backgroundColor,h=void 0===u?"":u,d=n.backgroundImageCrop,y=void 0===d?"{}":d,g=Object(Y.toJS)(a.page.slider)||{animate:1,autoplay:!1,lock:!1,time:5},v=a.page,b=v.name,w=v.id,k=v.className,E=v.desc;return a.state={name:b,id:w,className:k,desc:E,backgroundImageCrop:y,backgroundImage:r,backgroundRepeat:i,backgroundSize:l,backgroundColor:h,slider:g},a}return v()(t,e),h()(t,[{key:"switchDo",value:function(e,t){var a=this.state.slider;a[t]=e,this.setState({slider:a}),this.page.slider=E()({},a),U.e.publish("h5ds.setHistory")}},{key:"backGroundChange",value:function(e){var t=this.props.h5ds,a=t.getPage();Object(Y.transaction)(function(){for(var n in e){var o=e[n];void 0===a.style[n]?Object(Y.extendObservable)(a.style,zo()({},n,o)):a.style[n]=o}t.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")})}},{key:"onChangeSize",value:function(e,t){var a=this;Object(Y.transaction)(function(){var n=a.props.h5ds.data;"appWidth"===t?(n.style.width=e,n.pages.forEach(function(t){t.style.width=e})):"pageHeigt"===t&&(a.page.style.height=e,"pc"===n.type&&(n.style.height=e)),U.e.publish("h5ds.setHistory")})}},{key:"changeVal",value:function(e,t){this.setState(zo()({},t,e),this.setInfo)}},{key:"render",value:function(){var e=this;if(this.page=this.props.h5ds.getPage(),this.page){var t=this.state,a=t.slider,n=t.name,o=(t.id,t.className,t.desc),r=F()(t,["slider","name","id","className","desc"]),s=Rt.a.TabPane,i=a.lock,c=a.autoplay,l=a.time,p=Ao.a.TextArea;return q.a.createElement("div",{className:"h5ds-pageset"},q.a.createElement(Rt.a,{defaultActiveKey:"1",className:"h5ds-basic-tabs"},q.a.createElement(s,{key:"1",tab:"页面样式"},q.a.createElement(De,{span:1},q.a.createElement(Ne,{name:"页面名字"},q.a.createElement(Ao.a,{size:"small",value:n,onChange:function(t){return e.changeVal(t.target.value,"name")}})),q.a.createElement(Ne,{name:"页面描述"},q.a.createElement(p,{value:o,rows:4,onChange:function(t){return e.changeVal(t.target.value,"desc")}}))),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"页面宽度"},q.a.createElement(Ee.a,{disabled:"phone"===Tt.e.appType,className:"h5ds-scroll-BasicSet",size:"small",min:Tt.e.appWidth,max:1/0,placeholder:"宽度",value:this.page.style.width,onChange:function(t){return e.onChangeSize(t,"appWidth")}}))),q.a.createElement(De,{span:2},q.a.createElement(Ne,{name:"页面高度"},q.a.createElement(Ee.a,{className:"h5ds-scroll-BasicSet",size:"small",min:Tt.e.appHeight,max:1/0,placeholder:"高度",value:this.page.style.height,onChange:function(t){return e.onChangeSize(t,"pageHeigt")}}))),q.a.createElement(De,{span:"1"},q.a.createElement(Ho,{uploadSet:this.props.scope.options.uploadBase64,onChange:this.backGroundChange,data:r})),q.a.createElement(De,{span:"1"},q.a.createElement(Ne,{name:"锁定翻页"},q.a.createElement(Fe.a,{onChange:function(t){return e.switchDo(t,"lock")},checked:!!i}),q.a.createElement("i",{title:"开启后，页面不能触发翻页效果！",className:"h5ds-ico h5ds-ico-bangzhu"})),q.a.createElement(Ne,{name:"自动翻页"},q.a.createElement(Fe.a,{onChange:function(t){return e.switchDo(t,"autoplay")},checked:!!c}),q.a.createElement("i",{title:"开启后，页面会自动播放！",className:"h5ds-ico h5ds-ico-bangzhu"})),c&&q.a.createElement(Ot,{name:"翻页时间",onChange:function(t){e.switchDo(t,"time")},tipFormatter:null,step:1,min:0,max:100,value:l})))))}return q.a.createElement("div",{className:"h5ds-pageset-null"},"未选中任何页面")}}]),t}(G.Component),H()(Xa.prototype,"switchDo",[U.c],Object.getOwnPropertyDescriptor(Xa.prototype,"switchDo"),Xa.prototype),H()(Xa.prototype,"backGroundChange",[U.c],Object.getOwnPropertyDescriptor(Xa.prototype,"backGroundChange"),Xa.prototype),H()(Xa.prototype,"onChangeSize",[U.c],Object.getOwnPropertyDescriptor(Xa.prototype,"onChangeSize"),Xa.prototype),H()(Xa.prototype,"changeVal",[U.c],Object.getOwnPropertyDescriptor(Xa.prototype,"changeVal"),Xa.prototype),Ja=Xa))||Ja)||Ja),pr=Object(zt.inject)("h5ds")(Ka=Object(zt.observer)(Ka=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"render",value:function(){var e=this.props.h5ds.edata,t=e.setType,a=e.selectType,n=e.selectFixed,o=e.selectPage,r=e.selectPopup,s=null;switch(t){case"layer":s=q.a.createElement(cr,null);break;case"group":s=q.a.createElement(Bo,null);break;case"page":s=q.a.createElement(lr,{key:a+n+o+r});break;case"app":s=q.a.createElement(Ro,null)}return q.a.createElement("div",{className:"h5ds-editarea h5ds-js-setting"},s)}}]),t}(G.Component))||Ka)||Ka,ur=(a(143),Object(zt.inject)("h5ds")(Qa=Object(zt.observer)((Za=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"closeList",value:function(){this.props.h5ds.edata.eventListShow=!1}},{key:"addEvent",value:function(e){var t=this;this.layer=this.props.h5ds.getLayer();var a=e.eventId,n=e.name,o=e.eventParam;Object(Y.transaction)(function(){t.layer.events||(t.layer.events=[]),t.layer.events.push({id:U.i.randomID(),eventId:a,name:n,eventParam:o}),t.props.h5ds.edata.eventListShow=!1}),U.e.publish("h5ds.setHistory")}},{key:"render",value:function(){var e=this,t=Rt.a.TabPane,a=this.props.h5ds.edata.eventListShow,n=window.innerHeight-120,o=["h5ds-animatelist","h5ds-eventlist"];return a&&o.push("h5ds-animatelist-show"),q.a.createElement("div",{className:o.join(" ")},q.a.createElement("a",{onClick:this.closeList,className:"h5ds-basic-animatelist-close"},q.a.createElement(dt.a,{type:"right",theme:"outlined"})),q.a.createElement(Rt.a,{size:"small",defaultActiveKey:"1"},q.a.createElement(t,{tab:"事件列表",key:"1"},q.a.createElement("ul",{style:{height:n},className:"h5ds-global-clearfix"},Jo.map(function(t){var a=t.name,n=t.eventId,o=t.icon;return q.a.createElement("li",{key:n,className:"h5ds-event-item",onClick:function(){e.addEvent(t)}},o,q.a.createElement("span",null,a))})))))}}]),t}(G.Component),H()(Za.prototype,"closeList",[U.c],Object.getOwnPropertyDescriptor(Za.prototype,"closeList"),Za.prototype),H()(Za.prototype,"addEvent",[U.c],Object.getOwnPropertyDescriptor(Za.prototype,"addEvent"),Za.prototype),Qa=Za))||Qa)||Qa),hr=(a(80),a(65)),dr=a.n(hr),mr=(a(144),a(145),en=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"onClick",value:function(e){this.props.onClick&&this.props.onClick(e,this.data)}},{key:"render",value:function(){this.data=this.props.data;var e=this.props.data,t=e.pid,a=e.name,n=void 0===a?"未命名":a,o=e.version,r=void 0===o?"0.0.1":o,s=e.icon;return q.a.createElement("div",{className:"h5ds-plugin-item"},q.a.createElement("div",{onClick:this.onClick,className:"h5ds-plugin-span h5ds-plugin-pic"},s||q.a.createElement("i",{className:"h5ds-ico h5ds-ico-domnode"})),q.a.createElement("div",{className:"h5ds-plugin-span h5ds-plugin-info"},q.a.createElement("h1",{onClick:this.onClick},n),q.a.createElement("p",null,q.a.createElement("em",null,"version:")," ",r),q.a.createElement("p",null,q.a.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},"插件详情"))))}}]),t}(G.Component),H()(en.prototype,"onClick",[U.c],Object.getOwnPropertyDescriptor(en.prototype,"onClick"),en.prototype),en),yr=Object(zt.inject)("h5ds","scope")(tn=Object(zt.observer)((an=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={visible:!1,width:window.innerWidth,layerMenus:[]},a.eventId=U.i.randomID(),a}return v()(t,e),h()(t,[{key:"addLayer",value:function(e){U.e.publish("h5ds.destoryControl"),this.setState({visible:!1});for(var t=this.props.h5ds,a=this.props.scope.pluginsKey,n=arguments.length,o=new Array(1<n?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];var s=t.getJsonByPid.apply(t,[a,e].concat(o)),i=!!a[e]&&a[e].selectIcon;if("h5ds_shape"!==s.pid){var c=$(".h5ds-canvas-realsize").position(),l=c.top,p=c.left;(l=-l/t.edata.phoneScale)<0&&(l=0),(p=-p/t.edata.phoneScale)<0&&(p=0),s.style.top=l+20,s.style.left=p+20}function u(){t.addLayer(s),t.edata.keys=U.i.randomID(),t.setLayer(0)}void 0===i?u():i instanceof Promise?i(E()({pid:e},this.props)).then(function(){u()}).fail(function(e){console.warn("layer添加错误",e),Q.a.error("添加layer错误！")}):i(E()({pid:e},this.props))}},{key:"initLayerMenusData",value:function(){var e=[];this.props.scope.plugins.forEach(function(t){var a=t.name,n=t.icon,o=t.pid;"h5ds_combin"!==o&&e.push({name:a,icon:n,pid:o})}),this.setState({layerMenus:e})}},{key:"showModal",value:function(){this.setState({visible:!0})}},{key:"closeModal",value:function(){this.setState({visible:!1})}},{key:"componentDidMount",value:function(){var e=this;this.initLayerMenusData(),$(window).on("resize.h5ds.layermenu",function(){e.setState({width:window.innerWidth})})}},{key:"componentWillUnmount",value:function(){$(window).off("resize.h5ds.layermenu")}},{key:"render",value:function(){var e=this,t=this.state,a=t.visible,n=t.layerMenus,o=t.width;return q.a.createElement("div",{className:"h5ds-layermenu-inner h5ds-js-layermenu"},q.a.createElement("ul",{className:"h5ds-layermenu-moreuse"},1340<o?n.map(function(t,a){return 5<a?null:q.a.createElement("li",{key:a,className:"fun",onClick:function(){return e.addLayer(t.pid)}},q.a.createElement("a",null,t.icon||q.a.createElement("i",{className:"h5ds-ico h5ds-ico-domnode"}),q.a.createElement("span",null,t.name)))}):null,q.a.createElement("li",{className:"fun"},q.a.createElement("a",{onClick:this.showModal},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-icon3"}),q.a.createElement("span",null,"扩展")))),q.a.createElement(be,{className:"h5ds-modal-plus",show:a,title:"插件扩展",close:this.closeModal},q.a.createElement("div",{className:"h5ds-plugins"},n.map(function(t,a){return q.a.createElement(mr,{set:"禁用",onClick:function(){return e.addLayer(t.pid)},data:t,key:a})}))))}}]),t}(G.Component),H()(an.prototype,"addLayer",[U.c],Object.getOwnPropertyDescriptor(an.prototype,"addLayer"),an.prototype),H()(an.prototype,"initLayerMenusData",[U.c],Object.getOwnPropertyDescriptor(an.prototype,"initLayerMenusData"),an.prototype),H()(an.prototype,"showModal",[U.c],Object.getOwnPropertyDescriptor(an.prototype,"showModal"),an.prototype),H()(an.prototype,"closeModal",[U.c],Object.getOwnPropertyDescriptor(an.prototype,"closeModal"),an.prototype),tn=an))||tn)||tn,fr=(a(146),a(147),a(49)),gr=Object(zt.inject)("h5ds","scope")(nn=Object(zt.observer)((on=function(e){function t(){var e,a;p()(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=m()(this,(e=f()(t)).call.apply(e,[this].concat(o)))).state={url:"",keys:+new Date,isTemporaryUrl:!1},a}return v()(t,e),h()(t,[{key:"reRender",value:function(){this.setState({keys:+new Date})}},{key:"publishApp",value:function(){var e=this;this.props.publishApp().then(function(t){var a=e.props.scope.options,n=a.publishHost,o=void 0===n?"":n,r=a.publishParam,s="".concat(o,"?appId=").concat(t);if(r)for(var i in r)s+="&".concat(i,"=").concat(r[i]);e.setState({url:s,isTemporaryUrl:!1})})}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.reRender);var t=this.props.scope.options,a=t.getPrivewToken,n=t.publishHost,o=t.publishParam;a?(console.log("获取临时token"),this.props.saveApp().then(function(){a(e.props.appId).then(function(t){var a="".concat(n,"?appId=").concat(e.props.appId,"&auth=").concat(t);if(o)for(var r in o)a+="&".concat(r,"=").concat(o[r]);e.setState({url:a,isTemporaryUrl:!0})})})):console.warn("没有设置临时二维码接口：getPrivewToken")}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.reRender)}},{key:"render",value:function(){var e=this,t={width:window.innerWidth,height:window.innerHeight},a=this.props.scope,n=a.pluginsKey,o=a.scripts;return q.a.createElement("div",{className:"h5ds-pc-preview"},q.a.createElement("div",{className:"h5ds-pc-preview-bodyer"},q.a.createElement(fr.a,{ref:function(t){return e.H5SwiperRef=t},style:t,plugins:{pluginsKey:n,scripts:o},data:this.props.data,renderIn:Tt.g.RENDER_IN_PREVIEW})),q.a.createElement("div",{className:"h5ds-pc-preview-down"},q.a.createElement(fe.a,{type:"primary",loading:!this.state.url,icon:"qrcode"},this.state.url?q.a.createElement("a",{href:this.state.url,rel:"noopener noreferrer",target:"_blank"},this.state.isTemporaryUrl?"临时URL":"正式URL"):"loading..."),q.a.createElement(fe.a,{onClick:this.props.close,type:"primary",icon:"gateway"},"继续编辑"),this.props.scope.options.AsTemplate?q.a.createElement(this.props.scope.options.AsTemplate,{appId:this.props.scope.options.appId,data:JSON.stringify(this.props.h5ds.data)}):q.a.createElement(fe.a,{onClick:this.publishApp,type:"primary",icon:"check-circle"},"确认发布")))}}]),t}(G.Component),H()(on.prototype,"reRender",[U.c],Object.getOwnPropertyDescriptor(on.prototype,"reRender"),on.prototype),H()(on.prototype,"publishApp",[U.c],Object.getOwnPropertyDescriptor(on.prototype,"publishApp"),on.prototype),nn=on))||nn)||nn,vr=(a(148),a(87)),br=a.n(vr),wr=a(88),kr=a.n(wr),Er=Object(zt.inject)("h5ds","scope")(rn=Object(zt.observer)((sn=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={viewType:"iphone6",url:"",isTemporaryQrcode:!1,style:{width:320,height:514}},a}return v()(t,e),h()(t,[{key:"changeViewType",value:function(e){this.setState({viewType:e.target.value,style:{width:320,height:"iphoneX"===e.target.value?640:514}},this.H5SwiperRef.updateSwiper)}},{key:"changeMainImg",value:function(){var e=this;U.e.publish("h5ds.img.modal.show",{callback:function(t){e.props.data.img=t}})}},{key:"changeName",value:function(e){this.props.data.name=e.target.value}},{key:"changeDesc",value:function(e){this.props.data.desc=e.target.value}},{key:"publishApp",value:function(){var e=this;this.props.publishApp().then(function(t){var a=e.props.scope.options,n=a.publishHost,o=a.publishParam,r="".concat(n,"?appId=").concat(t);if(o)for(var s in o)r+="&".concat(s,"=").concat(o[s]);e.setState({url:r,isTemporaryQrcode:!1})})}},{key:"componentDidMount",value:function(){var e=this,t=this.props.scope.options,a=t.getPrivewToken,n=t.publishHost,o=void 0===n?"":n,r=t.publishParam;a?(console.log("获取临时token"),this.props.saveApp().then(function(){a(e.props.appId).then(function(t){var a="".concat(o,"?appId=").concat(e.props.appId,"&auth=").concat(t);if(r)for(var n in r)a+="&".concat(n,"=").concat(r[n]);e.setState({url:a,isTemporaryQrcode:!0})})})):console.warn("没有设置临时二维码接口：getPrivewToken")}},{key:"render",value:function(){var e=this,t=this.state,a=t.style,n=t.isTemporaryQrcode,o=Ao.a.TextArea,r=this.props.data,s=this.props.scope.pluginsKey;return q.a.createElement("div",{className:"h5ds-phone-preview"},q.a.createElement("div",{className:"h5ds-phone-preview-box"},q.a.createElement("div",{className:"h5ds-phone-preview-content"},q.a.createElement("div",{className:"h5ds-phone-preview-view"},q.a.createElement("div",{className:"h5ds-phone-preview-header"},q.a.createElement(Lo.a.Group,{onChange:this.changeViewType,defaultValue:"iphone6",buttonStyle:"solid"},q.a.createElement(Lo.a.Button,{value:"iphone6"},"iphone6"),q.a.createElement(Lo.a.Button,{value:"iphoneX"},"iphoneX"))),q.a.createElement("div",{className:"h5ds-phone-preview-bodyer"},q.a.createElement(fr.a,{ref:function(t){return e.H5SwiperRef=t},style:a,plugins:{pluginsKey:s},data:r,renderIn:Tt.g.RENDER_IN_PREVIEW}))),q.a.createElement("div",{className:"h5ds-phone-preview-info"},q.a.createElement("div",{className:"h5ds-phone-preview-wx clearfix"},q.a.createElement("div",{className:"h5ds-phone-preview-img",onClick:this.changeMainImg},q.a.createElement("img",{src:r.img,alt:""})),q.a.createElement("div",{className:"h5ds-phone-preview-title"},q.a.createElement(Ao.a,{onChange:this.changeName,value:r.name})),q.a.createElement("div",{className:"h5ds-phone-preview-desc"},q.a.createElement(o,{onChange:this.changeDesc,style:{height:118},value:r.desc,rows:4}))),q.a.createElement("div",{className:"h5ds-phone-preview-wx clearfix"},q.a.createElement("div",{className:"h5ds-phone-preview-img"},this.state.url&&q.a.createElement(kr.a,{fgColor:"rgba(0,0,0,1)",bgColor:"rgba(255,255,255,1)",size:160,level:"M",value:this.state.url})),q.a.createElement("div",{className:"h5ds-phone-preview-desc"},q.a.createElement(o,{style:{height:160},rows:4,value:this.state.url}))),q.a.createElement("div",{className:"h5ds-phone-preview-down"},q.a.createElement(br.a,{message:n?"以上为临时二维码和链接，10分钟有效，发布后生成永久二维码和链接":"以上为正式二维码和链接，永久有效",type:n?"warning":"success"}),q.a.createElement("br",null),q.a.createElement(fe.a,{onClick:this.props.close,type:"primary",icon:"gateway"},"继续编辑"),"  ",this.props.scope.options.AsTemplate?q.a.createElement(this.props.scope.options.AsTemplate,{appId:this.props.scope.options.appId,data:JSON.stringify(this.props.h5ds.data)}):q.a.createElement(fe.a,{onClick:this.publishApp,type:"primary",icon:"check-circle"},"确认发布"))))))}}]),t}(G.Component),H()(sn.prototype,"changeViewType",[U.c],Object.getOwnPropertyDescriptor(sn.prototype,"changeViewType"),sn.prototype),H()(sn.prototype,"changeMainImg",[U.c],Object.getOwnPropertyDescriptor(sn.prototype,"changeMainImg"),sn.prototype),H()(sn.prototype,"changeName",[U.c],Object.getOwnPropertyDescriptor(sn.prototype,"changeName"),sn.prototype),H()(sn.prototype,"changeDesc",[U.c],Object.getOwnPropertyDescriptor(sn.prototype,"changeDesc"),sn.prototype),H()(sn.prototype,"publishApp",[U.c],Object.getOwnPropertyDescriptor(sn.prototype,"publishApp"),sn.prototype),rn=sn))||rn)||rn,xr=Object(zt.inject)("h5ds","scope")(cn=Object(zt.observer)((ln=function(e){function t(){var e,a;p()(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=m()(this,(e=f()(t)).call.apply(e,[this].concat(o)))).state={loading:!1,show:!1},a}return v()(t,e),h()(t,[{key:"modalShow",value:function(){this.setState({show:!0})}},{key:"onClose",value:function(){this.setState({show:!1})}},{key:"saveApp",value:function(){var e=this;this.setState({loading:!0});var t=this.props.scope.options,a=t.saveApp,n=t.appId,o=this.props.h5ds.data;return o.plugins=U.b.getPidByData(o),new Promise(function(t,r){try{a({plugins:_()(o.plugins),updateTime:+new Date,appId:n,data:Object(Y.toJS)(o)}).then(function(){e.setState({loading:!1}),t()})}catch(t){console.error(t),Q.a.error("请传入props.saveApp 方法，且必须是一个Promise对象"),r()}})}},{key:"publishApp",value:function(){var e=this.props.h5ds.data;e.plugins=U.b.getPidByData(e);var t=this.props.scope.options,a=t.publishApp,n=t.appId;try{return a({plugins:_()(e.plugins),updateTime:+new Date,appId:n,data:Object(Y.toJS)(e)}).then(function(){return Q.a.success("发布成功！"),n})}catch(e){console.error(e),Q.a.error("请配置发布props.publishApp，且必须是一个Promise对象")}}},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.show,o=this.props.h5ds.data;return q.a.createElement("div",{className:"h5ds-publish"},q.a.createElement("a",{className:"h5ds-btn-min",onClick:function(){return e.saveApp().then(function(){Q.a.success("保存成功！")})}},a?q.a.createElement("span",null,q.a.createElement(dt.a,{type:"loading"})," 保存中"):q.a.createElement("span",null,q.a.createElement("i",{className:"h5ds-ico h5ds-ico-baocun"})," 保存")),"  ",q.a.createElement("a",{onClick:this.modalShow,className:"h5ds-btn-min h5ds-js-publish"},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-fabu"})," 预览/发布"),q.a.createElement(be,{className:"h5ds-modal-source",show:n,close:this.onClose},"pc"===o.type?q.a.createElement(gr,{appId:this.props.scope.options.appId,publishApp:this.publishApp,close:this.onClose,scope:this.props.scope,saveApp:this.saveApp,data:o}):q.a.createElement(Er,{appId:this.props.scope.options.appId,publishApp:this.publishApp,close:this.onClose,scope:this.props.scope,saveApp:this.saveApp,data:o})))}}]),t}(G.Component),H()(ln.prototype,"modalShow",[U.c],Object.getOwnPropertyDescriptor(ln.prototype,"modalShow"),ln.prototype),H()(ln.prototype,"onClose",[U.c],Object.getOwnPropertyDescriptor(ln.prototype,"onClose"),ln.prototype),H()(ln.prototype,"saveApp",[U.c],Object.getOwnPropertyDescriptor(ln.prototype,"saveApp"),ln.prototype),H()(ln.prototype,"publishApp",[U.c],Object.getOwnPropertyDescriptor(ln.prototype,"publishApp"),ln.prototype),cn=ln))||cn)||cn,Or=Object(zt.inject)("h5ds","scope")(pn=Object(zt.observer)((un=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"clears",value:function(){U.i.clearStorage("H5DS_APP_DATA"),U.i.clearStorage("H5DS_APP_EDATA"),U.i.clearStorage("H5DS_APP_ID"),window.location.reload()}},{key:"setApp",value:function(e){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),U.e.publish("h5ds.destoryControl"),this.props.h5ds.setType("app")}},{key:"help",value:function(){$.helps({show:!0,data:[{dom:".h5ds-js-h5set",content:"【整体设置】点击此处设置H5页面的整体内容：背景，主图，介绍, 背景音乐，加载效果等",pos:"bottom"},{dom:".h5ds-js-clearlocal",content:"【清除缓存】这里清除本地缓存",pos:"bottom"},{dom:".h5ds-js-publish",content:"【预览/发布】做好之后，发布应用点击这里发布应用或者预览应用，全部OK后生成二维码",pos:"bottom"},{dom:".h5ds-js-pagelist",content:"【页面列表】此处主要展示页面的列表，也可以在【模板中心】中选择模板进行页面添加",pos:"right"},{dom:".h5ds-js-temps",content:"【模板中心】所有页面模板都在这里了，你可以选择系统提供的模板，也可以选择自己保存的模板",pos:"right"},{dom:".h5ds-js-layermenu",content:"【图层】页面里面所有的元素叫做图层，你可以在这里选择需要创建的图层，也可以点击“。。。”展开图层，选择更多图层",pos:"bottom"},{dom:".h5ds-js-setting",content:"【设置区域】只需要记住，页面，图层，动画，交互等任何设置相关的操作都在这里进行就可以了。顶部会显示：当前选中的对象",pos:"left"},{dom:".h5ds-js-canvas",content:"【可视化区域】页面的可视化界面，所见即所得",pos:"left"},{dom:".h5ds-js-layerlist",content:"【图层列表】可以展开图层列表，这里有图层相关的一些操作！",pos:"bottom"},{dom:".h5ds-js-shortcut",content:"【快捷操作】这里有一些快捷操作的方法 <br/>【ctrl+s 保存预览APP】<br/>【ctrl+z 撤销】<br/>【ctrl+y 恢复】<br/>【ctrl+ - 缩小画布】<br/>【ctrl+ + 放大画布】<br/>【ctrl+ p 播放动画】<br/>【ctrl+g 合并图层】<br/>【ctrl+u 取消合并】<br/>【ctrl+ h 显示网格】<br/>【ctrl + d 删除】<br/>【上，下，左，右 微调距离】<br/>【shift + 上，下，左，右 大幅度调距离】",pos:"left"}]})}},{key:"changeAppType",value:function(e){var t=this;Object(Y.transaction)(function(){t.props.h5ds.data.type=e,t.props.scope.resetCanvasSize(),U.e.publish("h5ds.setHistory")})}},{key:"componentDidMount",value:function(){var e=this.props.h5ds.getPage();e&&(this.props.h5ds.edata.pageSize={width:e.style.width,height:e.style.height})}},{key:"onChangeTheme",value:function(e){document.querySelector("body").classList.toggle("h5ds-theme-simple")}},{key:"render",value:function(){var e=this,t=this.props.h5ds.data,a=this.props.scope.options.headerNav;return q.a.createElement("div",{className:"h5ds-header"},q.a.createElement("div",{className:"h5ds-logo"},q.a.createElement("a",{rel:"noopener noreferrer",href:"http://www.h5ds.com"},"H5",q.a.createElement("span",null,"DS"),q.a.createElement("em",null,"power by h5ds"))),q.a.createElement("div",{className:"h5ds-h5type"},q.a.createElement("a",{onClick:function(){return e.changeAppType("phone")},className:"phone"===t.type?" active":""},"Phone"),q.a.createElement("a",{onClick:function(){return e.changeAppType("pc")},className:"pc"===t.type?" active":""},"PC")),q.a.createElement("div",{className:"h5ds-layermenu"},q.a.createElement(yr,null)),q.a.createElement("div",{className:"h5ds-publish-box"},q.a.createElement("div",{className:"h5ds-h5set"},q.a.createElement("a",{className:"h5ds-basic-btn-min",onClick:this.help},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-bangzhu"})," 帮助")," ",q.a.createElement("a",{className:"h5ds-btn-yellow h5ds-js-h5set",onClick:this.setApp},"全局设置"))," ",q.a.createElement(dr.a,{onConfirm:this.clears,title:q.a.createElement("div",{style:{width:300}},"清除缓存后，当前数据将被清空，然后从服务器重新加载数据！是否要清除？"),okText:"确定",cancelText:"取消"},q.a.createElement("a",{className:"h5ds-basic-btn-min h5ds-js-clearlocal"},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-Icon_huancun"})," 清缓存"))," ",q.a.createElement(xr,null)," ",a?q.a.createElement(a,null):null))}}]),t}(G.Component),H()(un.prototype,"clears",[U.c],Object.getOwnPropertyDescriptor(un.prototype,"clears"),un.prototype),H()(un.prototype,"setApp",[U.c],Object.getOwnPropertyDescriptor(un.prototype,"setApp"),un.prototype),H()(un.prototype,"help",[U.c],Object.getOwnPropertyDescriptor(un.prototype,"help"),un.prototype),H()(un.prototype,"changeAppType",[U.c],Object.getOwnPropertyDescriptor(un.prototype,"changeAppType"),un.prototype),H()(un.prototype,"onChangeTheme",[U.c],Object.getOwnPropertyDescriptor(un.prototype,"onChangeTheme"),un.prototype),pn=un))||pn)||pn,Sr=(a(149),Object(zt.inject)("h5ds","scope")(hn=Object(zt.observer)((dn=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={show:!0,editLayerName:"",editLayerIndex:null},a}return v()(t,e),h()(t,[{key:"copyLayer",value:function(e,t){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),this.props.h5ds.copyLayer(t),U.e.publish("h5ds.setHistory")}},{key:"setLayer",value:function(e,t){var a=this;if(t)if($(t.currentTarget).find(".h5ds-layerlist-locklayer-active")[0])Q.a.warn("请先解锁图层");else if(t&&t.ctrlKey){var n=this.props.h5ds,o=n.edata,r=n.getPageDom,s=n.getPageLayerDom,i=n.getLayers;Object(Y.transaction)(function(){o.selectGroup||(o.selectGroup=[],r().find(".h5ds-control")[0]&&o.selectGroup.push(o.selectLayer)),-1===o.selectGroup.indexOf(e)?o.selectGroup.push(e):o.selectGroup.splice(o.selectGroup.findIndex(function(t){return t===e}),1),o.selectGroup=_()(new Set(o.selectGroup)),1<o.selectGroup.length&&(o.selectLayer=null,o.setType="group"),qt(r,o.selectGroup),Ut(i,s,o)})}else Object(Y.transaction)(function(){a.props.h5ds.edata.selectGroup=!1,a.props.h5ds.setLayer(e),U.e.publish("h5ds.initControl")})}},{key:"delLayer",value:function(e,t){var a=this;e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),Object(Y.transaction)(function(){a.props.h5ds.delLayer(t),U.e.publish("h5ds.setHistory")})}},{key:"viewLayer",value:function(e,t){var a=this;e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),Object(Y.transaction)(function(){t.set.hide=!t.set.hide,a.props.h5ds.edata.layerListKeys=U.i.randomID(),a.props.h5ds.updateCanvas()})}},{key:"locklayer",value:function(e,t){var a=this;e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),Object(Y.transaction)(function(){t.set.lock=!t.set.lock,a.props.h5ds.edata.layerListKeys=U.i.randomID(),a.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.destoryControl")})}},{key:"showList",value:function(){var e=this.state.show;e=!e,this.setState({show:e})}},{key:"onBlurName",value:function(e,t){t.name=e.target.value,this.setState({editLayerIndex:null,editLayerName:""})}},{key:"onChangeName",value:function(e){this.setState({editLayerName:e.target.value})}},{key:"onDoubleClickChangeName",value:function(e,t,a){e.stopPropagation(),this.setState({editLayerIndex:t,editLayerName:a.name||a.type})}},{key:"componentDidMount",value:function(){var e=this;$("#h5dsLayerList").on("uniqend",function(t,a){t.stopPropagation(),e.props.h5ds.exChangeLayer(a.from,a.to),e.setLayer(a.to)})}},{key:"componentWillUnmount",value:function(){$("#h5dsLayerList").off("uniqend")}},{key:"render",value:function(){var e=this,t=this.props.h5ds.edata,a=t.selectLayer,n=(t.selectPage,t.selectFixed,t.selectPopup,t.selectType,t.selectGroup),o=this.state,r=o.show,s=o.editLayerIndex,i=o.editLayerName,c=this.props.h5ds.getLayers()||[];return q.a.createElement("div",{className:"h5ds-layerlist h5ds-js-layerlist h5ds-drag","data-dragset":'{"limit":true, "undrag":["#h5dsLayerList"]}'},q.a.createElement("h1",{className:"h5ds-global-clearfix"},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-caidan"}),q.a.createElement("span",null,"图层列表"),q.a.createElement("a",{onClick:this.showList},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-a1down"}))),q.a.createElement("ul",{id:"h5dsLayerList",className:"h5ds-uniqlist",style:{display:r?"block":"none"}},0<c.length?c.map(function(t,o){var r=["h5ds-layerlist-showlayer"],c=["h5ds-layerlist-locklayer"];t.set.hide&&r.push("h5ds-layerlist-hidelayer-active"),t.set.lock&&c.push("h5ds-layerlist-locklayer-active");var l=["h5ds-js-layerlist-item"];return n?-1!==n.indexOf(o)&&l.push("h5ds-layerlist-active"):a===o&&l.push("h5ds-layerlist-active"),q.a.createElement("li",{onClick:function(t){return e.setLayer(o,t)},"data-keyid":t.keyid,key:t.keyid,className:l.join(" ")},q.a.createElement("a",{onClick:function(a){return e.viewLayer(a,t)},className:r.join(" ")},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-yanjing"})),q.a.createElement("span",{className:"name",onDoubleClick:function(a){return e.onDoubleClickChangeName(a,o,t)}},s===o?q.a.createElement("input",{onBlur:function(a){return e.onBlurName(a,t)},value:i,onChange:e.onChangeName}):t.name||t.type),q.a.createElement("a",{onClick:function(a){return e.delLayer(a,o,t)},className:"h5ds-layerlist-dellayer",title:"删除图层"},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-icodel"})),q.a.createElement("a",{onClick:function(t){return e.copyLayer(t,o)},className:"h5ds-layerlist-copylayer",title:"复制图层"},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-fuzhi"})),q.a.createElement("a",{onClick:function(a){return e.locklayer(a,t)},className:c.join(" "),title:"锁定图层"},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-suo"})))}):q.a.createElement("li",{className:"h5ds-layerlist-null"},q.a.createElement("span",null,"暂无图层"))))}}]),t}(G.Component),H()(dn.prototype,"copyLayer",[U.c],Object.getOwnPropertyDescriptor(dn.prototype,"copyLayer"),dn.prototype),H()(dn.prototype,"setLayer",[U.c],Object.getOwnPropertyDescriptor(dn.prototype,"setLayer"),dn.prototype),H()(dn.prototype,"delLayer",[U.c],Object.getOwnPropertyDescriptor(dn.prototype,"delLayer"),dn.prototype),H()(dn.prototype,"viewLayer",[U.c],Object.getOwnPropertyDescriptor(dn.prototype,"viewLayer"),dn.prototype),H()(dn.prototype,"locklayer",[U.c],Object.getOwnPropertyDescriptor(dn.prototype,"locklayer"),dn.prototype),H()(dn.prototype,"showList",[U.c],Object.getOwnPropertyDescriptor(dn.prototype,"showList"),dn.prototype),H()(dn.prototype,"onBlurName",[U.c],Object.getOwnPropertyDescriptor(dn.prototype,"onBlurName"),dn.prototype),H()(dn.prototype,"onChangeName",[U.c],Object.getOwnPropertyDescriptor(dn.prototype,"onChangeName"),dn.prototype),H()(dn.prototype,"onDoubleClickChangeName",[U.c],Object.getOwnPropertyDescriptor(dn.prototype,"onDoubleClickChangeName"),dn.prototype),hn=dn))||hn)||hn),Cr=(a(150),Object(zt.inject)("h5ds","scope")(mn=Object(zt.observer)((yn=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).pages=null,a}return v()(t,e),h()(t,[{key:"setPages",value:function(){var e=this.props.h5ds,t=e.data,a=e.edata;this.pages=Object(Y.toJS)(t[a.selectType]||[])}},{key:"copyPage",value:function(e,t){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),this.props.h5ds.copyPage(t),this.setPage(t+1),U.e.publish("h5ds.setHistory")}},{key:"delPage",value:function(e,t){e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),this.props.h5ds.delPage(t),U.e.publish("h5ds.setHistory"),this.setPage(0)}},{key:"savePage",value:function(){$(".h5ds-js-savepage").trigger("click")}},{key:"setPage",value:function(e){var t=this,a=this.props.h5ds.edata.selectType;U.e.publish("h5ds.destoryControl",{pageNum:e,selectType:a}),Object(Y.transaction)(function(){t.props.h5ds.edata.keys=U.i.randomID(),U.e.publish("h5ds.setHistory")}),$(".h5ds-center").scrollTop(0)}},{key:"setFixedsName",value:function(e){var t="";switch(e){case 0:t="上层浮动";break;case 1:t="底层浮动"}return t}},{key:"componentDidMount",value:function(){var e=this;$("#h5dsPageListId").on("uniqend",function(t,a){e.props.h5ds.exChangePage(a.from,a.to),U.e.publish("h5ds.setHistory")}),this.setPages()}},{key:"componentWillUnmount",value:function(){$("#h5dsPageListId").off("uniqend")}},{key:"componentWillReact",value:function(){console.log("pageList/List.js render"),this.setPages()}},{key:"render",value:function(){var e=this,t=this.props.h5ds.edata,a=t.selectType,n=(t.pageListKeys,[]);"fixeds"!==a&&n.push("h5ds-uniqlist");var o=this.props.h5ds.getPageNum(),r={pluginsKey:this.props.scope.pluginsKey,scripts:this.props.scope.scripts};return console.log("重新渲染pageList.jsx",this.pages&&this.pages.length),q.a.createElement("ul",{className:n.join(" "),id:"h5dsPageListId"},this.pages?this.pages.map(function(t,n){var s=t.style,i=s.width,c=void 0===i?320:i,l=s.height,p=void 0===l?514:l,u=F()(s,["width","height"]);return q.a.createElement("li",{key:t.keyid,className:"h5ds-pagelist-page-item"+(o===n?" h5ds-pagelist-active":"")},q.a.createElement("div",{className:"h5ds-pagelist-page-content",onClick:function(){return e.setPage(n)}},"fixeds"===a&&q.a.createElement("div",{className:"h5ds-pagelist-fixeds-info"},e.setFixedsName(n)),q.a.createElement("div",{className:"h5ds-page-min",style:E()({transform:"scale(".concat(100/c,")"),width:c,height:p},u)},q.a.createElement(Gt.c,{plugins:r,data:t,renderIn:Tt.g.RENDER_IN_PAGELIST}))),q.a.createElement("div",{className:"h5ds-pagelist-page-info"},"fixeds"!==a&&[q.a.createElement("a",{key:"1",onClick:function(t){return e.copyPage(t,n)},className:"h5ds-pagelist-copy-page",title:"复制页面"},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-fuzhi"})),q.a.createElement("a",{key:"2",onClick:function(e){return e.nativeEvent.stopImmediatePropagation()},className:"h5ds-pagelist-del-page",title:"删除页面"},q.a.createElement(dr.a,{placement:"rightBottom",title:"是否删除该页面？",onConfirm:function(t){return e.delPage(t,n)}},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-icodel"})))],q.a.createElement("a",{onClick:function(t){return e.savePage(t,n)},className:"h5ds-pagelist-save-page",title:"收藏页面"},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-shoucang"}))))}):q.a.createElement("div",{className:"h5ds-pagelist-loading"},"页面载入中..."))}}]),t}(G.Component),H()(yn.prototype,"setPages",[U.c],Object.getOwnPropertyDescriptor(yn.prototype,"setPages"),yn.prototype),H()(yn.prototype,"copyPage",[U.c],Object.getOwnPropertyDescriptor(yn.prototype,"copyPage"),yn.prototype),H()(yn.prototype,"delPage",[U.c],Object.getOwnPropertyDescriptor(yn.prototype,"delPage"),yn.prototype),H()(yn.prototype,"savePage",[U.c],Object.getOwnPropertyDescriptor(yn.prototype,"savePage"),yn.prototype),H()(yn.prototype,"setPage",[U.c],Object.getOwnPropertyDescriptor(yn.prototype,"setPage"),yn.prototype),H()(yn.prototype,"setFixedsName",[U.c],Object.getOwnPropertyDescriptor(yn.prototype,"setFixedsName"),yn.prototype),mn=yn))||mn)||mn),Dr=Object(zt.inject)("h5ds")(fn=Object(zt.observer)((gn=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={selected:"pages"},a}return v()(t,e),h()(t,[{key:"changeTabs",value:function(e){this.setState({selected:e}),this.props.h5ds.setPage(0,e),U.e.publish("h5ds.destoryControl")}},{key:"setActive",value:function(e){var t=["h5ds-tab-head"];return this.state.selected===e&&t.push("h5ds-active"),t.join(" ")}},{key:"render",value:function(){var e=this;return q.a.createElement("div",{className:"h5ds-pagelist h5ds-js-pagelist"},q.a.createElement("div",{className:"h5ds-tab"},q.a.createElement("div",{className:"h5ds-tab-header h5ds-pagelist-btn"},q.a.createElement("ul",{className:"h5ds-global-clearfix"},q.a.createElement("li",{onClick:function(){return e.changeTabs("pages")},className:this.setActive("pages")},"页面"),q.a.createElement("li",{onClick:function(){return e.changeTabs("popups")},className:this.setActive("popups")},"弹窗"),q.a.createElement("li",{onClick:function(){return e.changeTabs("fixeds")},className:this.setActive("fixeds")},"浮动"))),q.a.createElement("div",{className:"h5ds-tab-body h5ds-pagelist-pages"},q.a.createElement("div",{className:"h5ds-tab-box h5ds-ban-animate",style:{display:"block"}},q.a.createElement(Cr,null)))))}}]),t}(G.Component),H()(gn.prototype,"changeTabs",[U.c],Object.getOwnPropertyDescriptor(gn.prototype,"changeTabs"),gn.prototype),fn=gn))||fn)||fn,Nr=(a(151),Object(zt.inject)("h5ds","scope")(vn=Object(zt.observer)((bn=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"mouseright",value:function(){var e=this,t=this.props.h5ds,a=t.edata,n=t.exChangeLayer,o=t.getLayers,r=t.delLayer,s=t.getLayerData,i=t.setLayer,c=t.copyAnimate,l=t.pasteAnimate;$(document).on("contextmenu.h5ds","#h5dsCanvas",function(e){e.preventDefault()}).on("contextmenu.menu",".h5ds-canvas-app > div > .h5ds-swiper-layers > .layer, .h5ds-contextmenu, #h5dsCanvasApp",function(t){t.preventDefault(),t.stopPropagation();var p=$(t.target).closest(".layer"),u=p.index(),h="layer",d=null;switch(a.selectGroup?h="group":-1===u?h="null":(i(u),U.e.publish("h5ds.initControl")),h){case"layer":d=[{name:'<i class="h5ds-ico h5ds-ico-dingceng"></i> 置顶',val:"top"},{name:'<i class="h5ds-ico h5ds-ico-diceng"></i> 置底',val:"bottom"},{name:'<i class="h5ds-ico h5ds-ico-shangyiyiceng"></i> 上移一层',val:"prev"},{name:'<i class="h5ds-ico h5ds-ico-xiayiyiceng"></i> 下移一层',val:"next"},{name:'<i class="h5ds-ico h5ds-ico-fuzhi"></i> 复制图层',val:"copy"},{name:'<i class="h5ds-ico h5ds-ico-niantie"></i> 粘贴图层',val:"paste"},{name:'<i class="h5ds-ico h5ds-ico-fuzhi"></i> 复制动画',val:"copyAnimate"},{name:'<i class="h5ds-ico h5ds-ico-niantie"></i> 粘贴动画',val:"pasteAnimate"},{name:'<i class="h5ds-ico h5ds-ico-icodel"></i> 删除图层',val:"del"},{name:'<i class="h5ds-ico h5ds-ico-baocun"></i> 保存图层',val:"save"}],p.hasClass("layer-h5ds_combin")&&d.push({name:'<i class="h5ds-ico h5ds-ico-fuzhi"></i> 取消合并',val:"uncombin"});break;case"group":d=[{name:'<i class="h5ds-ico h5ds-ico-fuzhi"></i> 合并图层',val:"combin"},{name:'<i class="h5ds-ico h5ds-ico-fuzhi"></i> 复制图层',val:"copy"},{name:'<i class="h5ds-ico h5ds-ico-niantie"></i> 粘贴图层',val:"paste"},{name:'<i class="h5ds-ico h5ds-ico-icodel"></i> 删除图层',val:"del"}];break;case"null":d=[{name:'<i class="h5ds-ico h5ds-ico-niantie"></i> 粘贴图层',val:"paste"}]}$.contextMenu({x:t.pageX,y:t.pageY,vals:d,callback:function(t){switch(t){case"uncombin":e.props.uncombin(u);break;case"top":0===u?Q.a.warn("已经是最顶层了"):(n(u,0),U.e.publish("h5ds.setHistory"));break;case"bottom":u===o().length-1?Q.a.warn("已经是最底层了"):(n(u,o().length-1),U.e.publish("h5ds.setHistory"));break;case"prev":0===u?Q.a.warn("已经是最顶层了"):(n(u,u-1),U.e.publish("h5ds.setHistory"));break;case"next":u===o().length-1?Q.a.warn("已经是最底层了"):(n(u,u+1),U.e.publish("h5ds.setHistory"));break;case"copy":e.props.copyLayer(),U.e.publish("h5ds.setHistory");break;case"copyAnimate":c();break;case"paste":e.props.pasteLayer();break;case"pasteAnimate":l();break;case"combin":e.props.combinLayers();break;case"del":r(u),U.e.publish("h5ds.setHistory");break;case"save":var a=s(u),i=e.props.scope.options,p=i.saveLayer,h=i.appId;try{p({plugins:[a.pid],updateTime:+new Date,appId:h,data:Object(Y.toJS)(a)}).then(function(){Q.a.success("保存成功")})}catch(t){Q.a.error("保存失败，没有配置saveLayer")}}}})})}},{key:"componentDidMount",value:function(){this.mouseright()}},{key:"componentWillUnmount",value:function(){$(document).off("contextmenu.h5ds"),$(document).off("contextmenu.menu")}},{key:"render",value:function(){return null}}]),t}(G.Component),H()(bn.prototype,"mouseright",[U.c],Object.getOwnPropertyDescriptor(bn.prototype,"mouseright"),bn.prototype),vn=bn))||vn)||vn),Pr=(a(152),Object(zt.inject)("h5ds")(wn=Object(zt.observer)((kn=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"showGrid",value:function(){U.e.publish("h5ds.show.grid")}},{key:"changeGridSize",value:function(e){var t=e.target.value;this.props.h5ds.edata.gridSize=t}},{key:"adsorbGrid",value:function(){var e=this.props.h5ds.edata.gridAdsorb;this.props.h5ds.edata.gridAdsorb=!e}},{key:"render",value:function(){var e=Lo.a.Button,t=Lo.a.Group,a=this.props.h5ds.edata;return q.a.createElement(yt.a,{placement:"left",title:"网格设置",content:q.a.createElement("div",{className:"h5ds-gridset"},q.a.createElement("div",{className:"h5ds-gridset-item"},q.a.createElement("span",null,"网格开关："),q.a.createElement(Fe.a,{defaultChecked:!1,onChange:this.showGrid})),q.a.createElement("div",{className:"h5ds-gridset-item"},q.a.createElement("span",null,"网格密度："),q.a.createElement(t,{value:a.gridSize,onChange:this.changeGridSize,size:"small"},q.a.createElement(e,{value:5},"5"),q.a.createElement(e,{value:8},"8"),q.a.createElement(e,{value:10},"10"),q.a.createElement(e,{value:16},"16"),q.a.createElement(e,{value:20},"20"),q.a.createElement(e,{value:32},"32"),q.a.createElement(e,{value:40},"40"),q.a.createElement(e,{value:80},"80"))),q.a.createElement("div",{className:"h5ds-gridset-item"},q.a.createElement("span",null,"网格吸附："),q.a.createElement(Fe.a,{defaultChecked:a.gridAdsorb,onChange:this.adsorbGrid}))),trigger:"click"},q.a.createElement("span",null,q.a.createElement("a",null,q.a.createElement("i",{className:"h5ds-ico h5ds-ico-wangge"})),q.a.createElement("span",null,"显示网格")))}}]),t}(G.Component),H()(kn.prototype,"showGrid",[U.c],Object.getOwnPropertyDescriptor(kn.prototype,"showGrid"),kn.prototype),H()(kn.prototype,"changeGridSize",[U.c],Object.getOwnPropertyDescriptor(kn.prototype,"changeGridSize"),kn.prototype),H()(kn.prototype,"adsorbGrid",[U.c],Object.getOwnPropertyDescriptor(kn.prototype,"adsorbGrid"),kn.prototype),wn=kn))||wn)||wn),jr=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"render",value:function(){return q.a.createElement(yt.a,{placement:"left",title:"快捷键说明",content:q.a.createElement("ul",null,q.a.createElement("li",null,"delete 删除"),q.a.createElement("li",null,"ctrl+s 保存预览APP"),q.a.createElement("li",null,"ctrl+c 复制图层"),q.a.createElement("li",null,"ctrl+v 粘贴图层"),q.a.createElement("li",null,"ctrl+z 撤销"),q.a.createElement("li",null,"ctrl+y 恢复"),q.a.createElement("li",null,"ctrl+y 恢复"),q.a.createElement("li",null,"ctrl+'-' 缩小画布"),q.a.createElement("li",null,"ctrl+'+' 放大画布"),q.a.createElement("li",null,"ctrl+p 播放动画"),q.a.createElement("li",null,"ctrl+h 显示网格"),q.a.createElement("li",null,"ctrl+g 合并图层"),q.a.createElement("li",null,"ctrl+u 取消合并"),q.a.createElement("li",null,"ctrl+上/下/左/右 大范围移动"),q.a.createElement("li",null,"上/下/左/右 小范围移动")),trigger:"click"},q.a.createElement("span",null,q.a.createElement("a",null,q.a.createElement("i",{className:"h5ds-ico h5ds-ico-kuaijiejian"})),q.a.createElement("span",null,"快捷键")))}}]),t}(G.Component),Lr=a(89),Ir=a.n(Lr),Ar=Object(zt.inject)("h5ds","scope")(En=Object(zt.observer)((xn=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={show:!0},a}return v()(t,e),h()(t,[{key:"setScale",value:function(e){var t=$(".h5ds-canvas-box").attr("style"),a=U.d.getTransformVal(t,"scale");"add"===e?a+=.1:a-=.1,3<a&&(a=3),a<.4&&(a=.4),this.props.h5ds.edata.phoneScale=a.toFixed(1)}},{key:"savePage",value:function(){var e=this.props.h5ds.getPage(),t=this.props.scope.options.savePage,a=U.b.getPidByPageData(e);try{t({plugins:a,createTime:+new Date,name:e.name,data:Object(Y.toJS)(e)}).then(function(){Q.a.success("收藏成功！")})}catch(e){console.error(e),Q.a.error("保存页面失败！请配置props.savePage，且必须返回一个Promise对象")}}},{key:"undo",value:function(){this.props.h5ds.doHistory("undo")}},{key:"redo",value:function(){this.props.h5ds.doHistory("redo")}},{key:"pasteLayer",value:function(){var e=this.props.h5ds,t=e.getLayers,a=e.setLayer,n=e.edata,o=e.getPageDom,r=e.getPageLayerDom,s=e.originLayerSet,i=t();if(window.H5DS_COPY_DATA)try{U.e.publish("h5ds.destoryControl");var c=JSON.parse(window.H5DS_COPY_DATA),l=c.type,p=c.data;"layer"===l?(p.style.top+=10,p.style.left+=10,Object(Y.transaction)(function(){s(p,!0),i.unshift(p),a(0),n.keys=U.i.randomID(),setTimeout(function(){U.e.publish("h5ds.initControl")})})):"group"===l?Object(Y.transaction)(function(){for(var e=[],a=p.length-1;0<=a;a--){e.push(p.length-1-a);var c=JSON.parse(unescape(p[a]));c.style.top+=10,c.style.left+=10,s(c,!0),i.unshift(c)}n.setType="group",n.selectGroup=e,n.keys=U.i.randomID(),Ut(t,r,n),n.selectGroup?qt(o,n.selectGroup):Q.a.error("组的选择已经取消！")}):Q.a.error("复制出现未知错误！"),U.e.publish("h5ds.setHistory")}catch(e){Q.a.error("复制数据错误")}else Q.a.error("请先复制图层")}},{key:"copyLayer",value:function(){var e=this.props.h5ds,t=e.getLayers,a=e.getLayer,n=e.edata;if(U.i.isEmpty(n.selectLayer))n.selectGroup?Object(Y.transaction)(ae()(ee.a.mark(function e(){var a,o;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=t(),o=[],n.selectGroup.forEach(function(e){o.push(escape(JSON.stringify(a[e])))}),window.H5DS_COPY_DATA=JSON.stringify({type:"group",data:o}),Q.a.success("已复制多个图层"),U.e.publish("h5ds.setHistory");case 6:case"end":return e.stop()}},e)}))):Q.a.error("请先选择图层！");else{var o=a();window.H5DS_COPY_DATA=JSON.stringify({type:"layer",data:o}),Q.a.success("已复制一个图层")}}},{key:"delLayer",value:function(){var e=this.props.h5ds,t=e.delLayer,a=e.edata,n=e.delGroupLayer;U.i.isEmpty(a.selectLayer)?a.selectGroup?Object(Y.transaction)(function(){n(),U.e.publish("h5ds.setHistory")}):Q.a.error("请先选择图层！"):Object(Y.transaction)(function(){t(a.selectLayer),U.e.publish("h5ds.setHistory")})}},{key:"combinLayers",value:function(){var e=this.props.h5ds,t=e.edata,a=e.getGroups,o=e.addLayer,r=e.delGroupLayer,s=e.setLayerId;if(t.selectGroup){var i=[],c=[],l=[],p=[];a().forEach(function(e){var t=U.f.rectParamObj(Object(Y.toJS)(e.layer));console.log("?????",t),p.push(e.key),c.push(t.top),c.push(t.top+t.boxHeight),l.push(t.left),l.push(t.left+t.boxWidth),i.push(s(Object(Y.toJS)(e.layer)))});var u=Math.min.apply(Math,c),h=Math.min.apply(Math,l),d=Math.max.apply(Math,l)-h,m=Math.max.apply(Math,c)-u;i.forEach(function(e){e.style.left-=h,e.style.top-=u});var y=E()({},n.config,new n.LayerJSON);y.keyid=U.i.randomID(),y.style.top=u,y.style.left=h,y.originstyle.width=d,y.originstyle.height=m,y.style.width=d,y.style.height=m,y.data=i,Object(Y.transaction)(function(){var e=Math.min.apply(Math,p);r(),o(y,e),t.keys=U.i.randomID(),U.e.publish("h5ds.destoryControl"),U.e.publish("h5ds.setHistory"),setTimeout(function(){$(".h5ds-js-layerlist").find(".h5ds-js-layerlist-item").eq(e).trigger("click")})})}else Q.a.warn("请先选择一组图层！")}},{key:"uncombin",value:function(){var e=this.props.h5ds,t=e.getLayer,a=e.addLayers,n=e.edata,o=t(),r=n.selectLayer;a(o.data.reverse(),r,U.f.rectParamObj(o)),U.e.publish("h5ds.destoryControl"),U.e.publish("h5ds.setHistory")}},{key:"addPage",value:function(){if(this.props.scope.template)U.e.publish("h5ds.showPageTpls");else{U.e.publish("h5ds.destoryControl");var e=new Tt.a;this.props.h5ds.addPage(e),U.e.publish("h5ds.setHistory")}}},{key:"saveToImage",value:function(){var e,t,a,n=this.props.h5ds.getPage();a="phone"===this.props.h5ds.data.type?(e=2*n.style.width||640,t=2*n.style.height||1028,2):(e=n.style.width||1e3,t=n.style.height||600,1),Ir.a.toPng(document.getElementById("h5dsCanvasApp"),{width:e,height:t,cacheBust:!0,style:{"transform-origin":"0 0",transform:"scale(".concat(a,")"),background:"#fff"},filter:function(e){return-1===["h5ds-grid-box h5ds-js-grid","h5ds-setpage-height","h5ds-setpage-width","h5ds-control"].indexOf(e.className)}}).then(function(e){var t=document.createElement("a");t.download="h5ds_".concat(U.i.randomID(),".png"),t.href=e,t.click()}).catch(function(e){console.error("oops, something went wrong!",e)})}},{key:"showList",value:function(){var e=this.state.show;e=!e,this.setState({show:e})}},{key:"componentDidMount",value:function(){var e=this;U.e.subscribe("h5ds.shortcuts_undo",function(){e.undo()}),U.e.subscribe("h5ds.shortcuts_combin",function(){e.combinLayers()}),U.e.subscribe("h5ds.shortcuts_redo",function(){e.redo()}),U.e.subscribe("h5ds.shortcuts_tomin",function(){e.setScale("del")}),U.e.subscribe("h5ds.shortcuts_tomax",function(){e.setScale("add")}),U.e.subscribe("h5ds.shortcuts_copylayer",function(){e.copyLayer()}),U.e.subscribe("h5ds.shortcuts_pastelayer",function(){e.pasteLayer()}),U.e.subscribe("h5ds.shortcuts_dellayer",function(){e.delLayer()}),U.e.subscribe("h5ds.shortcuts_uncombin",function(){e.uncombin()})}},{key:"componentWillUnmount",value:function(){U.e.unsubscribe("h5ds.shortcuts_redo"),U.e.unsubscribe("h5ds.shortcuts_copylayer"),U.e.unsubscribe("h5ds.shortcuts_pastelayer"),U.e.unsubscribe("h5ds.shortcuts_undo"),U.e.unsubscribe("h5ds.shortcuts_tomin"),U.e.unsubscribe("h5ds.shortcuts_combin"),U.e.unsubscribe("h5ds.shortcuts_uncombin"),U.e.unsubscribe("h5ds.shortcuts_tomax"),U.e.unsubscribe("h5ds.shortcuts_grid"),U.e.unsubscribe("h5ds.shortcuts_dellayer")}},{key:"render",value:function(){var e=this;return q.a.createElement("div",{className:"h5ds-shortcut h5ds-js-shortcut h5ds-drag","data-dragset":'{"limit":true}'},q.a.createElement(Nr,{combinLayers:this.combinLayers,uncombin:this.uncombin,pasteLayer:this.pasteLayer,copyLayer:this.copyLayer}),q.a.createElement("h5",null,q.a.createElement("i",{className:"h5ds-ico h5ds-ico-caidan"})," 快捷按钮",q.a.createElement("a",{onClick:this.showList},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-a1down"}))),q.a.createElement("div",{style:{display:this.state.show?"block":"none"}},q.a.createElement("div",null,q.a.createElement("ul",null,q.a.createElement("li",{onClick:function(){U.e.publish("h5ds.playAnimate")}},q.a.createElement("a",null,q.a.createElement("i",{className:"h5ds-ico h5ds-ico-bofang"})),q.a.createElement("span",null,"播放动画")),q.a.createElement("li",{onClick:this.props.h5ds.banAnimate},q.a.createElement("a",null,q.a.createElement("i",{className:"h5ds-ico h5ds-ico-zanting1"})),q.a.createElement("span",null,"禁用动画")),q.a.createElement("li",{onClick:this.saveToImage},q.a.createElement("a",null,q.a.createElement("i",{className:"h5ds-ico h5ds-ico-beijing"})),q.a.createElement("span",null,"存为图片")),q.a.createElement("li",null,q.a.createElement(Pr,null)),q.a.createElement("li",{className:"h5ds-js-savepage",onClick:this.savePage},q.a.createElement("a",null,q.a.createElement("i",{className:"h5ds-ico h5ds-ico-shoucang"})),q.a.createElement("span",null,"收藏页面")))),q.a.createElement("div",{className:"h5ds-shortcut-bottom-btns"},q.a.createElement("ul",null,q.a.createElement("li",{onClick:this.undo},q.a.createElement("a",null,q.a.createElement("i",{className:"h5ds-ico h5ds-ico-chexiao2"})),q.a.createElement("span",null,"撤销")),q.a.createElement("li",{onClick:this.redo},q.a.createElement("a",null,q.a.createElement("i",{className:"h5ds-ico h5ds-ico-chexiao1"})),q.a.createElement("span",null,"前进")),q.a.createElement("li",{onClick:function(){return e.setScale("add")}},q.a.createElement("a",null,q.a.createElement("i",{className:"h5ds-ico h5ds-ico-fangda"})),q.a.createElement("span",null,"放大画布")),q.a.createElement("li",{onClick:function(){return e.setScale("del")}},q.a.createElement("a",null,q.a.createElement("i",{className:"h5ds-ico h5ds-ico-suoxiao"})),q.a.createElement("span",null,"缩小画布")),q.a.createElement("li",null,q.a.createElement(jr,null)),q.a.createElement("li",{onClick:this.addPage},q.a.createElement("a",{className:"h5ds-shortcut-add"},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-jia1"})),q.a.createElement("span",null,"添加页面")),q.a.createElement("li",null,q.a.createElement("span",null,"缩放比：",this.props.h5ds.edata.phoneScale))))))}}]),t}(G.Component),H()(xn.prototype,"setScale",[U.c],Object.getOwnPropertyDescriptor(xn.prototype,"setScale"),xn.prototype),H()(xn.prototype,"savePage",[U.c],Object.getOwnPropertyDescriptor(xn.prototype,"savePage"),xn.prototype),H()(xn.prototype,"undo",[U.c],Object.getOwnPropertyDescriptor(xn.prototype,"undo"),xn.prototype),H()(xn.prototype,"redo",[U.c],Object.getOwnPropertyDescriptor(xn.prototype,"redo"),xn.prototype),H()(xn.prototype,"pasteLayer",[U.c],Object.getOwnPropertyDescriptor(xn.prototype,"pasteLayer"),xn.prototype),H()(xn.prototype,"copyLayer",[U.c],Object.getOwnPropertyDescriptor(xn.prototype,"copyLayer"),xn.prototype),H()(xn.prototype,"delLayer",[U.c],Object.getOwnPropertyDescriptor(xn.prototype,"delLayer"),xn.prototype),H()(xn.prototype,"combinLayers",[U.c],Object.getOwnPropertyDescriptor(xn.prototype,"combinLayers"),xn.prototype),H()(xn.prototype,"uncombin",[U.c],Object.getOwnPropertyDescriptor(xn.prototype,"uncombin"),xn.prototype),H()(xn.prototype,"addPage",[U.c],Object.getOwnPropertyDescriptor(xn.prototype,"addPage"),xn.prototype),H()(xn.prototype,"saveToImage",[U.c],Object.getOwnPropertyDescriptor(xn.prototype,"saveToImage"),xn.prototype),H()(xn.prototype,"showList",[U.c],Object.getOwnPropertyDescriptor(xn.prototype,"showList"),xn.prototype),En=xn))||En)||En,Tr=(a(153),Object(zt.inject)("h5ds","scope")(On=Object(zt.observer)((Sn=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={showPanel:!1},a}return v()(t,e),h()(t,[{key:"changePanel",value:function(){this.setState({showPanel:!this.state.showPanel})}},{key:"componentDidMount",value:function(){var e=this;U.e.subscribe("h5ds.showPageTpls",function(){e.setState({showPanel:!0})})}},{key:"componentWillUnmount",value:function(){U.e.unsubscribe("h5ds.showPageTpls")}},{key:"render",value:function(){var e=this.props.scope.options.template,t=this.state.showPanel,a=["h5ds-template"];return t&&a.push("h5ds-temps-showpanel"),e?q.a.createElement("div",{className:a.join(" ")},q.a.createElement("a",{onClick:this.changePanel,className:"h5ds-temps-flodbtn h5ds-js-temps"},q.a.createElement("i",{className:t?"h5ds-ico h5ds-ico-a3left":"h5ds-ico h5ds-ico-a3right"})),q.a.createElement(e,{layerfun:this.props.layerfun,app:this.props.app,showPanel:t})):null}}]),t}(G.Component),H()(Sn.prototype,"changePanel",[U.c],Object.getOwnPropertyDescriptor(Sn.prototype,"changePanel"),Sn.prototype),On=Sn))||On)||On),zr=(a(154),Object(zt.inject)("h5ds","scope")(Cn=Object(zt.observer)((Dn=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={play:!0,left:0,barKey:U.i.randomID(),maxTimeLine:60,timebar:0,eachLiWidth:100},a}return v()(t,e),h()(t,[{key:"timeLineSliderScroll",value:function(e){var t=$(e.target).scrollLeft();this.setState({left:t})}},{key:"setLayer",value:function(e,t){$("#h5dsLayerList").find("li").eq(t).trigger("click"),$(".h5ds-layerset-tabs").children(".ant-tabs-bar").find(".ant-tabs-tab").eq(1).trigger("click")}},{key:"playAnimate",value:function(){var e=this;this.setState({timebar:0,barKey:U.i.randomID()}),setTimeout(function(){e.setState({timebar:100*e.maxTime}),e.props.h5ds.playAnimate()},10)}},{key:"banAnimate",value:function(){this.props.h5ds.edata.banAnimate=!0,$("#h5dsCanvas").find("audio").each(function(){this.pause()})}},{key:"resetDelay",value:function(e){Object(Y.transaction)(function(){var t=null;e.forEach(function(e,a){if(0!==a){var n=t,o=n.duration,r=void 0===o?0:o,s=n.delay,i=void 0===s?0:s,c=n.count,l=void 0===c?0:c,p=U.d.getAnimation(e.style).delay;(i=r*l+i)<=p&&(i=p),e.style=U.d.setAnimation(e.style,{delay:i})}t=U.d.getAnimation(e.style)})})}},{key:"mousedownAnimate",value:function(e,t,a,n){var o=this;e.stopPropagation();var r=e.pageX,s=a.name,i=a.duration,c=a.timing,l=a.delay,p=a.count,u=$(e.target),h=this.state.eachLiWidth,d=l;$(document).on("mousemove.h5ds.timeline.movenode",function(e){d=e.pageX-r,(d=l+d/100)<0&&(d=0),u.css({left:d*h})}).on("mouseup.h5ds.timeline.movenode",function(){t.style="".concat(s," ").concat(i,"s ").concat(c," ").concat(d,"s ").concat(p," normal forwards running"),o.resetDelay(n),U.e.publish("h5ds.setHistory"),$(document).off("mousemove.h5ds.timeline.movenode"),$(document).off("mouseup.h5ds.timeline.movenode")})}},{key:"mousedownAnimateRight",value:function(e,t,a,n){var o=this;e.stopPropagation();var r=e.pageX,s=a.name,i=a.duration,c=a.timing,l=a.delay,p=a.count,u=$(e.target.parentNode),h=this.state.eachLiWidth,d=0;$(document).on("mousemove.h5ds.timeline.movenode",function(e){d=e.pageX-r,(d=i+d/100)<.1&&(d=.1),u.css({width:d*h})}).on("mouseup.h5ds.timeline.movenode",function(){t.style="".concat(s," ").concat(d.toFixed(1),"s ").concat(c," ").concat(l,"s ").concat(p," normal forwards running"),o.resetDelay(n),U.e.publish("h5ds.setHistory"),$(document).off("mousemove.h5ds.timeline.movenode"),$(document).off("mouseup.h5ds.timeline.movenode")})}},{key:"mousedownAnimateLeft",value:function(e,t,a,n){var o=this;e.stopPropagation();var r=e.pageX,s=a.name,i=a.duration,c=a.timing,l=a.delay,p=a.count,u=$(e.target.parentNode),h=this.state.eachLiWidth,d=0,m=0;$(document).on("mousemove.h5ds.timeline.movenode",function(e){var t=e.pageX-r;d=l+t/100,(m=i-t/100)<.1||u.css({left:h*d,width:m*h})}).on("mouseup.h5ds.timeline.movenode",function(){t.style="".concat(s," ").concat(m.toFixed(1),"s ").concat(c," ").concat(d.toFixed(1),"s ").concat(p," normal forwards running"),o.resetDelay(n),U.e.publish("h5ds.setHistory"),$(document).off("mousemove.h5ds.timeline.movenode"),$(document).off("mouseup.h5ds.timeline.movenode")})}},{key:"mousedownSound",value:function(e,t){e.stopPropagation();var a=e.pageX,n=t.data.delay,o=null,r=this.state.eachLiWidth,s=$(e.target);$(document).on("mousemove.h5ds.timeline.movenode",function(e){o=e.pageX-a,(o=n+o/100)<0&&(o=0),s.css({left:r*o})}).on("mouseup.h5ds.timeline.movenode",function(){null!==o&&(t.data.delay=parseFloat(o.toFixed(1))),U.e.publish("h5ds.setHistory"),$(document).off("mousemove.h5ds.timeline.movenode"),$(document).off("mouseup.h5ds.timeline.movenode")})}},{key:"setMaxTimeLine",value:function(e){this.setState({maxTimeLine:e})}},{key:"setTypeName",value:function(e){switch(e){case"in":e="进入";break;case"out":e="离开";break;case"em":e="强调"}return e}},{key:"componentDidMount",value:function(){U.e.subscribe("h5ds.playAnimate",this.playAnimate)}},{key:"componentWillUnmount",value:function(){$(".h5ds-timeline-slider").off("scroll"),$(document).off("mousemove.timeline.height"),U.e.unsubscribe("h5ds.playAnimate")}},{key:"render",value:function(){var e=this,t=this.props.h5ds.edata,a=(t.selectType,t.selectLayer),n=(t.selectPage,t.layerListKeys,t.banAnimate),o=this.props.h5ds.getLayers()||[],r=new Array(this.state.maxTimeLine).fill(1).map(function(e,t){return t}),s=this.state,i=s.left,c=s.eachLiWidth,l=s.timebar,p=s.barKey;return this.maxTime=0,q.a.createElement("div",{className:"h5ds-timeline"},q.a.createElement("div",{className:"h5ds-timeline-btn",onMouseDown:this.props.setTimeLineHeight},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-tuodongcaozuo"})),this.props.show?null:q.a.createElement(q.a.Fragment,null,q.a.createElement("div",{className:"h5ds-timeline-header"},q.a.createElement("div",{className:"h5ds-timeline-left h5ds-global-clearfix"},q.a.createElement("span",{className:"h5ds-timeline-item1"},q.a.createElement("span",{className:"h5ds-timeline-play"},q.a.createElement(Ee.a,{min:30,onChange:this.setMaxTimeLine,value:this.state.maxTimeLine,size:"small",width:50})," ",q.a.createElement("a",{onClick:this.banAnimate},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-zanting1"})),q.a.createElement("a",{onClick:this.playAnimate},q.a.createElement("i",{className:"h5ds-ico h5ds-ico-forward"})))),q.a.createElement("span",{className:"h5ds-timeline-item2"},q.a.createElement("a",null,q.a.createElement("i",{className:"h5ds-ico h5ds-ico-kejian"})),q.a.createElement("a",null,q.a.createElement("i",{className:"h5ds-ico h5ds-ico-suo"})))),q.a.createElement("div",{className:"h5ds-timeline-right"},q.a.createElement("div",{key:p,className:"h5ds-timeline-bar"+(n?" h5ds-ban-animate":""),style:{transform:"translateX(".concat(-i,"px)"),animation:"h5dsTimeLineBarKeyFrames ".concat(l/100,"s linear"),WebkitAnimation:"h5dsTimeLineBarKeyFrames ".concat(l/100,"s linear")}},q.a.createElement("style",null,"\n                @keyframes h5dsTimeLineBarKeyFrames\n                {\n                  from {left:0px;}\n                  to {left:".concat(l,"px;}\n                }\n                @-webket-keyframes h5dsTimeLineBarKeyFrames\n                {\n                  from {left:0px;}\n                  to {left:").concat(l,"px;}\n                }\n                "))),q.a.createElement("ul",{className:"h5ds-timeline-scale h5ds-js-timeline-scale",style:{width:r.length*c,transform:"translateX(".concat(-i,"px)")}},r.map(function(e){return q.a.createElement("li",{key:e},new Array(9).fill(1).map(function(e,t){return q.a.createElement("i",{key:t,className:"h5ds-timeline-dot"})}),q.a.createElement("span",null,e,"s"))})))),q.a.createElement("div",{className:"h5ds-timeline-body"},q.a.createElement("div",{className:"h5ds-timeline-left clearfix"},q.a.createElement("ul",{className:"h5ds-timeline-layers-left"},o.map(function(t,n){return q.a.createElement("li",{onClick:function(t){return e.setLayer(t,n)},className:a===n?"h5ds-timeline-active":"",key:n},q.a.createElement("span",{className:"h5ds-timeline-item1"},t.name||t.type),q.a.createElement("span",{className:"h5ds-timeline-item2"},q.a.createElement("a",{className:"h5ds-timeline-view ".concat(t.set.hide?"":"h5ds-timeline-active")}),q.a.createElement("a",{className:"h5ds-timeline-lock ".concat(t.set.lock?"h5ds-timeline-active":"")})))}))),q.a.createElement("div",{className:"h5ds-timeline-right h5ds-global-clearfix"},q.a.createElement("ul",{className:"h5ds-timeline-layers-right h5ds-js-timeline-layers",style:{width:r.length*c+10,transform:"translateX(".concat(-i,"px)")}},o.map(function(t,n){var o=null;if("h5ds_sound"===t.pid){var r=t.data,s=r.delay,i=r.duration;e.maxTime<s+i&&(e.maxTime=s+i),o=q.a.createElement("li",{onClick:function(t){return e.setLayer(t,n)},className:a===n?"h5ds-timeline-active":"","data-keyid":t.keyid,key:n},q.a.createElement("span",{style:{left:c*s,width:i*c},className:"h5ds-timeline-timenode h5ds-timeline-soundnode",onMouseDown:function(a){return e.mousedownSound(a,t)}}))}else o=q.a.createElement("li",{onClick:function(t){return e.setLayer(t,n)},className:a===n?"h5ds-timeline-active":"","data-keyid":t.keyid,key:n},t.animate.map(function(a,n){var o=U.d.getAnimation(a.style),r=o.count,s=o.duration,i=o.delay,l=F()(o,["count","duration","delay"]),p=r*s;return e.maxTime<i+p&&(e.maxTime=i+p),q.a.createElement("span",{style:{left:c*i,width:p*c},className:"h5ds-timeline-timenode",key:n,onMouseDown:function(n){return e.mousedownAnimate(n,a,E()({count:r,duration:s,delay:i},l),t.animate)}},q.a.createElement("div",{onMouseDown:function(n){return e.mousedownAnimateRight(n,a,E()({count:r,duration:s,delay:i},l),t.animate)},className:"h5ds-timeline-timenode-right"}),q.a.createElement("div",{onMouseDown:function(n){return e.mousedownAnimateLeft(n,a,E()({count:r,duration:s,delay:i},l),t.animate)},className:"h5ds-timeline-timenode-left"}),e.setTypeName(a.type),"（",a.name,"）")}));return o})))),q.a.createElement("div",{className:"h5ds-timeline-footer"},q.a.createElement("div",{className:"h5ds-timeline-left h5ds-global-clearfix"}),q.a.createElement("div",{className:"h5ds-timeline-right h5ds-global-clearfix"},q.a.createElement("div",{className:"h5ds-timeline-slider",onScroll:this.timeLineSliderScroll},q.a.createElement("div",{style:{width:r.length*c},className:"h5ds-timeline-slider-leng"}))))))}}]),t}(G.Component),H()(Dn.prototype,"timeLineSliderScroll",[U.c],Object.getOwnPropertyDescriptor(Dn.prototype,"timeLineSliderScroll"),Dn.prototype),H()(Dn.prototype,"setLayer",[U.c],Object.getOwnPropertyDescriptor(Dn.prototype,"setLayer"),Dn.prototype),H()(Dn.prototype,"playAnimate",[U.c],Object.getOwnPropertyDescriptor(Dn.prototype,"playAnimate"),Dn.prototype),H()(Dn.prototype,"banAnimate",[U.c],Object.getOwnPropertyDescriptor(Dn.prototype,"banAnimate"),Dn.prototype),H()(Dn.prototype,"resetDelay",[U.c],Object.getOwnPropertyDescriptor(Dn.prototype,"resetDelay"),Dn.prototype),H()(Dn.prototype,"mousedownAnimate",[U.c],Object.getOwnPropertyDescriptor(Dn.prototype,"mousedownAnimate"),Dn.prototype),H()(Dn.prototype,"mousedownAnimateRight",[U.c],Object.getOwnPropertyDescriptor(Dn.prototype,"mousedownAnimateRight"),Dn.prototype),H()(Dn.prototype,"mousedownAnimateLeft",[U.c],Object.getOwnPropertyDescriptor(Dn.prototype,"mousedownAnimateLeft"),Dn.prototype),H()(Dn.prototype,"mousedownSound",[U.c],Object.getOwnPropertyDescriptor(Dn.prototype,"mousedownSound"),Dn.prototype),H()(Dn.prototype,"setMaxTimeLine",[U.c],Object.getOwnPropertyDescriptor(Dn.prototype,"setMaxTimeLine"),Dn.prototype),Cn=Dn))||Cn)||Cn),_r=Object(zt.inject)("h5ds")(Nn=Object(zt.observer)((Pn=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={height:e.h5ds.edata.timeLineHeight},a}return v()(t,e),h()(t,[{key:"setTimeLineHeight",value:function(e){var t=this,a=e.pageY,n=$(".h5ds-center"),o=$("#h5dsCanvas"),r=this.props.h5ds.edata,s=r.timeLineHeight,i=r.headerHeight,c=$(window).height(),l=c-i,p=this.state.height,u=c-i-s;$(document).on("mousemove.timeline.height",function(e){var r=e.pageY-a;l<(s=p-r)?s=l:s<14&&(s=14),u=c-i-s,t.setState({height:s}),o.css({height:u}),n.css({height:u})}).on("mouseup.timeline.height",function(){Object(Y.transaction)(function(){t.props.h5ds.edata.timeLineHeight=s,t.props.h5ds.edata.canvasHeight=u}),t.setState({height:s}),$(document).off("mousemove.timeline.height mouseup.timeline.height")})}},{key:"render",value:function(){var e=this.state.height;return q.a.createElement("div",{style:{height:e},className:"h5ds-timeline-box"},q.a.createElement(zr,{show:14===e,setTimeLineHeight:this.setTimeLineHeight}))}}]),t}(G.Component),H()(Pn.prototype,"setTimeLineHeight",[U.c],Object.getOwnPropertyDescriptor(Pn.prototype,"setTimeLineHeight"),Pn.prototype),Nn=Pn))||Nn)||Nn,$r=function(e){function t(e){return p()(this,t),m()(this,f()(t).call(this,e))}return v()(t,e),h()(t,[{key:"componentDidMount",value:function(){$("body").addClass("h5ds-edit"),this.shortcuts||(this.shortcuts=!0,Object(U.g)())}},{key:"componentWillUnmount",value:function(){$("body").removeClass("h5ds-edit")}},{key:"render",value:function(){var e=this;console.log("pluginsKey > ",this.props.scope.pluginsKey);var t=[];for(var a in this.props.scope.pluginsKey){var n=this.props.scope.pluginsKey[a].Modal;n&&t.push(n)}return[q.a.createElement(Or,{key:"1"}),q.a.createElement(Po,{key:"2"}),q.a.createElement(Wt,{key:"3"}),q.a.createElement(Sr,{key:"4"}),q.a.createElement(yr,{key:"5"}),q.a.createElement(Dr,{key:"6"}),q.a.createElement(Ar,{key:"7"}),q.a.createElement(Tr,{key:"8"}),q.a.createElement(_r,{key:"9"}),q.a.createElement(Mt,{key:"10"}),q.a.createElement(ur,{key:"11"}),q.a.createElement(pr,{key:"12"})].concat(_()(t.map(function(t,a){return q.a.createElement(t,T()({},e.props,{key:"modal_".concat(a)}))})))}}]),t}(G.Component),Wr=(a(155),a(90)),Hr=a.n(Wr),Rr=(a(156),a(157),function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"render",value:function(){var e=this.props,t=e.tips,a=e.body,n=void 0===a?null:a;return q.a.createElement("div",{className:"h5ds-loading-window"},n||q.a.createElement("div",{className:"h5ds-loading-center"},q.a.createElement("div",{className:"h5ds-loadbox"},t||"loading...")))}}]),t}(G.Component)),Mr=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={percent:0,sourceName:"h5ds.core.js"},a}return v()(t,e),h()(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.appData,n=t.complete;console.log("load script:",a,n),a?U.e.subscribe("h5ds.load.plugins",function(t,a){var o=a.count,r=a.index,s=a.progress,i=a.name,c=a.type;0===o&&"script"===c?(e.setState({percent:100,name:"资源加载完成"}),n()):0!==o&&o===r+1&&"script"===c&&(e.setState({percent:100,name:"资源加载完成"}),n());var l=100*s;"editor"===c?l*=.75:l=l/4+75,e.setState({percent:parseInt(l,10),sourceName:i})}):console.error("数据异常")}},{key:"componentWillUnmount",value:function(){this.hasUnmount=!0,U.e.unsubscribe("h5ds.load.plugins")}},{key:"render",value:function(){var e=this.state,t=e.percent,a=e.sourceName;return q.a.createElement(Rr,{body:q.a.createElement("div",{className:"h5ds-loading-box"},q.a.createElement(Hr.a,{strokeWidth:1,format:function(e){return q.a.createElement("div",{className:"h5ds-loading-percent"},"资源载入",e,"% ",q.a.createElement("br",null),q.a.createElement("span",{className:"h5ds-loading-info"},a))},width:200,type:"circle",percent:t}))})}}]),t}(G.Component),Br=Object(zt.inject)("h5ds","scope")(jn=Object(zt.observer)((Ln=function(e){function t(e){var a;return p()(this,t),(a=m()(this,f()(t).call(this,e))).state={pluginsLoad:!1,dataLoad:!1,initScope:!1,scriptLoad:!1,data:null},a.scripts=[],a}return v()(t,e),h()(t,[{key:"loadPlugins",value:function(e){var t=this,a=0<arguments.length&&void 0!==e?e:[],n=[];if(this.props.debugger)return new Promise(function(e){[].concat(_()(Object.values(c)),_()(a)).forEach(function(e){e.config?n.push(E()({},e,e.config)):console.error("插件必须包括config文件，具体配置查看官方文档doc.h5ds.com",e)}),e(n)}).then(function(e){var a=[],n={};e.forEach(function(e){e.scripts&&(a=a.concat(e.scripts)),n[e.pid]=e}),a=Array.from(new Set(a)),Object(_t.e)(a).then(function(){t.loadPluginsEnd({pluginsKey:n,scripts:a})})});var o=this.props.options.pluginsHost,r=void 0===o?"":o;return Object(_t.d)(a,r,"editor",c).then(function(e){var a=e.pluginsKey,n=e.scripts;t.loadPluginsEnd({pluginsKey:a,scripts:n})})}},{key:"loadPluginsEnd",value:function(e){var t=this,a=e.pluginsKey,n=e.scripts;Object(Y.transaction)(function(){t.props.scope.plugins=Object.values(a),t.props.scope.scripts=_()(n),t.props.scope.pluginsKey=a,t.props.scope.resetCanvasSize=t.resetCanvasSize.bind(t),t.props.scope.options=E()({},t.props.options),t.setState({pluginsLoad:!0})})}},{key:"loadSourceComplete",value:function(){this.setState({scriptLoad:!0})}},{key:"resetCanvasSize",value:function(){var e=this.props.h5ds,t=e.data,a=e.edata;Object(Tt.h)(t.type),Object(Y.transaction)(function(){var e=Tt.e.appWidth,n=Tt.e.appHeight,o=t.style,r=o.width,s=o.height;r="pc"===t.type?r<e?e:r:e<r?e:r,s=n,t.style.width=r,t.style.height=s,[].concat(_()(t.pages),_()(t.popups),_()(t.fixeds)).map(function(e){e.style.height=s,e.style.width=r}),t.fixeds[0].style.height=0,a.pageSize.width=r,a.pageSize.height=s})}},{key:"initAppData",value:function(){var e=this;if(!this.initAppDataMark){this.initAppDataMark=!0;var t=this.props.h5ds,a=this.state.data;"defaultData"===a&&(a=Object(Tt.f)()),t.initApp(a,this.props.options.appId).then(function(){e.setState({initScope:!0}),e.loadPlugins(e.props.plugins)})}}},{key:"componentWillUnmount",value:function(){$(document).off("h5ds"),U.e.clearAllSubscriptions()}},{key:"render",value:function(){var e=this.state,t=e.pluginsLoad,a=e.scriptLoad,n=e.dataLoad,o=e.initScope,r=e.data,s=null;return console.log(t,a,n,o),t&&a&&n&&o?(this.initAppDataMark=!1,s=q.a.createElement("div",{className:"h5ds-layout-frame"},q.a.createElement($r,T()({},this.props,{appData:r})))):n?(this.initAppData(),s=q.a.createElement("div",{className:"h5ds-layout-frame"},q.a.createElement(Mr,{appData:r,complete:this.loadSourceComplete}))):console.log("数据载入中..."),s}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.data?Object.assign(t,{data:e.data,dataLoad:!0}):t}}]),t}(G.Component),H()(Ln.prototype,"loadPluginsEnd",[U.c],Object.getOwnPropertyDescriptor(Ln.prototype,"loadPluginsEnd"),Ln.prototype),H()(Ln.prototype,"loadSourceComplete",[U.c],Object.getOwnPropertyDescriptor(Ln.prototype,"loadSourceComplete"),Ln.prototype),H()(Ln.prototype,"resetCanvasSize",[U.c],Object.getOwnPropertyDescriptor(Ln.prototype,"resetCanvasSize"),Ln.prototype),H()(Ln.prototype,"initAppData",[U.c],Object.getOwnPropertyDescriptor(Ln.prototype,"initAppData"),Ln.prototype),jn=Ln))||jn)||jn,Fr=a(91),Gr=a.n(Fr),qr=a(15),Ur=a.n(qr),Yr=(a(81),Tt.e.appHeight),Vr=Tt.e.appWidth,Jr=(In=function(){function e(){var t=this;p()(this,e),Ur()(this,"data",An,this),Ur()(this,"edata",Tn,this),this.historyIndex=0,this.history=[],Ur()(this,"renderPageList",zn,this),this.getData=function(e,t){var a=U.i.getStorage("H5DS_APP_ID");return(t=t||"h5ds_demo_appid")&&a===t?e=U.i.getStorage("H5DS_APP_DATA"):U.i.setStorage("H5DS_APP_ID",t),Promise.resolve(e)},Ur()(this,"initApp",_n,this),Ur()(this,"updateCanvas",$n,this),Ur()(this,"updateCanvasAsync",Wn,this),Ur()(this,"toJS",Hn,this),Ur()(this,"addSet",Rn,this),Ur()(this,"banAnimate",Mn,this),Ur()(this,"playAnimate",Bn,this),Ur()(this,"setLayerId",Fn,this),Ur()(this,"originLayerSet",Gn,this),Ur()(this,"setCanvasSize",qn,this),this.getCanvasSize=function(){var e=t.edata,a=e.headerHeight,n=e.timeLineHeight,o=$(window).height()-a-n,r=$(window).width()-350-140;return r<0&&(r=0),o<0&&(o=0),{canvasWidth:r,canvasHeight:o}},Ur()(this,"setType",Un,this),Ur()(this,"setLayerStyle",Yn,this),Ur()(this,"getPageNum",Vn,this),Ur()(this,"getPage",Jn,this),Ur()(this,"getPages",Xn,this),Ur()(this,"getLayers",Kn,this),Ur()(this,"getLayer",Qn,this),Ur()(this,"addLayer",Zn,this),Ur()(this,"addLayers",eo,this),Ur()(this,"getPageDom",to,this),Ur()(this,"getPageLayerDom",ao,this),Ur()(this,"getGroups",no,this),Ur()(this,"getLayerDom",oo,this),Ur()(this,"delLayer",ro,this),this.getLayerData=function(e){var a=t.edata.selectLayer,n=t.getLayers();e=U.i.isEmpty(e)?a:e;var o=Object(Y.toJS)(n[e]);return t.originLayerSet(o,!0)},Ur()(this,"delGroupLayer",so,this),Ur()(this,"setPage",io,this),Ur()(this,"clickLayer",co,this),Ur()(this,"setLayer",lo,this),Ur()(this,"exChangePage",po,this),Ur()(this,"exChangeLayer",uo,this),Ur()(this,"delPage",ho,this),Ur()(this,"addPage",mo,this),Ur()(this,"copyPage",yo,this),Ur()(this,"copyLayer",fo,this),Ur()(this,"copyAnimate",go,this),Ur()(this,"pasteAnimate",vo,this),Ur()(this,"doHistory",bo,this),Ur()(this,"setHistoryAsync",wo,this),Ur()(this,"setHistory",ko,this),this.saveToStore=U.i.debounce(function(){console.log("本地缓存");var e=t.history[t.history.length-1],a=e.data,n=e.edata;U.i.setStorage("H5DS_APP_DATA",a),U.i.setStorage("H5DS_APP_EDATA",n)},3e3)}return h()(e,[{key:"getJsonByPid",value:function(e,t){for(var a=e[t],n=a.LayerJSON,o=a.config,r=arguments.length,s=new Array(2<r?r-2:0),i=2;i<r;i++)s[i-2]=arguments[i];var c=E()({},Gr()(n,s),o);return this.originLayerSet(c)}}]),e}(),An=H()(In.prototype,"data",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Tn=H()(In.prototype,"edata",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),zn=H()(In.prototype,"renderPageList",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return U.i.debounce(function(){e.edata.pageListKeys=U.i.randomID()},500)}}),_n=H()(In.prototype,"initApp",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){return U.e.subscribe("h5ds.setHistory",U.i.debounce(e.setHistory,300)),e.getData(t,a).then(function(t){Object(Tt.h)(t.type),Object(Y.transaction)(function(){e.edata={appid:a,animateListShow:!1,eventListShow:!1,banAnimate:!1,canvasAnimate:U.i.randomID(),gridAdsorb:!1,gridSize:5,headerHeight:60,timeLineHeight:14,pageSize:{width:Vr,height:Yr},phoneScale:1,setType:"page",selectType:"pages",selectFixed:0,selectPage:0,selectPopup:0,selectLayer:null,selectGroup:!1,keys:U.i.randomID(),selectlayerKeys:U.i.randomID(),layerListKeys:U.i.randomID(),pageListKeys:U.i.randomID()};var n=e.getCanvasSize(),o=n.canvasHeight,r=n.canvasWidth;e.edata.canvasHeight=o,e.edata.canvasWidth=r,e.data=e.addSet(t),e.setHistory()})})}}}),$n=H()(In.prototype,"updateCanvas",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.edata.keys=U.i.randomID()}}}),Wn=H()(In.prototype,"updateCanvasAsync",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return U.i.debounce(function(){e.updateCanvas()})}}),Hn=H()(In.prototype,"toJS",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e){var t=null;try{t=JSON.parse(JSON.stringify(e))}catch(e){return void console.error("数据转化错误")}return t}}}),Rn=H()(In.prototype,"addSet",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=t.pages,n=t.fixeds,o=t.popups;return[].concat(_()(a),_()(o),_()(n)).forEach(function(t){t.keyid||(t.keyid=U.i.randomID()),t.layers.forEach(function(t){e.originLayerSet(t)})}),t}}}),Mn=H()(In.prototype,"banAnimate",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){U.e.publish("h5ds.destoryControl"),e.edata.banAnimate=!0,$("#h5dsCanvas").find("audio").each(function(){this.pause()})}}}),Bn=H()(In.prototype,"playAnimate",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){U.e.publish("h5ds.destoryControl"),Object(Y.transaction)(function(){e.edata.banAnimate=!1,e.edata.canvasAnimate=U.i.randomID()})}}}),Fn=H()(In.prototype,"setLayerId",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(e){return e.id&&(e.id="ID_"+U.i.randomID()),e.keyid=U.i.randomID(),e}}}),Gn=H()(In.prototype,"originLayerSet",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return t.keyid||(t.keyid=U.i.randomID()),void 0===t.className&&(t.className=""),void 0===t.set&&(t.set={}),t.set.hide=!1,void 0===t.set.lock&&(t.set.lock=!1),a&&e.setLayerId(t),t}}}),qn=H()(In.prototype,"setCanvasSize",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.getCanvasSize(),a=t.canvasHeight,n=t.canvasWidth;console.log("视图发生变化",E()({},e.edata.pageSize)),Object(Y.transaction)(function(){e.edata.canvasWidth=n,e.edata.canvasHeight=a})}}}),Un=H()(In.prototype,"setType",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.edata.setType=t}}}),Yn=H()(In.prototype,"setLayerStyle",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.getLayer().style=t}}}),Vn=H()(In.prototype,"getPageNum",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.edata,a=t.selectPage,n=t.selectPopup,o=t.selectFixed,r=null;switch(t.selectType){case"pages":r=a;break;case"fixeds":r=o;break;case"popups":r=n}return r}}}),Jn=H()(In.prototype,"getPage",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){var n=e.edata,o=n.selectPage,r=n.selectPopup,s=n.selectFixed,i=n.selectType,c=t||i,l=null;switch(c){case"pages":l=U.i.isEmpty(a)?o:a;break;case"fixeds":l=U.i.isEmpty(a)?s:a;break;case"popups":l=U.i.isEmpty(a)?r:a}return e.data[c][l]||null}}}),Xn=H()(In.prototype,"getPages",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){return t=t||e.edata.selectType,e.data[t]||[]}}}),Kn=H()(In.prototype,"getLayers",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.getPage(),a=null;return t?a=t.layers:console.warn("page 不存在!"),a}}}),Qn=H()(In.prototype,"getLayer",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.getLayers(),a=e.edata.selectLayer,n=null;if(null!==a)return t&&(n=t[a]),n;console.warn("还未选择任何图层")}}}),Zn=H()(In.prototype,"addLayer",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){var n=e.getPage();n?Object(Y.transaction)(function(){e.originLayerSet(t),U.i.isEmpty(a)?n.layers.unshift(t):n.layers.splice(a,0,t),e.edata.layerListKeys=U.i.randomID()}):Q.a.error("未选择任何页面！")}}}),eo=H()(In.prototype,"addLayers",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a,n){var o=e.getPage();Object(Y.transaction)(function(){t.forEach(function(t){e.originLayerSet(t),t.style.left+=n.left,t.style.top+=n.top,o.layers.splice(a,0,t)}),e.delLayer(a+t.length),e.edata.layerListKeys=U.i.randomID()})}}}),to=H()(In.prototype,"getPageDom",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=e.edata,n=a.selectType,o=a.selectFixed,r=null;switch(t&&(n=t),n){case"popups":r=$("#h5dsPageViewPopup");break;case"fixeds":switch(o){case 0:r=$("#h5dsPageViewFixedUp");break;case 1:r=$("#h5dsPageViewFixedDown")}break;case"pages":r=$("#h5dsPageView")}return r}}}),ao=H()(In.prototype,"getPageLayerDom",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=e.getPageDom().children().children();return U.i.isEmpty(t)?a:a.eq(t)}}}),no=H()(In.prototype,"getGroups",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=[],a=e.getLayers();return e.edata.selectGroup&&e.edata.selectGroup.forEach(function(e){t.push({key:e,layer:a[e]})}),t.sort(function(e,t){return e.key-t.key})}}}),oo=H()(In.prototype,"getLayerDom",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=e.getPageDom(),n=e.edata.selectLayer;return U.i.isEmpty(t)||(n=t),U.i.isEmpty(n)?null:a.children().children(".layer").eq(n)}}}),ro=H()(In.prototype,"delLayer",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=e.edata.selectLayer,n=e.getLayers();Object(Y.transaction)(function(){n.splice(U.i.isEmpty(t)?a:t,1),e.edata.selectLayer=null,e.edata.keys=U.i.randomID(),e.setPage(),U.e.publish("h5ds.destoryControl")})}}}),so=H()(In.prototype,"delGroupLayer",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=e.edata.selectGroup;a?Object(Y.transaction)(function(){var n=e.getPage();n.layers=n.layers.filter(function(e,t){return-1===a.indexOf(t)}),t&&t(n.layers.length),e.edata.selectGroup=!1,e.edata.keys=U.i.randomID(),e.edata.layerListKeys=U.i.randomID(),U.e.publish("h5ds.destoryControl")}):Q.a.error("请选择多个图层！")}}}),io=H()(In.prototype,"setPage",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){console.log("setPage",t,a),U.i.isEmpty(t)&&(t=e.getPageNum()),console.log("setPage",t,a),a=a||e.edata.selectType,Object(Y.transaction)(function(){switch(e.edata.selectType=a){case"popups":0===e.data.popups.length?e.edata.selectPopup=null:e.edata.selectPopup=t;break;case"pages":0===e.data.pages.length?e.edata.selectPage=null:e.edata.selectPage=t;break;case"fixeds":e.edata.selectFixed=t}e.edata.selectLayer=null,e.edata.pageListKeys=U.i.randomID(),e.setType("page")})}}}),co=H()(In.prototype,"clickLayer",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;$("#h5dsLayerList").find("li").eq(e).trigger("click")}}}),lo=H()(In.prototype,"setLayer",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){console.log("setLayer",t),setTimeout(function(){Object(Y.transaction)(function(){e.edata.selectlayerKeys=U.i.randomID(),e.edata.setType="layer",e.edata.selectLayer=t,e.setType("layer")}),U.e.publish("h5ds.initControl"),U.e.publish("h5ds.setHistory")},0)}}}),po=H()(In.prototype,"exChangePage",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){var n=e.getPages();Object(Y.transaction)(function(){switch(new Array(Math.abs(t-a)).fill(1).forEach(function(){if(t<a){var e=[n[t+1],n[t]];n[t]=e[0],n[t+1]=e[1],t++}else{var o=[n[t],n[t-1]];n[t-1]=o[0],n[t]=o[1],t--}}),e.edata.selectType){case"popups":e.edata.selectPopup=a;break;case"fixeds":e.edata.selectFixed=a;break;case"pages":e.edata.selectPage=a}e.edata.pageListKeys=U.i.randomID()})}}}),uo=H()(In.prototype,"exChangeLayer",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t,a){if(t<0||a<0)return console.error("交换数据错误 i -> j",t,a),!1;var n=e.getLayers();Object(Y.transaction)(function(){new Array(Math.abs(t-a)).fill(1).forEach(function(){if(console.log("交换 i -> j",t,a),t<a){var e=[n[t+1],n[t]];n[t]=e[0],n[t+1]=e[1],t++}else{var o=[n[t],n[t-1]];n[t-1]=o[0],n[t]=o[1],t--}}),e.edata.selectLayer=a,e.edata.keys=U.i.randomID(),e.edata.layerListKeys=U.i.randomID()})}}}),ho=H()(In.prototype,"delPage",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=e.edata,n=a.selectType,o=a.selectPage,r=a.selectPopup,s=a.selectFixed;Object(Y.transaction)(function(){var a=e.data[n];switch(n){case"popups":t=U.i.isEmpty(t)?r:t,a.splice(t,1),e.edata.selectPopup=null;break;case"pages":t=U.i.isEmpty(t)?o:t,a.splice(t,1),e.edata.selectPage=null;break;case"fixeds":t=U.i.isEmpty(t)?s:t,a.splice(t,1),e.edata.selectFixed=null}e.edata.pageListKeys=U.i.randomID()})}}}),mo=H()(In.prototype,"addPage",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){if("fixeds"===e.edata.selectType)return Q.a.warn("不能添加浮动层"),!1;if(!t)return console.error("此方法必须传入参数！"),!1;var a=e.getPages();Object(Y.transaction)(function(){var n=null;switch(e.edata.selectType){case"pages":n="selectPage";break;case"fixeds":n="selectFixed";break;case"popups":n="selectPopup"}t.keyid=U.i.randomID();var o=e.edata[n];a.splice(o+1,0,E()({},t)),e.edata[n]=o+1,e.edata.selectLayer=null,e.edata.keys=U.i.randomID(),e.edata.pageListKeys=U.i.randomID()})}}}),yo=H()(In.prototype,"copyPage",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=e.edata,n=a.selectType,o=a.selectPage,r=e.getPageNum(),s=e.data[n][t||r];s=e.toJS(s),Object(Y.transaction)(function(){s.keyid=U.i.randomID(),s.id=null,s.layers.map(function(t){return e.originLayerSet(t,!0)}),e.data[n].splice(t||o,0,s)})}}}),fo=H()(In.prototype,"copyLayer",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){var a=e.edata,n=a.selectType,o=a.selectLayer,r=e.getPageNum();if(null!==o||void 0!==t){void 0===t&&(t=o);var s=e.data[n][r].layers[t];Object(Y.transaction)(function(){var a=e.data[n][r].layers,o=e.toJS(s);o.keyid=U.i.randomID(),e.originLayerSet(o,!0),a.splice(t,0,o)})}else Q.a.error("请先选择一个图层进行复制！")}}}),go=H()(In.prototype,"copyAnimate",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.getLayer();t?(Q.a.success("复制动画成功！"),e.copyAnimateData=e.toJS(t.animate)):console.error("没有选择任何layer")}}}),vo=H()(In.prototype,"pasteAnimate",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=e.getLayer();Object(Y.transaction)(function(){e.copyAnimateData[0]&&"in"===e.copyAnimateData[0].type&&(t.estyle.opacity=0),t.animate=e.toJS(e.copyAnimateData),Q.a.success("粘贴动画成功！")})}}}),bo=H()(In.prototype,"doHistory",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){if(console.log("还原历史记录 > 游标",e.historyIndex,e.history.length),0<=e.historyIndex){"undo"===t?(e.historyIndex--,e.historyIndex<0&&(e.historyIndex=0)):(e.historyIndex++,e.historyIndex>e.history.length&&(e.historyIndex=e.history.length-1));var a=e.history[e.historyIndex]||{},n=a.data,o=a.edata;n&&Object(Y.transaction)(function(){for(var t in e.data=JSON.parse(n),o=JSON.parse(o))e.edata[t]=o[t]})}}}}),wo=H()(In.prototype,"setHistoryAsync",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return U.i.debounce(function(t){e.setHistory(t)},300)}}),ko=H()(In.prototype,"setHistory",[Y.action],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";console.log("history 记录， 游标",e.historyIndex,e.history.length),Object(Y.transaction)(function(){e.history.length!==e.historyIndex+1&&e.history.splice(e.history.length-1-e.historyIndex,e.history.length-1);var a={data:JSON.stringify(e.data),edata:JSON.stringify(e.edata),info:t};e.history.push(a),20<e.history.length&&e.history.shift(),e.historyIndex=e.history.length-1}),e.saveToStore()}}}),In),Xr=(Eo=function e(){p()(this,e),Ur()(this,"props",xo,this),Ur()(this,"plugins",Oo,this)},xo=H()(Eo.prototype,"props",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Oo=H()(Eo.prototype,"plugins",[Y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Eo),Kr={h5ds:new Jr,scope:new Xr},Qr=function(e){function t(){return p()(this,t),m()(this,f()(t).apply(this,arguments))}return v()(t,e),h()(t,[{key:"render",value:function(){return q.a.createElement(zt.Provider,Kr,q.a.createElement(Br,this.props))}}]),t}(q.a.Component);t.default=Qr}],e.c=a,e.d=function(t,a,n){e.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:n})},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.t=function(t,a){if(1&a&&(t=e(t)),8&a)return t;if(4&a&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p="/",e(e.s=159)).default;function e(n){if(a[n])return a[n].exports;var o=a[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var t,a});